{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import json\n",
    "import os\n",
    "import time\n",
    "from datetime import datetime\n",
    "\n",
    "import pandas as pd\n",
    "from openpyxl import Workbook\n",
    "import traceback\n",
    "\n",
    "import conf\n",
    "from connection import ConnectionTask,get_in,pg_select\n",
    "c=ConnectionTask()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 流水报表"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "pg=c.ppgdb\n",
    "mdb=c.pmdb\n",
    "rrdb=c.prrdb(0)\n",
    "start='2017-09-01'\n",
    "end='2017-09-30'\n",
    "start_time = time.mktime(time.strptime(start, \"%Y-%m-%d\")) * 1000\n",
    "end_time = (time.mktime(time.strptime(end, \"%Y-%m-%d\")) + 3600 * 24) * 1000\n",
    "\n",
    "# 获取postgresql数据\n",
    "payment_data = pd.DataFrame(pg_select('''SELECT \n",
    "                                            app_code,\n",
    "                                            order_id as id,\n",
    "                                            flow_id,\n",
    "                                            supplier,\n",
    "                                            order_amount,\n",
    "                                            payment_amount,\n",
    "                                            fee,\n",
    "                                            channel,\n",
    "                                            created_at,\n",
    "                                            paid_at\n",
    "                                        FROM boluome_flow WHERE paid_at>{} AND paid_at<{};'''.format(start_time, end_time),\n",
    "                                        pg('account')))\n",
    "payment_data['transaction_type'] = '交易'\n",
    "\n",
    "refund_data = pd.DataFrame(pg_select('''SELECT \n",
    "                                                app_code,\n",
    "                                                order_id as id,\n",
    "                                                flow_id,\n",
    "                                                supplier,\n",
    "                                                order_amount,\n",
    "                                                refund_amount as payment_amount,\n",
    "                                                fee,\n",
    "                                                channel,\n",
    "                                                created_at,\n",
    "                                                refunded_at as paid_at\n",
    "                                            FROM boluome_refund_flow WHERE refunded_at>{} AND refunded_at<{};'''.format(start_time, end_time),\n",
    "                                          pg('account')))\n",
    "refund_data['order_amount'] = -refund_data.order_amount\n",
    "refund_data['payment_amount'] = -refund_data.payment_amount\n",
    "refund_data['transaction_type'] = '退款'\n",
    "flow_data=pd.concat([payment_data,refund_data],ignore_index=True)\n",
    "#优惠金额\n",
    "flow_data['deduction_price']=flow_data.order_amount-flow_data.payment_amount\n",
    "\n",
    "#供应商订单号\n",
    "flow_data['partner_id']=flow_data.id.map(lambda x:rrdb.execute_command('jget','o:{}'.format(x),'/partnerId'))\n",
    "#订单完成时间\n",
    "flow_data['completed_at']=flow_data.id.map(lambda x:rrdb.execute_command('jget','o:{}'.format(x),'/completedAt'))\n",
    "\n",
    "flow_data.completed_at=flow_data.completed_at.fillna('')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1504195200000.0, 1506787200000.0)"
      ]
     },
     "execution_count": 183,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "start_time,end_time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "metadata": {},
   "outputs": [],
   "source": [
    "rrdb.execute_command('jget','o:{}'.format('jst201990841861150'),'/paidList')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(8894, 744, 9638)"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(payment_data),len(refund_data),len(flow_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "flow_data.created_at = flow_data.created_at.map(lambda x:pd.to_datetime(x,unit='ms',utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S'))\n",
    "flow_data.paid_at = flow_data.paid_at.map(lambda x:pd.to_datetime(x,unit='ms',utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S'))\n",
    "flow_data.completed_at = flow_data.completed_at.map(lambda x:pd.to_datetime(x,unit='ms',utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')\n",
    "\n",
    "pay_rate={item['pay_channel_id']:item['pay_channel_name'] for item in pg_select('''SELECT pay_channel_id,pay_channel_name FROM pay_channel;''',pg('oto_saas'))}\n",
    "\n",
    "# # 数据值映射\n",
    "flow_data['channel'] = flow_data.channel.map(lambda x: pay_rate.get(x, x))\n",
    "\n",
    "app_code_map = {item['app_code']: item['app_name'] for item in pg_select(\"SELECT app_name,app_code FROM application;\", pg('oto_saas'))}\n",
    "flow_data['app_code'] = flow_data.app_code.map(lambda x: app_code_map.get(x, x))\n",
    "\n",
    "supplier_map = {item['brand_code']: item['brand_name'] for item in pg_select(\"SELECT brand_name,brand_code FROM brand;\", pg('oto_saas'))}\n",
    "flow_data['supplier'] = flow_data.supplier.map(lambda x: supplier_map.get(x, x))\n",
    "\n",
    "map_key = {\n",
    "    'app_code': '应用名称',\n",
    "    'id': '订单号',\n",
    "    'flow_id': '支付流水号',\n",
    "    'partner_id': '供应商订单号',\n",
    "    'supplier': '供应商',\n",
    "    'order_amount': '订单金额',\n",
    "    'payment_amount': '支付金额',\n",
    "    'deduction_price': '优惠金额',\n",
    "    'fee': '供应商手续费',\n",
    "    'transaction_type': '交易类型',\n",
    "    'channel': '支付方式',\n",
    "    'created_at': '下单时间',\n",
    "    'paid_at': '支付完成时间',\n",
    "    'completed_at': '订单完成时间',\n",
    "}\n",
    "\n",
    "flow_data=flow_data.rename(columns=map_key)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>app_code</th>\n",
       "      <th>channel</th>\n",
       "      <th>created_at</th>\n",
       "      <th>fee</th>\n",
       "      <th>flow_id</th>\n",
       "      <th>id</th>\n",
       "      <th>order_amount</th>\n",
       "      <th>paid_at</th>\n",
       "      <th>payment_amount</th>\n",
       "      <th>supplier</th>\n",
       "      <th>transaction_type</th>\n",
       "      <th>deduction_price</th>\n",
       "      <th>partner_id</th>\n",
       "      <th>completed_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:00:09</td>\n",
       "      <td>24.500</td>\n",
       "      <td>bp212242276112166</td>\n",
       "      <td>bp202242275981093</td>\n",
       "      <td>4900.0</td>\n",
       "      <td>2017-10-16 00:00:31</td>\n",
       "      <td>4900.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037087280711762</td>\n",
       "      <td>2017-10-16 00:33:16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:00:31</td>\n",
       "      <td>16.000</td>\n",
       "      <td>bp212242278995752</td>\n",
       "      <td>bp202242278864679</td>\n",
       "      <td>3200.0</td>\n",
       "      <td>2017-10-16 00:00:58</td>\n",
       "      <td>3200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037182047001614</td>\n",
       "      <td>2017-10-16 00:23:47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:02:16</td>\n",
       "      <td>7.000</td>\n",
       "      <td>bp212242292758321</td>\n",
       "      <td>bp202242292758320</td>\n",
       "      <td>1400.0</td>\n",
       "      <td>2017-10-16 00:02:48</td>\n",
       "      <td>1400.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037188068309234</td>\n",
       "      <td>2017-10-16 03:02:52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:05:42</td>\n",
       "      <td>19.500</td>\n",
       "      <td>bp212242319759163</td>\n",
       "      <td>bp202242319628090</td>\n",
       "      <td>3900.0</td>\n",
       "      <td>2017-10-16 00:06:07</td>\n",
       "      <td>3900.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037164396580997</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:09:45</td>\n",
       "      <td>12.700</td>\n",
       "      <td>bp212242351609691</td>\n",
       "      <td>bp202242351609690</td>\n",
       "      <td>2540.0</td>\n",
       "      <td>2017-10-16 00:09:53</td>\n",
       "      <td>2540.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037273306377396</td>\n",
       "      <td>2017-10-16 00:39:51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:09:44</td>\n",
       "      <td>17.950</td>\n",
       "      <td>bp212242351478617</td>\n",
       "      <td>bp202242351478616</td>\n",
       "      <td>3590.0</td>\n",
       "      <td>2017-10-16 00:09:58</td>\n",
       "      <td>3590.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037305527293032</td>\n",
       "      <td>2017-10-16 03:10:03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:12:01</td>\n",
       "      <td>23.300</td>\n",
       "      <td>bp212242369435453</td>\n",
       "      <td>bp202242369304380</td>\n",
       "      <td>4660.0</td>\n",
       "      <td>2017-10-16 00:12:20</td>\n",
       "      <td>4660.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037314242702402</td>\n",
       "      <td>2017-10-16 03:13:32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:12:57</td>\n",
       "      <td>23.050</td>\n",
       "      <td>bp212242376775521</td>\n",
       "      <td>bp202242376644448</td>\n",
       "      <td>4610.0</td>\n",
       "      <td>2017-10-16 00:13:17</td>\n",
       "      <td>4610.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212528847749693461</td>\n",
       "      <td>2017-10-16 03:13:21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:13:30</td>\n",
       "      <td>23.500</td>\n",
       "      <td>bp212242381100863</td>\n",
       "      <td>bp202242380969790</td>\n",
       "      <td>4700.0</td>\n",
       "      <td>2017-10-16 00:13:44</td>\n",
       "      <td>4700.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212528867160888419</td>\n",
       "      <td>2017-10-16 03:13:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:14:10</td>\n",
       "      <td>27.000</td>\n",
       "      <td>bp212242386474853</td>\n",
       "      <td>bp202242386343780</td>\n",
       "      <td>5400.0</td>\n",
       "      <td>2017-10-16 00:14:43</td>\n",
       "      <td>5400.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212528943615309933</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:14:28</td>\n",
       "      <td>21.000</td>\n",
       "      <td>bp212242388703079</td>\n",
       "      <td>bp202242388572006</td>\n",
       "      <td>4200.0</td>\n",
       "      <td>2017-10-16 00:16:42</td>\n",
       "      <td>4200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037359935401122</td>\n",
       "      <td>2017-10-16 00:28:56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:18:35</td>\n",
       "      <td>7.000</td>\n",
       "      <td>bp212242421077869</td>\n",
       "      <td>bp202242420946796</td>\n",
       "      <td>1400.0</td>\n",
       "      <td>2017-10-16 00:18:44</td>\n",
       "      <td>1400.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037374531565589</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:19:48</td>\n",
       "      <td>11.700</td>\n",
       "      <td>bp212242430646127</td>\n",
       "      <td>bp202242430646126</td>\n",
       "      <td>2340.0</td>\n",
       "      <td>2017-10-16 00:19:58</td>\n",
       "      <td>2340.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037343124019326</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:24:36</td>\n",
       "      <td>14.750</td>\n",
       "      <td>bp212242468394865</td>\n",
       "      <td>bp202242468394864</td>\n",
       "      <td>2950.0</td>\n",
       "      <td>2017-10-16 00:24:47</td>\n",
       "      <td>2950.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037453225291909</td>\n",
       "      <td>2017-10-16 03:24:54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 00:27:40</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242492512070</td>\n",
       "      <td>ala202242492512069</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>2017-10-16 00:29:00</td>\n",
       "      <td>1700.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>300.0</td>\n",
       "      <td>3014037496274869287</td>\n",
       "      <td>2017-10-16 03:29:30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:33:10</td>\n",
       "      <td>35.000</td>\n",
       "      <td>bp212242535765879</td>\n",
       "      <td>bp202242535765878</td>\n",
       "      <td>7000.0</td>\n",
       "      <td>2017-10-16 00:33:23</td>\n",
       "      <td>7000.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037548745510045</td>\n",
       "      <td>2017-10-16 03:33:33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:34:50</td>\n",
       "      <td>18.500</td>\n",
       "      <td>bp212242548873041</td>\n",
       "      <td>bp202242548741968</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>2017-10-16 00:35:02</td>\n",
       "      <td>3700.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037588457911380</td>\n",
       "      <td>2017-10-16 03:35:15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:39:31</td>\n",
       "      <td>17.650</td>\n",
       "      <td>bp212242585704281</td>\n",
       "      <td>bp202242585573208</td>\n",
       "      <td>3530.0</td>\n",
       "      <td>2017-10-16 00:39:38</td>\n",
       "      <td>3530.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037660113793198</td>\n",
       "      <td>2017-10-16 03:39:46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 00:40:17</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242591733597</td>\n",
       "      <td>ala202242591733596</td>\n",
       "      <td>4960.0</td>\n",
       "      <td>2017-10-16 00:41:11</td>\n",
       "      <td>4960.0</td>\n",
       "      <td>欧飞</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>S1710167755686</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:44:03</td>\n",
       "      <td>22.395</td>\n",
       "      <td>bp212242621355900</td>\n",
       "      <td>bp202242621224827</td>\n",
       "      <td>4479.0</td>\n",
       "      <td>2017-10-16 00:44:34</td>\n",
       "      <td>4479.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037706291936477</td>\n",
       "      <td>2017-10-16 03:44:43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 00:44:50</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242627516286</td>\n",
       "      <td>ala202242627516285</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>2017-10-16 00:45:11</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>高阳捷迅</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>GDOB171016004511493297</td>\n",
       "      <td>2017-10-16 01:34:17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 00:45:19</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242631317346</td>\n",
       "      <td>ala202242631317345</td>\n",
       "      <td>9966.0</td>\n",
       "      <td>2017-10-16 00:45:34</td>\n",
       "      <td>9966.0</td>\n",
       "      <td>欧飞</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>S1710167756775</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:45:19</td>\n",
       "      <td>11.875</td>\n",
       "      <td>bp212242631317347</td>\n",
       "      <td>bp202242631186272</td>\n",
       "      <td>2375.0</td>\n",
       "      <td>2017-10-16 00:45:35</td>\n",
       "      <td>2375.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037744871831726</td>\n",
       "      <td>2017-10-16 01:13:08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:47:51</td>\n",
       "      <td>26.000</td>\n",
       "      <td>bp212242651240322</td>\n",
       "      <td>bp202242651109249</td>\n",
       "      <td>5200.0</td>\n",
       "      <td>2017-10-16 00:48:09</td>\n",
       "      <td>5200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037716842469607</td>\n",
       "      <td>2017-10-16 03:48:13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:50:10</td>\n",
       "      <td>10.000</td>\n",
       "      <td>bp212242669459309</td>\n",
       "      <td>bp202242669328236</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>2017-10-16 00:51:25</td>\n",
       "      <td>2000.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037758712969405</td>\n",
       "      <td>2017-10-16 03:51:57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:51:33</td>\n",
       "      <td>30.400</td>\n",
       "      <td>bp212242680338308</td>\n",
       "      <td>bp202242680207235</td>\n",
       "      <td>6080.0</td>\n",
       "      <td>2017-10-16 00:51:52</td>\n",
       "      <td>6080.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037788291359885</td>\n",
       "      <td>2017-10-16 03:52:08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:54:59</td>\n",
       "      <td>12.500</td>\n",
       "      <td>bp212242707339143</td>\n",
       "      <td>bp202242707339142</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>2017-10-16 00:55:07</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037797241730092</td>\n",
       "      <td>2017-10-16 01:13:10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 00:57:28</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242726868850</td>\n",
       "      <td>ala202242726868849</td>\n",
       "      <td>4985.0</td>\n",
       "      <td>2017-10-16 00:57:48</td>\n",
       "      <td>4985.0</td>\n",
       "      <td>欧飞</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>S1710167759241</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 00:58:11</td>\n",
       "      <td>13.000</td>\n",
       "      <td>bp212242732504970</td>\n",
       "      <td>bp202242732373897</td>\n",
       "      <td>2600.0</td>\n",
       "      <td>2017-10-16 00:58:24</td>\n",
       "      <td>2600.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014037906066402435</td>\n",
       "      <td>2017-10-16 03:58:28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>51返呗</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>2017-10-16 01:01:31</td>\n",
       "      <td>0.000</td>\n",
       "      <td>ala212242758719348</td>\n",
       "      <td>ala202242758719347</td>\n",
       "      <td>1900.0</td>\n",
       "      <td>2017-10-16 01:01:45</td>\n",
       "      <td>1600.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>交易</td>\n",
       "      <td>300.0</td>\n",
       "      <td>3014037845391690893</td>\n",
       "      <td>2017-10-16 04:01:49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2543</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 15:09:16</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222249425684034</td>\n",
       "      <td>bp202249383347762</td>\n",
       "      <td>-2400.0</td>\n",
       "      <td>2017-10-16 19:56:20</td>\n",
       "      <td>-2400.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212537524255895654</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2544</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 15:17:51</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222249493185621</td>\n",
       "      <td>bp202249466840666</td>\n",
       "      <td>-9100.0</td>\n",
       "      <td>2017-10-16 19:56:35</td>\n",
       "      <td>-9100.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014073161256056986</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2545</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 15:26:17</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222249559508075</td>\n",
       "      <td>bp202241055438234</td>\n",
       "      <td>-2960.0</td>\n",
       "      <td>2017-10-16 19:57:04</td>\n",
       "      <td>-2960.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014032337817671837</td>\n",
       "      <td>2017-10-16 00:28:35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2546</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 16:07:30</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222249883649266</td>\n",
       "      <td>bp202249842624270</td>\n",
       "      <td>-1500.0</td>\n",
       "      <td>2017-10-16 19:57:28</td>\n",
       "      <td>-1500.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014074970628650035</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2547</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 16:26:07</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250030056810</td>\n",
       "      <td>bp202250008692575</td>\n",
       "      <td>-5750.0</td>\n",
       "      <td>2017-10-16 19:57:41</td>\n",
       "      <td>-5750.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014075906947598476</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2548</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:01:49</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250310813208</td>\n",
       "      <td>bp202250269787644</td>\n",
       "      <td>-1300.0</td>\n",
       "      <td>2017-10-16 19:58:25</td>\n",
       "      <td>-1300.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212538820488630525</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2549</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:14:48</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250412918904</td>\n",
       "      <td>bp202250371237970</td>\n",
       "      <td>-6200.0</td>\n",
       "      <td>2017-10-16 19:58:59</td>\n",
       "      <td>-6200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014079432519807079</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2550</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:16:45</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250428254345</td>\n",
       "      <td>bp202250372810313</td>\n",
       "      <td>-5640.0</td>\n",
       "      <td>2017-10-16 19:59:12</td>\n",
       "      <td>-5640.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014079438215033976</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2551</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:28:38</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250521708221</td>\n",
       "      <td>bp202250479503013</td>\n",
       "      <td>-7090.0</td>\n",
       "      <td>2017-10-16 19:59:31</td>\n",
       "      <td>-7090.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212539568735360198</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2552</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:39:11</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250604676873</td>\n",
       "      <td>bp202250562733796</td>\n",
       "      <td>-3650.0</td>\n",
       "      <td>2017-10-16 20:00:14</td>\n",
       "      <td>-3650.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014082192465129713</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2553</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:41:53</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250625911071</td>\n",
       "      <td>bp202250563913447</td>\n",
       "      <td>-3050.0</td>\n",
       "      <td>2017-10-16 20:00:25</td>\n",
       "      <td>-3050.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212539858762978388</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2554</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:51:06</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250698262368</td>\n",
       "      <td>bp202250685810518</td>\n",
       "      <td>-2580.0</td>\n",
       "      <td>2017-10-16 20:00:35</td>\n",
       "      <td>-2580.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212540316730250339</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2555</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 17:56:35</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250741516168</td>\n",
       "      <td>bp202250682140495</td>\n",
       "      <td>-2900.0</td>\n",
       "      <td>2017-10-16 20:01:20</td>\n",
       "      <td>-2900.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014084041053618380</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2556</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:03:55</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250799188406</td>\n",
       "      <td>bp202250577676019</td>\n",
       "      <td>-3066.0</td>\n",
       "      <td>2017-10-16 20:01:31</td>\n",
       "      <td>-3066.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014082411382585389</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2557</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:09:00</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222250839164886</td>\n",
       "      <td>bp202250798008250</td>\n",
       "      <td>-2100.0</td>\n",
       "      <td>2017-10-16 20:01:40</td>\n",
       "      <td>-2100.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212540752351498493</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2558</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:33:16</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251030003718</td>\n",
       "      <td>bp202250988194372</td>\n",
       "      <td>-1800.0</td>\n",
       "      <td>2017-10-16 20:01:55</td>\n",
       "      <td>-1800.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014088721292834821</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2559</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:41:09</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251092000816</td>\n",
       "      <td>bp202251051237389</td>\n",
       "      <td>-2000.0</td>\n",
       "      <td>2017-10-16 20:02:35</td>\n",
       "      <td>-2000.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212541635638398081</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2560</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:45:11</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251123720277</td>\n",
       "      <td>bp202251082563628</td>\n",
       "      <td>-2200.0</td>\n",
       "      <td>2017-10-16 20:02:44</td>\n",
       "      <td>-2200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014090111655004300</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2561</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:45:46</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251128307805</td>\n",
       "      <td>bp202251093311541</td>\n",
       "      <td>-2600.0</td>\n",
       "      <td>2017-10-16 20:02:55</td>\n",
       "      <td>-2600.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212541859731609653</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2562</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:46:10</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251131453534</td>\n",
       "      <td>bp202251090690092</td>\n",
       "      <td>-1600.0</td>\n",
       "      <td>2017-10-16 20:03:05</td>\n",
       "      <td>-1600.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014090098803734538</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2563</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:52:29</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251181129853</td>\n",
       "      <td>bp202251139055714</td>\n",
       "      <td>-2938.0</td>\n",
       "      <td>2017-10-16 20:03:20</td>\n",
       "      <td>-2938.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014090829224845455</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2564</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 18:57:12</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251218223256</td>\n",
       "      <td>bp202251177590904</td>\n",
       "      <td>-2750.0</td>\n",
       "      <td>2017-10-16 20:03:32</td>\n",
       "      <td>-2750.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014091195949983810</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2565</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:04:47</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251277861056</td>\n",
       "      <td>bp202251236442261</td>\n",
       "      <td>-2049.0</td>\n",
       "      <td>2017-10-16 20:03:49</td>\n",
       "      <td>-2049.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212542193413208258</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2566</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:10:46</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251324915930</td>\n",
       "      <td>bp202251283497157</td>\n",
       "      <td>-2200.0</td>\n",
       "      <td>2017-10-16 20:04:14</td>\n",
       "      <td>-2200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014092510016483403</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2567</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:19:57</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251397136614</td>\n",
       "      <td>bp202251339595965</td>\n",
       "      <td>-1200.0</td>\n",
       "      <td>2017-10-16 20:04:24</td>\n",
       "      <td>-1200.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014093133139286157</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2568</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:30:17</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251478532397</td>\n",
       "      <td>bp202251435016443</td>\n",
       "      <td>-410.0</td>\n",
       "      <td>2017-10-16 20:04:31</td>\n",
       "      <td>-410.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014093925560948971</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2569</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:33:26</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251503173940</td>\n",
       "      <td>bp202251266588831</td>\n",
       "      <td>-1900.0</td>\n",
       "      <td>2017-10-16 20:05:03</td>\n",
       "      <td>-1900.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212542267971785859</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2570</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:58:37</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251701223857</td>\n",
       "      <td>bp202251660722590</td>\n",
       "      <td>-1900.0</td>\n",
       "      <td>2017-10-16 20:05:20</td>\n",
       "      <td>-1900.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1212543150863377652</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2571</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 19:59:26</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251707646365</td>\n",
       "      <td>bp202251700044184</td>\n",
       "      <td>-1300.0</td>\n",
       "      <td>2017-10-16 20:05:28</td>\n",
       "      <td>-1300.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014096184151513131</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2572</th>\n",
       "      <td>翼支付</td>\n",
       "      <td>翼支付</td>\n",
       "      <td>2017-10-16 20:05:28</td>\n",
       "      <td>0.000</td>\n",
       "      <td>bp222251755094475</td>\n",
       "      <td>bp202251744739762</td>\n",
       "      <td>-2400.0</td>\n",
       "      <td>2017-10-16 20:05:42</td>\n",
       "      <td>-2400.0</td>\n",
       "      <td>饿了么</td>\n",
       "      <td>退款</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3014096542998392862</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2573 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     app_code channel           created_at     fee             flow_id  \\\n",
       "0         翼支付     翼支付  2017-10-16 00:00:09  24.500   bp212242276112166   \n",
       "1         翼支付     翼支付  2017-10-16 00:00:31  16.000   bp212242278995752   \n",
       "2         翼支付     翼支付  2017-10-16 00:02:16   7.000   bp212242292758321   \n",
       "3         翼支付     翼支付  2017-10-16 00:05:42  19.500   bp212242319759163   \n",
       "4         翼支付     翼支付  2017-10-16 00:09:45  12.700   bp212242351609691   \n",
       "5         翼支付     翼支付  2017-10-16 00:09:44  17.950   bp212242351478617   \n",
       "6         翼支付     翼支付  2017-10-16 00:12:01  23.300   bp212242369435453   \n",
       "7         翼支付     翼支付  2017-10-16 00:12:57  23.050   bp212242376775521   \n",
       "8         翼支付     翼支付  2017-10-16 00:13:30  23.500   bp212242381100863   \n",
       "9         翼支付     翼支付  2017-10-16 00:14:10  27.000   bp212242386474853   \n",
       "10        翼支付     翼支付  2017-10-16 00:14:28  21.000   bp212242388703079   \n",
       "11        翼支付     翼支付  2017-10-16 00:18:35   7.000   bp212242421077869   \n",
       "12        翼支付     翼支付  2017-10-16 00:19:48  11.700   bp212242430646127   \n",
       "13        翼支付     翼支付  2017-10-16 00:24:36  14.750   bp212242468394865   \n",
       "14       51返呗    51返呗  2017-10-16 00:27:40   0.000  ala212242492512070   \n",
       "15        翼支付     翼支付  2017-10-16 00:33:10  35.000   bp212242535765879   \n",
       "16        翼支付     翼支付  2017-10-16 00:34:50  18.500   bp212242548873041   \n",
       "17        翼支付     翼支付  2017-10-16 00:39:31  17.650   bp212242585704281   \n",
       "18       51返呗    51返呗  2017-10-16 00:40:17   0.000  ala212242591733597   \n",
       "19        翼支付     翼支付  2017-10-16 00:44:03  22.395   bp212242621355900   \n",
       "20       51返呗    51返呗  2017-10-16 00:44:50   0.000  ala212242627516286   \n",
       "21       51返呗    51返呗  2017-10-16 00:45:19   0.000  ala212242631317346   \n",
       "22        翼支付     翼支付  2017-10-16 00:45:19  11.875   bp212242631317347   \n",
       "23        翼支付     翼支付  2017-10-16 00:47:51  26.000   bp212242651240322   \n",
       "24        翼支付     翼支付  2017-10-16 00:50:10  10.000   bp212242669459309   \n",
       "25        翼支付     翼支付  2017-10-16 00:51:33  30.400   bp212242680338308   \n",
       "26        翼支付     翼支付  2017-10-16 00:54:59  12.500   bp212242707339143   \n",
       "27       51返呗    51返呗  2017-10-16 00:57:28   0.000  ala212242726868850   \n",
       "28        翼支付     翼支付  2017-10-16 00:58:11  13.000   bp212242732504970   \n",
       "29       51返呗    51返呗  2017-10-16 01:01:31   0.000  ala212242758719348   \n",
       "...       ...     ...                  ...     ...                 ...   \n",
       "2543      翼支付     翼支付  2017-10-16 15:09:16   0.000   bp222249425684034   \n",
       "2544      翼支付     翼支付  2017-10-16 15:17:51   0.000   bp222249493185621   \n",
       "2545      翼支付     翼支付  2017-10-16 15:26:17   0.000   bp222249559508075   \n",
       "2546      翼支付     翼支付  2017-10-16 16:07:30   0.000   bp222249883649266   \n",
       "2547      翼支付     翼支付  2017-10-16 16:26:07   0.000   bp222250030056810   \n",
       "2548      翼支付     翼支付  2017-10-16 17:01:49   0.000   bp222250310813208   \n",
       "2549      翼支付     翼支付  2017-10-16 17:14:48   0.000   bp222250412918904   \n",
       "2550      翼支付     翼支付  2017-10-16 17:16:45   0.000   bp222250428254345   \n",
       "2551      翼支付     翼支付  2017-10-16 17:28:38   0.000   bp222250521708221   \n",
       "2552      翼支付     翼支付  2017-10-16 17:39:11   0.000   bp222250604676873   \n",
       "2553      翼支付     翼支付  2017-10-16 17:41:53   0.000   bp222250625911071   \n",
       "2554      翼支付     翼支付  2017-10-16 17:51:06   0.000   bp222250698262368   \n",
       "2555      翼支付     翼支付  2017-10-16 17:56:35   0.000   bp222250741516168   \n",
       "2556      翼支付     翼支付  2017-10-16 18:03:55   0.000   bp222250799188406   \n",
       "2557      翼支付     翼支付  2017-10-16 18:09:00   0.000   bp222250839164886   \n",
       "2558      翼支付     翼支付  2017-10-16 18:33:16   0.000   bp222251030003718   \n",
       "2559      翼支付     翼支付  2017-10-16 18:41:09   0.000   bp222251092000816   \n",
       "2560      翼支付     翼支付  2017-10-16 18:45:11   0.000   bp222251123720277   \n",
       "2561      翼支付     翼支付  2017-10-16 18:45:46   0.000   bp222251128307805   \n",
       "2562      翼支付     翼支付  2017-10-16 18:46:10   0.000   bp222251131453534   \n",
       "2563      翼支付     翼支付  2017-10-16 18:52:29   0.000   bp222251181129853   \n",
       "2564      翼支付     翼支付  2017-10-16 18:57:12   0.000   bp222251218223256   \n",
       "2565      翼支付     翼支付  2017-10-16 19:04:47   0.000   bp222251277861056   \n",
       "2566      翼支付     翼支付  2017-10-16 19:10:46   0.000   bp222251324915930   \n",
       "2567      翼支付     翼支付  2017-10-16 19:19:57   0.000   bp222251397136614   \n",
       "2568      翼支付     翼支付  2017-10-16 19:30:17   0.000   bp222251478532397   \n",
       "2569      翼支付     翼支付  2017-10-16 19:33:26   0.000   bp222251503173940   \n",
       "2570      翼支付     翼支付  2017-10-16 19:58:37   0.000   bp222251701223857   \n",
       "2571      翼支付     翼支付  2017-10-16 19:59:26   0.000   bp222251707646365   \n",
       "2572      翼支付     翼支付  2017-10-16 20:05:28   0.000   bp222251755094475   \n",
       "\n",
       "                      id  order_amount              paid_at  payment_amount  \\\n",
       "0      bp202242275981093        4900.0  2017-10-16 00:00:31          4900.0   \n",
       "1      bp202242278864679        3200.0  2017-10-16 00:00:58          3200.0   \n",
       "2      bp202242292758320        1400.0  2017-10-16 00:02:48          1400.0   \n",
       "3      bp202242319628090        3900.0  2017-10-16 00:06:07          3900.0   \n",
       "4      bp202242351609690        2540.0  2017-10-16 00:09:53          2540.0   \n",
       "5      bp202242351478616        3590.0  2017-10-16 00:09:58          3590.0   \n",
       "6      bp202242369304380        4660.0  2017-10-16 00:12:20          4660.0   \n",
       "7      bp202242376644448        4610.0  2017-10-16 00:13:17          4610.0   \n",
       "8      bp202242380969790        4700.0  2017-10-16 00:13:44          4700.0   \n",
       "9      bp202242386343780        5400.0  2017-10-16 00:14:43          5400.0   \n",
       "10     bp202242388572006        4200.0  2017-10-16 00:16:42          4200.0   \n",
       "11     bp202242420946796        1400.0  2017-10-16 00:18:44          1400.0   \n",
       "12     bp202242430646126        2340.0  2017-10-16 00:19:58          2340.0   \n",
       "13     bp202242468394864        2950.0  2017-10-16 00:24:47          2950.0   \n",
       "14    ala202242492512069        2000.0  2017-10-16 00:29:00          1700.0   \n",
       "15     bp202242535765878        7000.0  2017-10-16 00:33:23          7000.0   \n",
       "16     bp202242548741968        3700.0  2017-10-16 00:35:02          3700.0   \n",
       "17     bp202242585573208        3530.0  2017-10-16 00:39:38          3530.0   \n",
       "18    ala202242591733596        4960.0  2017-10-16 00:41:11          4960.0   \n",
       "19     bp202242621224827        4479.0  2017-10-16 00:44:34          4479.0   \n",
       "20    ala202242627516285       50000.0  2017-10-16 00:45:11         50000.0   \n",
       "21    ala202242631317345        9966.0  2017-10-16 00:45:34          9966.0   \n",
       "22     bp202242631186272        2375.0  2017-10-16 00:45:35          2375.0   \n",
       "23     bp202242651109249        5200.0  2017-10-16 00:48:09          5200.0   \n",
       "24     bp202242669328236        2000.0  2017-10-16 00:51:25          2000.0   \n",
       "25     bp202242680207235        6080.0  2017-10-16 00:51:52          6080.0   \n",
       "26     bp202242707339142        2500.0  2017-10-16 00:55:07          2500.0   \n",
       "27    ala202242726868849        4985.0  2017-10-16 00:57:48          4985.0   \n",
       "28     bp202242732373897        2600.0  2017-10-16 00:58:24          2600.0   \n",
       "29    ala202242758719347        1900.0  2017-10-16 01:01:45          1600.0   \n",
       "...                  ...           ...                  ...             ...   \n",
       "2543   bp202249383347762       -2400.0  2017-10-16 19:56:20         -2400.0   \n",
       "2544   bp202249466840666       -9100.0  2017-10-16 19:56:35         -9100.0   \n",
       "2545   bp202241055438234       -2960.0  2017-10-16 19:57:04         -2960.0   \n",
       "2546   bp202249842624270       -1500.0  2017-10-16 19:57:28         -1500.0   \n",
       "2547   bp202250008692575       -5750.0  2017-10-16 19:57:41         -5750.0   \n",
       "2548   bp202250269787644       -1300.0  2017-10-16 19:58:25         -1300.0   \n",
       "2549   bp202250371237970       -6200.0  2017-10-16 19:58:59         -6200.0   \n",
       "2550   bp202250372810313       -5640.0  2017-10-16 19:59:12         -5640.0   \n",
       "2551   bp202250479503013       -7090.0  2017-10-16 19:59:31         -7090.0   \n",
       "2552   bp202250562733796       -3650.0  2017-10-16 20:00:14         -3650.0   \n",
       "2553   bp202250563913447       -3050.0  2017-10-16 20:00:25         -3050.0   \n",
       "2554   bp202250685810518       -2580.0  2017-10-16 20:00:35         -2580.0   \n",
       "2555   bp202250682140495       -2900.0  2017-10-16 20:01:20         -2900.0   \n",
       "2556   bp202250577676019       -3066.0  2017-10-16 20:01:31         -3066.0   \n",
       "2557   bp202250798008250       -2100.0  2017-10-16 20:01:40         -2100.0   \n",
       "2558   bp202250988194372       -1800.0  2017-10-16 20:01:55         -1800.0   \n",
       "2559   bp202251051237389       -2000.0  2017-10-16 20:02:35         -2000.0   \n",
       "2560   bp202251082563628       -2200.0  2017-10-16 20:02:44         -2200.0   \n",
       "2561   bp202251093311541       -2600.0  2017-10-16 20:02:55         -2600.0   \n",
       "2562   bp202251090690092       -1600.0  2017-10-16 20:03:05         -1600.0   \n",
       "2563   bp202251139055714       -2938.0  2017-10-16 20:03:20         -2938.0   \n",
       "2564   bp202251177590904       -2750.0  2017-10-16 20:03:32         -2750.0   \n",
       "2565   bp202251236442261       -2049.0  2017-10-16 20:03:49         -2049.0   \n",
       "2566   bp202251283497157       -2200.0  2017-10-16 20:04:14         -2200.0   \n",
       "2567   bp202251339595965       -1200.0  2017-10-16 20:04:24         -1200.0   \n",
       "2568   bp202251435016443        -410.0  2017-10-16 20:04:31          -410.0   \n",
       "2569   bp202251266588831       -1900.0  2017-10-16 20:05:03         -1900.0   \n",
       "2570   bp202251660722590       -1900.0  2017-10-16 20:05:20         -1900.0   \n",
       "2571   bp202251700044184       -1300.0  2017-10-16 20:05:28         -1300.0   \n",
       "2572   bp202251744739762       -2400.0  2017-10-16 20:05:42         -2400.0   \n",
       "\n",
       "     supplier transaction_type  deduction_price              partner_id  \\\n",
       "0         饿了么               交易              0.0     3014037087280711762   \n",
       "1         饿了么               交易              0.0     3014037182047001614   \n",
       "2         饿了么               交易              0.0     3014037188068309234   \n",
       "3         饿了么               交易              0.0     3014037164396580997   \n",
       "4         饿了么               交易              0.0     3014037273306377396   \n",
       "5         饿了么               交易              0.0     3014037305527293032   \n",
       "6         饿了么               交易              0.0     3014037314242702402   \n",
       "7         饿了么               交易              0.0     1212528847749693461   \n",
       "8         饿了么               交易              0.0     1212528867160888419   \n",
       "9         饿了么               交易              0.0     1212528943615309933   \n",
       "10        饿了么               交易              0.0     3014037359935401122   \n",
       "11        饿了么               交易              0.0     3014037374531565589   \n",
       "12        饿了么               交易              0.0     3014037343124019326   \n",
       "13        饿了么               交易              0.0     3014037453225291909   \n",
       "14        饿了么               交易            300.0     3014037496274869287   \n",
       "15        饿了么               交易              0.0     3014037548745510045   \n",
       "16        饿了么               交易              0.0     3014037588457911380   \n",
       "17        饿了么               交易              0.0     3014037660113793198   \n",
       "18         欧飞               交易              0.0          S1710167755686   \n",
       "19        饿了么               交易              0.0     3014037706291936477   \n",
       "20       高阳捷迅               交易              0.0  GDOB171016004511493297   \n",
       "21         欧飞               交易              0.0          S1710167756775   \n",
       "22        饿了么               交易              0.0     3014037744871831726   \n",
       "23        饿了么               交易              0.0     3014037716842469607   \n",
       "24        饿了么               交易              0.0     3014037758712969405   \n",
       "25        饿了么               交易              0.0     3014037788291359885   \n",
       "26        饿了么               交易              0.0     3014037797241730092   \n",
       "27         欧飞               交易              0.0          S1710167759241   \n",
       "28        饿了么               交易              0.0     3014037906066402435   \n",
       "29        饿了么               交易            300.0     3014037845391690893   \n",
       "...       ...              ...              ...                     ...   \n",
       "2543      饿了么               退款              0.0     1212537524255895654   \n",
       "2544      饿了么               退款              0.0     3014073161256056986   \n",
       "2545      饿了么               退款              0.0     3014032337817671837   \n",
       "2546      饿了么               退款              0.0     3014074970628650035   \n",
       "2547      饿了么               退款              0.0     3014075906947598476   \n",
       "2548      饿了么               退款              0.0     1212538820488630525   \n",
       "2549      饿了么               退款              0.0     3014079432519807079   \n",
       "2550      饿了么               退款              0.0     3014079438215033976   \n",
       "2551      饿了么               退款              0.0     1212539568735360198   \n",
       "2552      饿了么               退款              0.0     3014082192465129713   \n",
       "2553      饿了么               退款              0.0     1212539858762978388   \n",
       "2554      饿了么               退款              0.0     1212540316730250339   \n",
       "2555      饿了么               退款              0.0     3014084041053618380   \n",
       "2556      饿了么               退款              0.0     3014082411382585389   \n",
       "2557      饿了么               退款              0.0     1212540752351498493   \n",
       "2558      饿了么               退款              0.0     3014088721292834821   \n",
       "2559      饿了么               退款              0.0     1212541635638398081   \n",
       "2560      饿了么               退款              0.0     3014090111655004300   \n",
       "2561      饿了么               退款              0.0     1212541859731609653   \n",
       "2562      饿了么               退款              0.0     3014090098803734538   \n",
       "2563      饿了么               退款              0.0     3014090829224845455   \n",
       "2564      饿了么               退款              0.0     3014091195949983810   \n",
       "2565      饿了么               退款              0.0     1212542193413208258   \n",
       "2566      饿了么               退款              0.0     3014092510016483403   \n",
       "2567      饿了么               退款              0.0     3014093133139286157   \n",
       "2568      饿了么               退款              0.0     3014093925560948971   \n",
       "2569      饿了么               退款              0.0     1212542267971785859   \n",
       "2570      饿了么               退款              0.0     1212543150863377652   \n",
       "2571      饿了么               退款              0.0     3014096184151513131   \n",
       "2572      饿了么               退款              0.0     3014096542998392862   \n",
       "\n",
       "             completed_at  \n",
       "0     2017-10-16 00:33:16  \n",
       "1     2017-10-16 00:23:47  \n",
       "2     2017-10-16 03:02:52  \n",
       "3                          \n",
       "4     2017-10-16 00:39:51  \n",
       "5     2017-10-16 03:10:03  \n",
       "6     2017-10-16 03:13:32  \n",
       "7     2017-10-16 03:13:21  \n",
       "8     2017-10-16 03:13:53  \n",
       "9                          \n",
       "10    2017-10-16 00:28:56  \n",
       "11                         \n",
       "12                         \n",
       "13    2017-10-16 03:24:54  \n",
       "14    2017-10-16 03:29:30  \n",
       "15    2017-10-16 03:33:33  \n",
       "16    2017-10-16 03:35:15  \n",
       "17    2017-10-16 03:39:46  \n",
       "18                         \n",
       "19    2017-10-16 03:44:43  \n",
       "20    2017-10-16 01:34:17  \n",
       "21                         \n",
       "22    2017-10-16 01:13:08  \n",
       "23    2017-10-16 03:48:13  \n",
       "24    2017-10-16 03:51:57  \n",
       "25    2017-10-16 03:52:08  \n",
       "26    2017-10-16 01:13:10  \n",
       "27                         \n",
       "28    2017-10-16 03:58:28  \n",
       "29    2017-10-16 04:01:49  \n",
       "...                   ...  \n",
       "2543                       \n",
       "2544                       \n",
       "2545  2017-10-16 00:28:35  \n",
       "2546                       \n",
       "2547                       \n",
       "2548                       \n",
       "2549                       \n",
       "2550                       \n",
       "2551                       \n",
       "2552                       \n",
       "2553                       \n",
       "2554                       \n",
       "2555                       \n",
       "2556                       \n",
       "2557                       \n",
       "2558                       \n",
       "2559                       \n",
       "2560                       \n",
       "2561                       \n",
       "2562                       \n",
       "2563                       \n",
       "2564                       \n",
       "2565                       \n",
       "2566                       \n",
       "2567                       \n",
       "2568                       \n",
       "2569                       \n",
       "2570                       \n",
       "2571                       \n",
       "2572                       \n",
       "\n",
       "[2573 rows x 14 columns]"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flow_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [],
   "source": [
    "flow_data.loc[:, field_headers].to_excel('/root/notebook/stg/flow_report.xlsx', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### stg.flowReportByMongoDB"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_datetime_from_microsecond(timestamp):\n",
    "    return time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(timestamp / 1000))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "pg=c.ppgdb\n",
    "mdb=c.pmdb\n",
    "rrdb=c.prrdb(0)\n",
    "rdb_0 = c.prdb_paym(0)\n",
    "rdb_1 = c.prdb_paym(1)\n",
    "rdb_2 = c.prdb_paym(2)\n",
    "start='2017-12-01'\n",
    "end='2017-12-04'\n",
    "start_time = time.mktime(time.strptime(start, \"%Y-%m-%d\")) * 1000\n",
    "end_time = (time.mktime(time.strptime(end, \"%Y-%m-%d\")) + 3600 * 24) * 1000\n",
    "# 获取mongodb数据\n",
    "rst = mdb['order_lite_list'].find(\n",
    "    {\n",
    "        '$or': [\n",
    "            {'createdAt': {'$gte': start_time, '$lt': end_time}},\n",
    "            {'updatedAt': {'$gte': start_time, '$lt': end_time}}\n",
    "        ],\n",
    "        'status': {'$nin': [1, 2]}\n",
    "    },\n",
    "    projection={\n",
    "        '_id': 0,\n",
    "        'orderType': 1,\n",
    "        'id': 1,  # 订单号\n",
    "        'channel': 1,  # 供应商\n",
    "        'payChannel': 1,  # 支付方式\n",
    "        'appCode': 1,  # 应用\n",
    "        'status': 1,\n",
    "    }\n",
    ")\n",
    "\n",
    "pd_data = pd.DataFrame(list(rst))\n",
    "\n",
    "data_list = []\n",
    "for name, _ in pd_data.groupby([\"orderType\"]):\n",
    "    id_list = list(pd_data[pd_data.orderType == name].id)\n",
    "    data_list.extend(\n",
    "        list(\n",
    "            mdb['order_{}'.format(name)].find(\n",
    "                {\n",
    "                    'id': {'$in': id_list},\n",
    "                    # 'paidList': {'$exists': True}\n",
    "                },\n",
    "                projection={\n",
    "                    '_id': 0,\n",
    "                    'id': 1,\n",
    "                    'partnerId': 1,  # 供应商订单号\n",
    "                    'orderPrice': 1,  # 订单金额\n",
    "                    'paidList': 1,  # 支付流水号列表\n",
    "                    'createdAt': 1,\n",
    "                    'completedAt': 1,\n",
    "                    'paymentSerial': 1,  # paidList 不存在时的备选\n",
    "                }\n",
    "            )  # find\n",
    "        )  # list\n",
    "    )\n",
    "pd_data = pd.merge(pd_data, pd.DataFrame(data_list), on=\"id\", how=\"right\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.status[0]==4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "pd_data['year']=pd_data.createdAt.map(lambda x:time.strftime(\"%Y\",time.localtime(int(x)/1000)) if x else x)\n",
    "pd_data['month']=pd_data.createdAt.map(lambda x:time.strftime(\"%m\",time.localtime(int(x)/1000)) if x else x)\n",
    "pd_data['week']=pd_data.createdAt.map(lambda x:time.strftime(\"%w\",time.localtime(int(x)/1000)) if x else x)\n",
    "pd_data['day']=pd_data.createdAt.map(lambda x:time.strftime(\"%d\",time.localtime(int(x)/1000)) if x else x)\n",
    "pd_data['pay']=pd_data.status.map(lambda x: 0 if x in ['0','1','2'] else 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808489589742</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512405e+12</td>\n",
       "      <td>1512403075803</td>\n",
       "      <td>34.88</td>\n",
       "      <td>[bp212808489720815]</td>\n",
       "      <td>3016206612566745101</td>\n",
       "      <td>bp212808489720815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808487361421</td>\n",
       "      <td>huafei</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512403058675</td>\n",
       "      <td>99.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td></td>\n",
       "      <td>ala212808487361422</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808486050699</td>\n",
       "      <td>huafei</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512403048316</td>\n",
       "      <td>49.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td></td>\n",
       "      <td>ala212808486050700</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808484084617</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512414e+12</td>\n",
       "      <td>1512403033836</td>\n",
       "      <td>25.50</td>\n",
       "      <td>[bp212808484215690]</td>\n",
       "      <td>3016206651950494732</td>\n",
       "      <td>bp212808484215690</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808483560428</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512414e+12</td>\n",
       "      <td>1512403029600</td>\n",
       "      <td>24.00</td>\n",
       "      <td>[bp212808483560429]</td>\n",
       "      <td>1214460321303985191</td>\n",
       "      <td>bp212808483560429</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   appCode channel                  id orderType payChannel  status  \\\n",
       "0  bestpay     ele   bp202808489589742    waimai    bestpay       4   \n",
       "1    91ala   ofpay  ala202808487361421    huafei        NaN       8   \n",
       "2    91ala   ofpay  ala202808486050699    huafei        NaN       8   \n",
       "3  bestpay     ele   bp202808484084617    waimai    bestpay       4   \n",
       "4  bestpay     ele   bp202808483560428    waimai    bestpay       4   \n",
       "\n",
       "    completedAt      createdAt  orderPrice             paidList  \\\n",
       "0  1.512405e+12  1512403075803       34.88  [bp212808489720815]   \n",
       "1           NaN  1512403058675       99.70                  NaN   \n",
       "2           NaN  1512403048316       49.90                  NaN   \n",
       "3  1.512414e+12  1512403033836       25.50  [bp212808484215690]   \n",
       "4  1.512414e+12  1512403029600       24.00  [bp212808483560429]   \n",
       "\n",
       "             partnerId       paymentSerial  \n",
       "0  3016206612566745101   bp212808489720815  \n",
       "1                       ala212808487361422  \n",
       "2                       ala212808486050700  \n",
       "3  3016206651950494732   bp212808484215690  \n",
       "4  1214460321303985191   bp212808483560429  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# 下单量\n",
    "order_num = pd_data.groupby(['appCode','orderType','year','month'])['id'].count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 支付量\n",
    "order_pay_num = pd_data.loc[lambda pd_data: pd_data.pay > 0,:].groupby(['appCode','orderType','year','month'])['pay'].count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# 支付总额\n",
    "order_pay_price_sum = pd_data.loc[lambda pd_data: pd_data.pay > 0,:].groupby(['appCode','orderType','year','month'])['orderPrice'].sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "order_statistics=[]\n",
    "for key, value in order_num.items():\n",
    "    order_statistics.append([key[0], key[1], key[2] + \"-\" + key[3], value, order_pay_num[key], order_pay_price_sum[key]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[['91ala', 'coffee', '2017-12', 8, 8, 334.89999999999998],\n",
       " ['91ala', 'dianying', '2017-12', 9, 9, 677.0],\n",
       " ['91ala', 'huafei', '2017-11', 10, 10, 2045.4200000000001],\n",
       " ['91ala', 'huafei', '2017-12', 4884, 4884, 528741.40000000177],\n",
       " ['91ala', 'jiayouka', '2017-12', 279, 279, 133300.0],\n",
       " ['91ala', 'jiudian', '2017-11', 10, 10, 2492.0],\n",
       " ['91ala', 'jiudian', '2017-12', 66, 66, 22191.0],\n",
       " ['91ala', 'liuliang', '2017-12', 70, 70, 2898.6000000000017],\n",
       " ['91ala', 'menpiao', '2017-12', 1, 1, 799.0],\n",
       " ['91ala', 'paotui', '2017-12', 6, 6, 121.0],\n",
       " ['91ala', 'shengxian', '2017-11', 1, 1, 29.899999999999999],\n",
       " ['91ala', 'waimai', '2017-11', 21, 21, 932.22000000000003],\n",
       " ['91ala', 'waimai', '2017-12', 1427, 1427, 76986.280000000086],\n",
       " ['91ala', 'xianhua', '2017-12', 3, 3, 364.0],\n",
       " ['abchina', 'menpiao', '2017-12', 2, 2, 99.900000000000006],\n",
       " ['allinpay', 'daijia', '2017-12', 1, 1, 0.0],\n",
       " ['allinpay', 'huafei', '2017-12', 1, 1, 199.19999999999999],\n",
       " ['allinpay', 'liuliang', '2017-12', 9, 9, 135.32999999999998],\n",
       " ['allinpay', 'waimai', '2017-12', 19, 19, 707.09999999999991],\n",
       " ['allinpay', 'xianhua', '2017-11', 1, 1, 58.0],\n",
       " ['anydoor', 'huafei', '2017-12', 95, 95, 9272.7800000000007],\n",
       " ['anydoor', 'liuliang', '2017-12', 4, 4, 44.140000000000001],\n",
       " ['anydoor', 'shenghuojiaofei', '2017-12', 1, 1, 2.6000000000000001],\n",
       " ['autohome', 'shenghuojiaofei', '2017-12', 2, 2, 230.90000000000001],\n",
       " ['beebill', 'waimai', '2017-12', 6, 6, 137.30000000000001],\n",
       " ['bestpay', 'waimai', '2017-11', 122, 122, 4220.2099999999991],\n",
       " ['bestpay', 'waimai', '2017-12', 24999, 24999, 736525.73000001989],\n",
       " ['blm', 'huafei', '2017-12', 9, 9, 449.06999999999994],\n",
       " ['blm', 'jiadianqingxi', '2017-12', 1, 1, 78.0],\n",
       " ['blm', 'jiadianweixiu', '2017-12', 1, 1, 30.0],\n",
       " ['blm', 'liuliang', '2017-12', 1, 1, 69.859999999999999],\n",
       " ['blm', 'waimai', '2017-12', 1, 1, 11.0],\n",
       " ['blm', 'yongche', '2017-12', 1, 1, 61.600000000000001],\n",
       " ['boluome', 'dianying', '2017-12', 2, 2, 179.0],\n",
       " ['boluome', 'huafei', '2017-12', 6, 6, 299.36000000000001],\n",
       " ['boluome', 'huoche', '2017-12', 1, 1, 1753.0],\n",
       " ['boluome', 'jiayouka', '2017-12', 1, 1, 100.0],\n",
       " ['boluome', 'mms_daojiaxianhua', '2017-12', 1, 1, 268.0],\n",
       " ['boluome', 'piaowu', '2017-12', 1, 1, 84.400000000000006],\n",
       " ['boluome', 'shengxian', '2017-12', 1, 1, 43.899999999999999],\n",
       " ['bsb', 'huoche', '2017-12', 29, 29, 7057.0],\n",
       " ['bsb', 'jiayouka', '2017-12', 9, 9, 900.0],\n",
       " ['bsb', 'liuliang', '2017-12', 10, 10, 319.85000000000002],\n",
       " ['bsb', 'mms_daojiaxianhua', '2017-12', 13, 13, 3484.0],\n",
       " ['jhbank', 'dianying', '2017-12', 1, 1, 32.0],\n",
       " ['jhbank', 'huafei', '2017-12', 16, 16, 1595.4099999999999],\n",
       " ['jhbank', 'waimai', '2017-12', 1, 1, 37.0],\n",
       " ['jst', 'huafei', '2017-12', 1, 1, 49.850000000000001],\n",
       " ['mybosc', 'dianying', '2017-12', 1, 1, 68.0],\n",
       " ['oklife', 'dianying', '2017-12', 9, 9, 608.0],\n",
       " ['oklife', 'jiudian', '2017-11', 2, 2, 760.0],\n",
       " ['oklife', 'jiudian', '2017-12', 22, 22, 13063.0],\n",
       " ['pingan-one', 'huafei', '2017-12', 517, 517, 47600.000000000357],\n",
       " ['pingan-one', 'jiayouka', '2017-11', 2, 2, 200.0],\n",
       " ['pingan-one', 'jiayouka', '2017-12', 35, 35, 17300.0],\n",
       " ['pingan-one', 'liuliang', '2017-12', 11, 11, 180.35999999999999],\n",
       " ['pingan-one', 'shenghuojiaofei', '2017-12', 3, 3, 146.44],\n",
       " ['pingan-one', 'weizhang', '2017-11', 1, 1, 168.0],\n",
       " ['pingan-one', 'weizhang', '2017-12', 7, 7, 1149.0],\n",
       " ['pms', 'huafei', '2017-12', 19, 19, 1994.1700000000008],\n",
       " ['pms', 'huoche', '2017-12', 1, 1, 558.0],\n",
       " ['pms', 'liuliang', '2017-12', 2, 2, 6.0],\n",
       " ['pms', 'menpiao', '2017-12', 1, 1, 205.0],\n",
       " ['pms', 'mms_daojiajiadianqingxi', '2017-12', 1, 1, 138.0],\n",
       " ['pms', 'mms_daojiajiadianweixiu', '2017-12', 1, 1, 30.0],\n",
       " ['pms', 'mms_daojiaxianhua', '2017-12', 8, 8, 2144.0],\n",
       " ['pms', 'waimai', '2017-12', 51, 51, 2959.46],\n",
       " ['tccb', 'dianying', '2017-12', 1, 1, 88.0],\n",
       " ['tccb', 'jiayouka', '2017-12', 6, 6, 600.0],\n",
       " ['tccb', 'waimai', '2017-12', 3, 3, 71.0],\n",
       " ['tccb', 'yongche', '2017-12', 2, 2, 123.2],\n",
       " ['vipjinrong', 'huafei', '2017-11', 1, 1, 49.899999999999999],\n",
       " ['vipjinrong', 'huafei', '2017-12', 2606, 2606, 250342.04000000289],\n",
       " ['vipjinrong', 'jiayouka', '2017-12', 46, 46, 21600.0],\n",
       " ['vipjinrong', 'liuliang', '2017-12', 48, 48, 1169.4700000000003],\n",
       " ['vipjinrong', 'shenghuojiaofei', '2017-12', 10, 10, 1109.54],\n",
       " ['vipjinrong', 'weizhang', '2017-12', 1, 1, 219.0]]"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "order_statistics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>week</th>\n",
       "      <th>pay</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808489589742</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512405e+12</td>\n",
       "      <td>1512403075803</td>\n",
       "      <td>34.88</td>\n",
       "      <td>[bp212808489720815]</td>\n",
       "      <td>3016206612566745101</td>\n",
       "      <td>bp212808489720815</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>04</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808487361421</td>\n",
       "      <td>huafei</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512403058675</td>\n",
       "      <td>99.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td></td>\n",
       "      <td>ala212808487361422</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>04</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808486050699</td>\n",
       "      <td>huafei</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512403048316</td>\n",
       "      <td>49.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td></td>\n",
       "      <td>ala212808486050700</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>04</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808484084617</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512414e+12</td>\n",
       "      <td>1512403033836</td>\n",
       "      <td>25.50</td>\n",
       "      <td>[bp212808484215690]</td>\n",
       "      <td>3016206651950494732</td>\n",
       "      <td>bp212808484215690</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>04</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808483560428</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.512414e+12</td>\n",
       "      <td>1512403029600</td>\n",
       "      <td>24.00</td>\n",
       "      <td>[bp212808483560429]</td>\n",
       "      <td>1214460321303985191</td>\n",
       "      <td>bp212808483560429</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>04</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   appCode channel                  id orderType payChannel  status  \\\n",
       "0  bestpay     ele   bp202808489589742    waimai    bestpay       4   \n",
       "1    91ala   ofpay  ala202808487361421    huafei        NaN       8   \n",
       "2    91ala   ofpay  ala202808486050699    huafei        NaN       8   \n",
       "3  bestpay     ele   bp202808484084617    waimai    bestpay       4   \n",
       "4  bestpay     ele   bp202808483560428    waimai    bestpay       4   \n",
       "\n",
       "    completedAt      createdAt  orderPrice             paidList  \\\n",
       "0  1.512405e+12  1512403075803       34.88  [bp212808489720815]   \n",
       "1           NaN  1512403058675       99.70                  NaN   \n",
       "2           NaN  1512403048316       49.90                  NaN   \n",
       "3  1.512414e+12  1512403033836       25.50  [bp212808484215690]   \n",
       "4  1.512414e+12  1512403029600       24.00  [bp212808483560429]   \n",
       "\n",
       "             partnerId       paymentSerial  year month day week  pay  \n",
       "0  3016206612566745101   bp212808489720815  2017    12  04    1    1  \n",
       "1                       ala212808487361422  2017    12  04    1    1  \n",
       "2                       ala212808486050700  2017    12  04    1    1  \n",
       "3  3016206651950494732   bp212808484215690  2017    12  04    1    1  \n",
       "4  1214460321303985191   bp212808483560429  2017    12  04    1    1  "
      ]
     },
     "execution_count": 129,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.08945488929748535\n"
     ]
    }
   ],
   "source": [
    "start=time.time()\n",
    "def timestamp_to_strftime(timestamp):\n",
    "    \"\"\"\n",
    "    :params timestamp ms: 1512984499427\n",
    "    \"\"\"\n",
    "    return pd.to_datetime(timestamp, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if timestamp else ''\n",
    "pd_data.createdAt.map(get_datetime_from_microsecond)\n",
    "print(time.time()-start)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "pd_data=pd_data.fillna('')\n",
    "pd_data.loc[pd_data['paidList']=='',['paidList']]=pd_data.paymentSerial.map(lambda x:[x] if x else [])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Traceback (most recent call last):\n",
      "  File \"<ipython-input-137-4a470d573be9>\", line 23, in <module>\n",
      "    refund_data = [{\"flow_id\": rdb_0.get('r_mapper:{}:{}'.format(item.appCode, item.id))}]\n",
      "  File \"/usr/local/python3/lib/python3.6/site-packages/redis/client.py\", line 880, in get\n",
      "    return self.execute_command('GET', name)\n",
      "  File \"/usr/local/python3/lib/python3.6/site-packages/redis/client.py\", line 573, in execute_command\n",
      "    return self.parse_response(connection, command_name, **options)\n",
      "  File \"/usr/local/python3/lib/python3.6/site-packages/redis/client.py\", line 585, in parse_response\n",
      "    response = connection.read_response()\n",
      "  File \"/usr/local/python3/lib/python3.6/site-packages/redis/connection.py\", line 582, in read_response\n",
      "    raise response\n",
      "redis.exceptions.ResponseError: WRONGTYPE Operation against a key holding the wrong kind of value\n",
      "\n",
      "Cost: 33.4578001499176\n"
     ]
    }
   ],
   "source": [
    "pay_data,count,begin=[],0,time.time()\n",
    "for index in range(len(pd_data)):\n",
    "    item = pd_data.loc[index]\n",
    "    for paid_id in item.paidList:\n",
    "        payment_data = rdb_1.hgetall('p:{0}:{1}'.format(item.appCode, paid_id))\n",
    "        if payment_data.get('status', '-1') in ['2', '3'] or item.status in [3, 4, 6, 7, 11]:\n",
    "            paid_time = payment_data.get('paidAt') or payment_data.get('createdAt')\n",
    "            if (not paid_time) or (not (start_time <= int(paid_time) < end_time)):\n",
    "                continue\n",
    "                \n",
    "            pay_data.append(\n",
    "                {\n",
    "                    'id': payment_data['id'],\n",
    "                    'payId': payment_data.get('serialNum', '') or payment_data.get('serial', ''),\n",
    "                    'paidTime': paid_time,\n",
    "                    'payPrice': payment_data.get('payPrice') or payment_data.get('price'),\n",
    "                    'transactionType': '交易',\n",
    "                    'chargeId': payment_data.get('chargeId', '')\n",
    "                }\n",
    "            )\n",
    "    if item.status ==7:\n",
    "        try:\n",
    "            refund_data = [{\"flow_id\": rdb_0.get('r_mapper:{}:{}'.format(item.appCode, item.id))}]\n",
    "        except:\n",
    "            refund_data=pg_select(\"SELECT flow_id FROM boluome_refund_flow WHERE order_id='{}';\".format(item.id),\n",
    "                                  pg('account'))\n",
    "            e=traceback.format_exc()\n",
    "            print(e)\n",
    "        for pg_data in refund_data:\n",
    "            refund_id = pg_data.get('flow_id')\n",
    "            refund_data = rdb_2.hgetall('r:{}:{}'.format(item.appCode, refund_id))\n",
    "            if refund_data.get('status', '-1') == '2':\n",
    "                refund_time = refund_data.get('refundedAt')\n",
    "                if (not refund_time) or (not (start_time <= int(refund_time) < end_time)):\n",
    "                    continue\n",
    "                pay_data.append(\n",
    "                    {\n",
    "                        'id': refund_data['id'],\n",
    "                        'payId': refund_id,\n",
    "                        'paidTime': refund_time,\n",
    "                        'payPrice': '-'+refund_data.get('price'),\n",
    "                        'transactionType': '退款',\n",
    "                        'chargeId': refund_data.get('chargeId', '')\n",
    "                    }\n",
    "                )\n",
    "    count+=1\n",
    "    print(count,end='\\r')\n",
    "print('Cost:',time.time()-begin)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5.3882598876953125e-05\n"
     ]
    }
   ],
   "source": [
    "l=set(pd_data.columns)\n",
    "s=time.time()\n",
    "'paidList' in l\n",
    "print(time.time()-s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 248,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(3, 2)"
      ]
     },
     "execution_count": 248,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "class t(object):\n",
    "    def __init__(self,a,b=None,c=None):\n",
    "        self.a=a\n",
    "        self.b=b\n",
    "        self.c=c\n",
    "s=t(1,c=3,b=2) \n",
    "s.c,s.b"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "pd_data = pd.merge(pd_data, pd.DataFrame(pay_data), on=\"id\", how=\"right\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "      <th>chargeId</th>\n",
       "      <th>paidTime</th>\n",
       "      <th>payId</th>\n",
       "      <th>payPrice</th>\n",
       "      <th>transactionType</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202797681122095</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>1512320613148</td>\n",
       "      <td>49.85</td>\n",
       "      <td>[ala212797681122096]</td>\n",
       "      <td>S1712042122650</td>\n",
       "      <td>ala212797681122096</td>\n",
       "      <td></td>\n",
       "      <td>1512320649887</td>\n",
       "      <td>ala212797681122096</td>\n",
       "      <td>4985</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808489589742</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512403075803</td>\n",
       "      <td>34.88</td>\n",
       "      <td>[bp212808489720815]</td>\n",
       "      <td>3016206612566745101</td>\n",
       "      <td>bp212808489720815</td>\n",
       "      <td></td>\n",
       "      <td>1512403102814</td>\n",
       "      <td>bp212808489720815</td>\n",
       "      <td>3488</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808484084617</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512403033836</td>\n",
       "      <td>25.50</td>\n",
       "      <td>[bp212808484215690]</td>\n",
       "      <td>3016206651950494732</td>\n",
       "      <td>bp212808484215690</td>\n",
       "      <td></td>\n",
       "      <td>1512403045582</td>\n",
       "      <td>bp212808484215690</td>\n",
       "      <td>2550</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808483560428</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512403029600</td>\n",
       "      <td>24.00</td>\n",
       "      <td>[bp212808483560429]</td>\n",
       "      <td>1214460321303985191</td>\n",
       "      <td>bp212808483560429</td>\n",
       "      <td></td>\n",
       "      <td>1512403038473</td>\n",
       "      <td>bp212808483560429</td>\n",
       "      <td>2400</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808479628165</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512403000296</td>\n",
       "      <td>22.00</td>\n",
       "      <td>[bp212808479759238]</td>\n",
       "      <td>1214460281299286189</td>\n",
       "      <td>bp212808479759238</td>\n",
       "      <td></td>\n",
       "      <td>1512403017184</td>\n",
       "      <td>bp212808479759238</td>\n",
       "      <td>2200</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808479497091</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512402998628</td>\n",
       "      <td>59.20</td>\n",
       "      <td>[bp212808479497092]</td>\n",
       "      <td>3016206681989089457</td>\n",
       "      <td>bp212808479497092</td>\n",
       "      <td></td>\n",
       "      <td>1512403018060</td>\n",
       "      <td>bp212808479497092</td>\n",
       "      <td>5920</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808473074666</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402949612</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212808473074667]</td>\n",
       "      <td>3016206585705608301</td>\n",
       "      <td>bp212808473074667</td>\n",
       "      <td></td>\n",
       "      <td>1512402963083</td>\n",
       "      <td>bp212808473074667</td>\n",
       "      <td>1700</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808445025246</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402735234</td>\n",
       "      <td>49.90</td>\n",
       "      <td>[ala212808445025247]</td>\n",
       "      <td>S1712043737419</td>\n",
       "      <td>ala212808445025247</td>\n",
       "      <td></td>\n",
       "      <td>1512402755684</td>\n",
       "      <td>ala212808445025247</td>\n",
       "      <td>4990</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808443845594</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402726825</td>\n",
       "      <td>54.50</td>\n",
       "      <td>[bp212808443976667]</td>\n",
       "      <td>3016206541993077799</td>\n",
       "      <td>bp212808443976667</td>\n",
       "      <td></td>\n",
       "      <td>1512402742129</td>\n",
       "      <td>bp212808443976667</td>\n",
       "      <td>5450</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808437029748</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512402675013</td>\n",
       "      <td>15.90</td>\n",
       "      <td>[bp212808437029749]</td>\n",
       "      <td>3016206573484116101</td>\n",
       "      <td>bp212808437029749</td>\n",
       "      <td></td>\n",
       "      <td>1512402689524</td>\n",
       "      <td>bp212808437029749</td>\n",
       "      <td>1590</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808411339628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512402479028</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212808411470701]</td>\n",
       "      <td>3016206499143901324</td>\n",
       "      <td>bp212808411470701</td>\n",
       "      <td></td>\n",
       "      <td>1512402518414</td>\n",
       "      <td>bp212808411470701</td>\n",
       "      <td>2800</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808407407467</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402449310</td>\n",
       "      <td>32.00</td>\n",
       "      <td>[bp212808407538640]</td>\n",
       "      <td>3016206497650923566</td>\n",
       "      <td>bp212808407538640</td>\n",
       "      <td></td>\n",
       "      <td>1512402459675</td>\n",
       "      <td>bp212808407538640</td>\n",
       "      <td>3200</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808402164586</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402409001</td>\n",
       "      <td>83.20</td>\n",
       "      <td>[bp212808402295756]</td>\n",
       "      <td>3016206495679641735</td>\n",
       "      <td>bp212808402295756</td>\n",
       "      <td></td>\n",
       "      <td>1512402419376</td>\n",
       "      <td>bp212808402295756</td>\n",
       "      <td>8320</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808393251784</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402340462</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808393251687]</td>\n",
       "      <td>S1712043733819</td>\n",
       "      <td>ala212808393251687</td>\n",
       "      <td></td>\n",
       "      <td>1512402353008</td>\n",
       "      <td>ala212808393251687</td>\n",
       "      <td>9970</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808385125218</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402278507</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808385125219]</td>\n",
       "      <td>S1712043733546</td>\n",
       "      <td>ala212808385125219</td>\n",
       "      <td></td>\n",
       "      <td>1512402307871</td>\n",
       "      <td>ala212808385125219</td>\n",
       "      <td>9970</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808374770628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402200035</td>\n",
       "      <td>36.92</td>\n",
       "      <td>[bp212808374901701]</td>\n",
       "      <td>3016206421239033043</td>\n",
       "      <td>bp212808374901701</td>\n",
       "      <td></td>\n",
       "      <td>1512402213235</td>\n",
       "      <td>bp212808374901701</td>\n",
       "      <td>3692</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808373459906</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402189503</td>\n",
       "      <td>21.00</td>\n",
       "      <td>[bp212808373459907]</td>\n",
       "      <td>3016206484883682496</td>\n",
       "      <td>bp212808373459907</td>\n",
       "      <td></td>\n",
       "      <td>1512402200615</td>\n",
       "      <td>bp212808373459907</td>\n",
       "      <td>2100</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808354061150</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512402041786</td>\n",
       "      <td>52.00</td>\n",
       "      <td>[bp212808354061151]</td>\n",
       "      <td>1214460178354088045</td>\n",
       "      <td>bp212808354061151</td>\n",
       "      <td></td>\n",
       "      <td>1512402048708</td>\n",
       "      <td>bp212808354061151</td>\n",
       "      <td>5200</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808344886105</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401972025</td>\n",
       "      <td>26.90</td>\n",
       "      <td>[bp212808345017270]</td>\n",
       "      <td>3016206373625427094</td>\n",
       "      <td>bp212808345017270</td>\n",
       "      <td></td>\n",
       "      <td>1512401984350</td>\n",
       "      <td>bp212808345017270</td>\n",
       "      <td>2690</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808335186861</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401897750</td>\n",
       "      <td>38.30</td>\n",
       "      <td>[bp212808346196919]</td>\n",
       "      <td>1214460172951901228</td>\n",
       "      <td>bp212808346196919</td>\n",
       "      <td></td>\n",
       "      <td>1512401990248</td>\n",
       "      <td>bp212808346196919</td>\n",
       "      <td>3830</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808330992471</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512401865650</td>\n",
       "      <td>12.44</td>\n",
       "      <td>[bp212808330992472]</td>\n",
       "      <td>3016206366981752988</td>\n",
       "      <td>bp212808330992472</td>\n",
       "      <td></td>\n",
       "      <td>1512401879573</td>\n",
       "      <td>bp212808330992472</td>\n",
       "      <td>1244</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808327453607</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401839055</td>\n",
       "      <td>20.00</td>\n",
       "      <td>[bp212808327584680]</td>\n",
       "      <td>3016206341161373771</td>\n",
       "      <td>bp212808327584680</td>\n",
       "      <td></td>\n",
       "      <td>1512401855885</td>\n",
       "      <td>bp212808327584680</td>\n",
       "      <td>2000</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808324438869</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401816766</td>\n",
       "      <td>26.10</td>\n",
       "      <td>[bp212808324569942]</td>\n",
       "      <td>3016206399840121901</td>\n",
       "      <td>bp212808324569942</td>\n",
       "      <td></td>\n",
       "      <td>1512401827737</td>\n",
       "      <td>bp212808324569942</td>\n",
       "      <td>2610</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808310938534</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512401713910</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212808311200591]</td>\n",
       "      <td>1214460149807396985</td>\n",
       "      <td>bp212808311200591</td>\n",
       "      <td></td>\n",
       "      <td>1512401725260</td>\n",
       "      <td>bp212808311200591</td>\n",
       "      <td>3600</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808294030153</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401584516</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212808294161226]</td>\n",
       "      <td>3016206350967467142</td>\n",
       "      <td>bp212808294161226</td>\n",
       "      <td></td>\n",
       "      <td>1512401595014</td>\n",
       "      <td>bp212808294161226</td>\n",
       "      <td>2800</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808290229153</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512401554553</td>\n",
       "      <td>37.80</td>\n",
       "      <td>[bp212808290360226]</td>\n",
       "      <td>1214460101548234803</td>\n",
       "      <td>bp212808290360226</td>\n",
       "      <td></td>\n",
       "      <td>1512401677124</td>\n",
       "      <td>bp212808290360226</td>\n",
       "      <td>3780</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808288262981</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512401540092</td>\n",
       "      <td>19.00</td>\n",
       "      <td>[bp212808288394054]</td>\n",
       "      <td>3016206258986994885</td>\n",
       "      <td>bp212808288394054</td>\n",
       "      <td></td>\n",
       "      <td>1512401600949</td>\n",
       "      <td>bp212808288394054</td>\n",
       "      <td>1900</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808282758043</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401497460</td>\n",
       "      <td>13.50</td>\n",
       "      <td>[bp212808290360227]</td>\n",
       "      <td>3016206320775468236</td>\n",
       "      <td>bp212808290360227</td>\n",
       "      <td></td>\n",
       "      <td>1512401563649</td>\n",
       "      <td>bp212808290360227</td>\n",
       "      <td>1350</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808280529731</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>4</td>\n",
       "      <td>1.5124e+12</td>\n",
       "      <td>1512401480463</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808280529732]</td>\n",
       "      <td>S1712043728370</td>\n",
       "      <td>ala212808280529732</td>\n",
       "      <td></td>\n",
       "      <td>1512401492847</td>\n",
       "      <td>ala212808280529732</td>\n",
       "      <td>9970</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808276859711</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>4</td>\n",
       "      <td>1.51241e+12</td>\n",
       "      <td>1512401453404</td>\n",
       "      <td>23.80</td>\n",
       "      <td>[bp212808276990784]</td>\n",
       "      <td>1214460029439505633</td>\n",
       "      <td>bp212808276990784</td>\n",
       "      <td></td>\n",
       "      <td>1512401466208</td>\n",
       "      <td>bp212808276990784</td>\n",
       "      <td>2380</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19853</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ele</td>\n",
       "      <td>ala202778383780864</td>\n",
       "      <td>waimai</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512173386572</td>\n",
       "      <td>24.68</td>\n",
       "      <td>[ala212778383780667]</td>\n",
       "      <td>3016070197384086606</td>\n",
       "      <td>ala212778383780667</td>\n",
       "      <td></td>\n",
       "      <td>1512173407361</td>\n",
       "      <td>ala212778383780667</td>\n",
       "      <td>2468</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19854</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202778182847429</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512171854171</td>\n",
       "      <td>17.50</td>\n",
       "      <td>[bp212778182978293]</td>\n",
       "      <td>3016070035467008215</td>\n",
       "      <td>bp212778182978293</td>\n",
       "      <td></td>\n",
       "      <td>1512171869695</td>\n",
       "      <td>bp212778182978293</td>\n",
       "      <td>1750</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19855</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202777679530628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512168014022</td>\n",
       "      <td>21.00</td>\n",
       "      <td>[bp212777679661701]</td>\n",
       "      <td>1214337864136397050</td>\n",
       "      <td>bp212777679661701</td>\n",
       "      <td></td>\n",
       "      <td>1512168029407</td>\n",
       "      <td>bp212777679661701</td>\n",
       "      <td>2100</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19856</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202777244109389</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512164691630</td>\n",
       "      <td>39.02</td>\n",
       "      <td>[bp212777250663196]</td>\n",
       "      <td>3016069705626406998</td>\n",
       "      <td>bp212777250663196</td>\n",
       "      <td></td>\n",
       "      <td>1512164750777</td>\n",
       "      <td>bp212777250663196</td>\n",
       "      <td>3902</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19857</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ele</td>\n",
       "      <td>ala202776468556294</td>\n",
       "      <td>waimai</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512158775258</td>\n",
       "      <td>120.20</td>\n",
       "      <td>[ala212776468687367]</td>\n",
       "      <td>1214337749512361151</td>\n",
       "      <td>ala212776468687367</td>\n",
       "      <td></td>\n",
       "      <td>1512158788996</td>\n",
       "      <td>ala212776468687367</td>\n",
       "      <td>12020</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19858</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202775063464236</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512148054589</td>\n",
       "      <td>21.99</td>\n",
       "      <td>[bp212775063464237]</td>\n",
       "      <td>3016069031065367692</td>\n",
       "      <td>bp212775063464237</td>\n",
       "      <td></td>\n",
       "      <td>1512148062326</td>\n",
       "      <td>bp212775063464237</td>\n",
       "      <td>2199</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19859</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774860433660</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512146505427</td>\n",
       "      <td>39.00</td>\n",
       "      <td>[bp212774860433661]</td>\n",
       "      <td>3016068842011410569</td>\n",
       "      <td>bp212774860433661</td>\n",
       "      <td></td>\n",
       "      <td>1512146528305</td>\n",
       "      <td>bp212774860433661</td>\n",
       "      <td>3900</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19860</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774797650348</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td>1.51216e+12</td>\n",
       "      <td>1512146026953</td>\n",
       "      <td>32.00</td>\n",
       "      <td>[bp212774797781421]</td>\n",
       "      <td>1214337062778723464</td>\n",
       "      <td>bp212774797781421</td>\n",
       "      <td></td>\n",
       "      <td>1512146040072</td>\n",
       "      <td>bp212774797781421</td>\n",
       "      <td>3200</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19861</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774549006660</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512144130064</td>\n",
       "      <td>23.00</td>\n",
       "      <td>[bp212774549137733]</td>\n",
       "      <td>3016068412372062360</td>\n",
       "      <td>bp212774549137733</td>\n",
       "      <td></td>\n",
       "      <td>1512144147571</td>\n",
       "      <td>bp212774549137733</td>\n",
       "      <td>2300</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19862</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774529214782</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512143979205</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212774529345855]</td>\n",
       "      <td>1214336906280852723</td>\n",
       "      <td>bp212774529345855</td>\n",
       "      <td></td>\n",
       "      <td>1512143994565</td>\n",
       "      <td>bp212774529345855</td>\n",
       "      <td>3600</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19863</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774388705512</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512142907161</td>\n",
       "      <td>23.00</td>\n",
       "      <td>[bp212774390278207]</td>\n",
       "      <td>3016068091809707013</td>\n",
       "      <td>bp212774390278207</td>\n",
       "      <td></td>\n",
       "      <td>1512142927515</td>\n",
       "      <td>bp212774390278207</td>\n",
       "      <td>2300</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19864</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774262352010</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512141943590</td>\n",
       "      <td>40.00</td>\n",
       "      <td>[bp212774262483083]</td>\n",
       "      <td>1214336536150301843</td>\n",
       "      <td>bp212774262483083</td>\n",
       "      <td></td>\n",
       "      <td>1512141957455</td>\n",
       "      <td>bp212774262483083</td>\n",
       "      <td>4000</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19865</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773905311648</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512139219531</td>\n",
       "      <td>16.00</td>\n",
       "      <td>[bp212773905442721]</td>\n",
       "      <td>1214335902886270096</td>\n",
       "      <td>bp212773905442721</td>\n",
       "      <td></td>\n",
       "      <td>1512139229264</td>\n",
       "      <td>bp212773905442721</td>\n",
       "      <td>1600</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19866</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773817886454</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512138551751</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212773818017528]</td>\n",
       "      <td>1214335767546608836</td>\n",
       "      <td>bp212773818017528</td>\n",
       "      <td></td>\n",
       "      <td>1512138579644</td>\n",
       "      <td>bp212773818017528</td>\n",
       "      <td>1700</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19867</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773773584163</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512138214359</td>\n",
       "      <td>21.33</td>\n",
       "      <td>[bp212773773715236]</td>\n",
       "      <td>3016066530530123980</td>\n",
       "      <td>bp212773773715236</td>\n",
       "      <td></td>\n",
       "      <td>1512138221963</td>\n",
       "      <td>bp212773773715236</td>\n",
       "      <td>2133</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19868</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773568325289</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512136648122</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212773568456250]</td>\n",
       "      <td>1214335145724171352</td>\n",
       "      <td>bp212773568456250</td>\n",
       "      <td></td>\n",
       "      <td>1512136661000</td>\n",
       "      <td>bp212773568456250</td>\n",
       "      <td>3600</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19869</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773557970485</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512136568371</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212773557970486]</td>\n",
       "      <td>3016065848192633901</td>\n",
       "      <td>bp212773557970486</td>\n",
       "      <td></td>\n",
       "      <td>1512136578871</td>\n",
       "      <td>bp212773557970486</td>\n",
       "      <td>2800</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19870</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773538047615</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512136416916</td>\n",
       "      <td>27.00</td>\n",
       "      <td>[bp212773540931205]</td>\n",
       "      <td>1214335066114325541</td>\n",
       "      <td>bp212773540931205</td>\n",
       "      <td></td>\n",
       "      <td>1512136453534</td>\n",
       "      <td>bp212773540931205</td>\n",
       "      <td>2700</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19871</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773514716678</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512136239205</td>\n",
       "      <td>34.00</td>\n",
       "      <td>[bp212773514847751]</td>\n",
       "      <td>1214335051788538959</td>\n",
       "      <td>bp212773514847751</td>\n",
       "      <td></td>\n",
       "      <td>1512136269106</td>\n",
       "      <td>bp212773514847751</td>\n",
       "      <td>3400</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19872</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773510260336</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512136206151</td>\n",
       "      <td>27.80</td>\n",
       "      <td>[bp212773510522481]</td>\n",
       "      <td>1214334958665497764</td>\n",
       "      <td>bp212773510522481</td>\n",
       "      <td></td>\n",
       "      <td>1512136220252</td>\n",
       "      <td>bp212773510522481</td>\n",
       "      <td>2780</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19873</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773391246740</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512135296784</td>\n",
       "      <td>25.08</td>\n",
       "      <td>[bp212773391246878]</td>\n",
       "      <td>3016065190768856085</td>\n",
       "      <td>bp212773391246878</td>\n",
       "      <td></td>\n",
       "      <td>1512135311619</td>\n",
       "      <td>bp212773391246878</td>\n",
       "      <td>2508</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19874</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773267776793</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512134354777</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212773267907866]</td>\n",
       "      <td>3016064713918544056</td>\n",
       "      <td>bp212773267907866</td>\n",
       "      <td></td>\n",
       "      <td>1512134374496</td>\n",
       "      <td>bp212773267907866</td>\n",
       "      <td>1700</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19875</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773209842907</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512133913201</td>\n",
       "      <td>19.00</td>\n",
       "      <td>[bp212773209973980]</td>\n",
       "      <td>1214334173930426436</td>\n",
       "      <td>bp212773209973980</td>\n",
       "      <td></td>\n",
       "      <td>1512133930248</td>\n",
       "      <td>bp212773209973980</td>\n",
       "      <td>1900</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19876</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773177992539</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512133669999</td>\n",
       "      <td>44.00</td>\n",
       "      <td>[bp212773178123612]</td>\n",
       "      <td>1214333959238484040</td>\n",
       "      <td>bp212773178123612</td>\n",
       "      <td></td>\n",
       "      <td>1512133677174</td>\n",
       "      <td>bp212773178123612</td>\n",
       "      <td>4400</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19877</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773000389675</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512132314671</td>\n",
       "      <td>33.00</td>\n",
       "      <td>[bp212773000389676]</td>\n",
       "      <td>1214333400959896665</td>\n",
       "      <td>bp212773000389676</td>\n",
       "      <td></td>\n",
       "      <td>1512132331440</td>\n",
       "      <td>bp212773000389676</td>\n",
       "      <td>3300</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19878</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772987282637</td>\n",
       "      <td>coffee</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512132214346</td>\n",
       "      <td>46.00</td>\n",
       "      <td>[ala212772987282638]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td></td>\n",
       "      <td>1512132229168</td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td>4600</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19879</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772987282637</td>\n",
       "      <td>coffee</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512132214346</td>\n",
       "      <td>46.00</td>\n",
       "      <td>[ala212772987282638]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td></td>\n",
       "      <td>1512201855295</td>\n",
       "      <td>ala222772989248720</td>\n",
       "      <td>4600</td>\n",
       "      <td>退款</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19880</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202772725924788</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512130220688</td>\n",
       "      <td>39.00</td>\n",
       "      <td>[bp212772726055715]</td>\n",
       "      <td>1214332264051822635</td>\n",
       "      <td>bp212772726055715</td>\n",
       "      <td></td>\n",
       "      <td>1512130238207</td>\n",
       "      <td>bp212772726055715</td>\n",
       "      <td>3900</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19881</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202772711768852</td>\n",
       "      <td>waimai</td>\n",
       "      <td>bestpay</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512130113186</td>\n",
       "      <td>110.39</td>\n",
       "      <td>[bp212772711899925]</td>\n",
       "      <td>1214332208216699081</td>\n",
       "      <td>bp212772711899925</td>\n",
       "      <td></td>\n",
       "      <td>1512130124624</td>\n",
       "      <td>bp212772711899925</td>\n",
       "      <td>11039</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19882</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772631552849</td>\n",
       "      <td>paotui</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>1512129500899</td>\n",
       "      <td>12.00</td>\n",
       "      <td>[ala212772631552850]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772631552850</td>\n",
       "      <td></td>\n",
       "      <td>1512129513970</td>\n",
       "      <td>ala212772631552850</td>\n",
       "      <td>1200</td>\n",
       "      <td>交易</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19883 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       appCode channel                  id orderType payChannel  status  \\\n",
       "0        91ala   ofpay  ala202797681122095    huafei     fanbei       0   \n",
       "1      bestpay     ele   bp202808489589742    waimai    bestpay       4   \n",
       "2      bestpay     ele   bp202808484084617    waimai    bestpay       4   \n",
       "3      bestpay     ele   bp202808483560428    waimai    bestpay       4   \n",
       "4      bestpay     ele   bp202808479628165    waimai    bestpay       4   \n",
       "5      bestpay     ele   bp202808479497091    waimai    bestpay       4   \n",
       "6      bestpay     ele   bp202808473074666    waimai    bestpay       4   \n",
       "7        91ala   ofpay  ala202808445025246    huafei     fanbei       4   \n",
       "8      bestpay     ele   bp202808443845594    waimai    bestpay       4   \n",
       "9      bestpay     ele   bp202808437029748    waimai    bestpay       4   \n",
       "10     bestpay     ele   bp202808411339628    waimai    bestpay       4   \n",
       "11     bestpay     ele   bp202808407407467    waimai    bestpay       4   \n",
       "12     bestpay     ele   bp202808402164586    waimai    bestpay       4   \n",
       "13       91ala   ofpay  ala202808393251784    huafei     fanbei       4   \n",
       "14       91ala   ofpay  ala202808385125218    huafei     fanbei       4   \n",
       "15     bestpay     ele   bp202808374770628    waimai    bestpay       4   \n",
       "16     bestpay     ele   bp202808373459906    waimai    bestpay       4   \n",
       "17     bestpay     ele   bp202808354061150    waimai    bestpay       4   \n",
       "18     bestpay     ele   bp202808344886105    waimai    bestpay       4   \n",
       "19     bestpay     ele   bp202808335186861    waimai    bestpay       4   \n",
       "20     bestpay     ele   bp202808330992471    waimai    bestpay       4   \n",
       "21     bestpay     ele   bp202808327453607    waimai    bestpay       4   \n",
       "22     bestpay     ele   bp202808324438869    waimai    bestpay       4   \n",
       "23     bestpay     ele   bp202808310938534    waimai    bestpay       4   \n",
       "24     bestpay     ele   bp202808294030153    waimai    bestpay       4   \n",
       "25     bestpay     ele   bp202808290229153    waimai    bestpay       4   \n",
       "26     bestpay     ele   bp202808288262981    waimai    bestpay       4   \n",
       "27     bestpay     ele   bp202808282758043    waimai    bestpay       4   \n",
       "28       91ala   ofpay  ala202808280529731    huafei     fanbei       4   \n",
       "29     bestpay     ele   bp202808276859711    waimai    bestpay       4   \n",
       "...        ...     ...                 ...       ...        ...     ...   \n",
       "19853    91ala     ele  ala202778383780864    waimai     fanbei       7   \n",
       "19854  bestpay     ele   bp202778182847429    waimai    bestpay       7   \n",
       "19855  bestpay     ele   bp202777679530628    waimai    bestpay       7   \n",
       "19856  bestpay     ele   bp202777244109389    waimai    bestpay       7   \n",
       "19857    91ala     ele  ala202776468556294    waimai     fanbei       7   \n",
       "19858  bestpay     ele   bp202775063464236    waimai    bestpay       7   \n",
       "19859  bestpay     ele   bp202774860433660    waimai    bestpay       7   \n",
       "19860  bestpay     ele   bp202774797650348    waimai    bestpay       7   \n",
       "19861  bestpay     ele   bp202774549006660    waimai    bestpay       7   \n",
       "19862  bestpay     ele   bp202774529214782    waimai    bestpay       7   \n",
       "19863  bestpay     ele   bp202774388705512    waimai    bestpay       7   \n",
       "19864  bestpay     ele   bp202774262352010    waimai    bestpay       7   \n",
       "19865  bestpay     ele   bp202773905311648    waimai    bestpay       7   \n",
       "19866  bestpay     ele   bp202773817886454    waimai    bestpay       7   \n",
       "19867  bestpay     ele   bp202773773584163    waimai    bestpay       7   \n",
       "19868  bestpay     ele   bp202773568325289    waimai    bestpay       7   \n",
       "19869  bestpay     ele   bp202773557970485    waimai    bestpay       7   \n",
       "19870  bestpay     ele   bp202773538047615    waimai    bestpay       7   \n",
       "19871  bestpay     ele   bp202773514716678    waimai    bestpay       7   \n",
       "19872  bestpay     ele   bp202773510260336    waimai    bestpay       7   \n",
       "19873  bestpay     ele   bp202773391246740    waimai    bestpay       7   \n",
       "19874  bestpay     ele   bp202773267776793    waimai    bestpay       7   \n",
       "19875  bestpay     ele   bp202773209842907    waimai    bestpay       7   \n",
       "19876  bestpay     ele   bp202773177992539    waimai    bestpay       7   \n",
       "19877  bestpay     ele   bp202773000389675    waimai    bestpay       7   \n",
       "19878    91ala   linqu  ala202772987282637    coffee     fanbei       7   \n",
       "19879    91ala   linqu  ala202772987282637    coffee     fanbei       7   \n",
       "19880  bestpay     ele   bp202772725924788    waimai    bestpay       7   \n",
       "19881  bestpay     ele   bp202772711768852    waimai    bestpay       7   \n",
       "19882    91ala   linqu  ala202772631552849    paotui     fanbei       7   \n",
       "\n",
       "       completedAt      createdAt  orderPrice              paidList  \\\n",
       "0                   1512320613148       49.85  [ala212797681122096]   \n",
       "1      1.51241e+12  1512403075803       34.88   [bp212808489720815]   \n",
       "2      1.51241e+12  1512403033836       25.50   [bp212808484215690]   \n",
       "3      1.51241e+12  1512403029600       24.00   [bp212808483560429]   \n",
       "4      1.51241e+12  1512403000296       22.00   [bp212808479759238]   \n",
       "5      1.51241e+12  1512402998628       59.20   [bp212808479497092]   \n",
       "6       1.5124e+12  1512402949612       17.00   [bp212808473074667]   \n",
       "7       1.5124e+12  1512402735234       49.90  [ala212808445025247]   \n",
       "8       1.5124e+12  1512402726825       54.50   [bp212808443976667]   \n",
       "9      1.51241e+12  1512402675013       15.90   [bp212808437029749]   \n",
       "10     1.51241e+12  1512402479028       28.00   [bp212808411470701]   \n",
       "11      1.5124e+12  1512402449310       32.00   [bp212808407538640]   \n",
       "12      1.5124e+12  1512402409001       83.20   [bp212808402295756]   \n",
       "13      1.5124e+12  1512402340462       99.70  [ala212808393251687]   \n",
       "14      1.5124e+12  1512402278507       99.70  [ala212808385125219]   \n",
       "15      1.5124e+12  1512402200035       36.92   [bp212808374901701]   \n",
       "16      1.5124e+12  1512402189503       21.00   [bp212808373459907]   \n",
       "17      1.5124e+12  1512402041786       52.00   [bp212808354061151]   \n",
       "18      1.5124e+12  1512401972025       26.90   [bp212808345017270]   \n",
       "19      1.5124e+12  1512401897750       38.30   [bp212808346196919]   \n",
       "20     1.51241e+12  1512401865650       12.44   [bp212808330992472]   \n",
       "21      1.5124e+12  1512401839055       20.00   [bp212808327584680]   \n",
       "22      1.5124e+12  1512401816766       26.10   [bp212808324569942]   \n",
       "23     1.51241e+12  1512401713910       36.00   [bp212808311200591]   \n",
       "24      1.5124e+12  1512401584516       28.00   [bp212808294161226]   \n",
       "25     1.51241e+12  1512401554553       37.80   [bp212808290360226]   \n",
       "26     1.51241e+12  1512401540092       19.00   [bp212808288394054]   \n",
       "27      1.5124e+12  1512401497460       13.50   [bp212808290360227]   \n",
       "28      1.5124e+12  1512401480463       99.70  [ala212808280529732]   \n",
       "29     1.51241e+12  1512401453404       23.80   [bp212808276990784]   \n",
       "...            ...            ...         ...                   ...   \n",
       "19853               1512173386572       24.68  [ala212778383780667]   \n",
       "19854               1512171854171       17.50   [bp212778182978293]   \n",
       "19855               1512168014022       21.00   [bp212777679661701]   \n",
       "19856               1512164691630       39.02   [bp212777250663196]   \n",
       "19857               1512158775258      120.20  [ala212776468687367]   \n",
       "19858               1512148054589       21.99   [bp212775063464237]   \n",
       "19859               1512146505427       39.00   [bp212774860433661]   \n",
       "19860  1.51216e+12  1512146026953       32.00   [bp212774797781421]   \n",
       "19861               1512144130064       23.00   [bp212774549137733]   \n",
       "19862               1512143979205       36.00   [bp212774529345855]   \n",
       "19863               1512142907161       23.00   [bp212774390278207]   \n",
       "19864               1512141943590       40.00   [bp212774262483083]   \n",
       "19865               1512139219531       16.00   [bp212773905442721]   \n",
       "19866               1512138551751       17.00   [bp212773818017528]   \n",
       "19867               1512138214359       21.33   [bp212773773715236]   \n",
       "19868               1512136648122       36.00   [bp212773568456250]   \n",
       "19869               1512136568371       28.00   [bp212773557970486]   \n",
       "19870               1512136416916       27.00   [bp212773540931205]   \n",
       "19871               1512136239205       34.00   [bp212773514847751]   \n",
       "19872               1512136206151       27.80   [bp212773510522481]   \n",
       "19873               1512135296784       25.08   [bp212773391246878]   \n",
       "19874               1512134354777       17.00   [bp212773267907866]   \n",
       "19875               1512133913201       19.00   [bp212773209973980]   \n",
       "19876               1512133669999       44.00   [bp212773178123612]   \n",
       "19877               1512132314671       33.00   [bp212773000389676]   \n",
       "19878               1512132214346       46.00  [ala212772987282638]   \n",
       "19879               1512132214346       46.00  [ala212772987282638]   \n",
       "19880               1512130220688       39.00   [bp212772726055715]   \n",
       "19881               1512130113186      110.39   [bp212772711899925]   \n",
       "19882               1512129500899       12.00  [ala212772631552850]   \n",
       "\n",
       "                 partnerId       paymentSerial chargeId       paidTime  \\\n",
       "0           S1712042122650  ala212797681122096           1512320649887   \n",
       "1      3016206612566745101   bp212808489720815           1512403102814   \n",
       "2      3016206651950494732   bp212808484215690           1512403045582   \n",
       "3      1214460321303985191   bp212808483560429           1512403038473   \n",
       "4      1214460281299286189   bp212808479759238           1512403017184   \n",
       "5      3016206681989089457   bp212808479497092           1512403018060   \n",
       "6      3016206585705608301   bp212808473074667           1512402963083   \n",
       "7           S1712043737419  ala212808445025247           1512402755684   \n",
       "8      3016206541993077799   bp212808443976667           1512402742129   \n",
       "9      3016206573484116101   bp212808437029749           1512402689524   \n",
       "10     3016206499143901324   bp212808411470701           1512402518414   \n",
       "11     3016206497650923566   bp212808407538640           1512402459675   \n",
       "12     3016206495679641735   bp212808402295756           1512402419376   \n",
       "13          S1712043733819  ala212808393251687           1512402353008   \n",
       "14          S1712043733546  ala212808385125219           1512402307871   \n",
       "15     3016206421239033043   bp212808374901701           1512402213235   \n",
       "16     3016206484883682496   bp212808373459907           1512402200615   \n",
       "17     1214460178354088045   bp212808354061151           1512402048708   \n",
       "18     3016206373625427094   bp212808345017270           1512401984350   \n",
       "19     1214460172951901228   bp212808346196919           1512401990248   \n",
       "20     3016206366981752988   bp212808330992472           1512401879573   \n",
       "21     3016206341161373771   bp212808327584680           1512401855885   \n",
       "22     3016206399840121901   bp212808324569942           1512401827737   \n",
       "23     1214460149807396985   bp212808311200591           1512401725260   \n",
       "24     3016206350967467142   bp212808294161226           1512401595014   \n",
       "25     1214460101548234803   bp212808290360226           1512401677124   \n",
       "26     3016206258986994885   bp212808288394054           1512401600949   \n",
       "27     3016206320775468236   bp212808290360227           1512401563649   \n",
       "28          S1712043728370  ala212808280529732           1512401492847   \n",
       "29     1214460029439505633   bp212808276990784           1512401466208   \n",
       "...                    ...                 ...      ...            ...   \n",
       "19853  3016070197384086606  ala212778383780667           1512173407361   \n",
       "19854  3016070035467008215   bp212778182978293           1512171869695   \n",
       "19855  1214337864136397050   bp212777679661701           1512168029407   \n",
       "19856  3016069705626406998   bp212777250663196           1512164750777   \n",
       "19857  1214337749512361151  ala212776468687367           1512158788996   \n",
       "19858  3016069031065367692   bp212775063464237           1512148062326   \n",
       "19859  3016068842011410569   bp212774860433661           1512146528305   \n",
       "19860  1214337062778723464   bp212774797781421           1512146040072   \n",
       "19861  3016068412372062360   bp212774549137733           1512144147571   \n",
       "19862  1214336906280852723   bp212774529345855           1512143994565   \n",
       "19863  3016068091809707013   bp212774390278207           1512142927515   \n",
       "19864  1214336536150301843   bp212774262483083           1512141957455   \n",
       "19865  1214335902886270096   bp212773905442721           1512139229264   \n",
       "19866  1214335767546608836   bp212773818017528           1512138579644   \n",
       "19867  3016066530530123980   bp212773773715236           1512138221963   \n",
       "19868  1214335145724171352   bp212773568456250           1512136661000   \n",
       "19869  3016065848192633901   bp212773557970486           1512136578871   \n",
       "19870  1214335066114325541   bp212773540931205           1512136453534   \n",
       "19871  1214335051788538959   bp212773514847751           1512136269106   \n",
       "19872  1214334958665497764   bp212773510522481           1512136220252   \n",
       "19873  3016065190768856085   bp212773391246878           1512135311619   \n",
       "19874  3016064713918544056   bp212773267907866           1512134374496   \n",
       "19875  1214334173930426436   bp212773209973980           1512133930248   \n",
       "19876  1214333959238484040   bp212773178123612           1512133677174   \n",
       "19877  1214333400959896665   bp212773000389676           1512132331440   \n",
       "19878                       ala212772987282638           1512132229168   \n",
       "19879                       ala212772987282638           1512201855295   \n",
       "19880  1214332264051822635   bp212772726055715           1512130238207   \n",
       "19881  1214332208216699081   bp212772711899925           1512130124624   \n",
       "19882                       ala212772631552850           1512129513970   \n",
       "\n",
       "                    payId payPrice transactionType  \n",
       "0      ala212797681122096     4985              交易  \n",
       "1       bp212808489720815     3488              交易  \n",
       "2       bp212808484215690     2550              交易  \n",
       "3       bp212808483560429     2400              交易  \n",
       "4       bp212808479759238     2200              交易  \n",
       "5       bp212808479497092     5920              交易  \n",
       "6       bp212808473074667     1700              交易  \n",
       "7      ala212808445025247     4990              交易  \n",
       "8       bp212808443976667     5450              交易  \n",
       "9       bp212808437029749     1590              交易  \n",
       "10      bp212808411470701     2800              交易  \n",
       "11      bp212808407538640     3200              交易  \n",
       "12      bp212808402295756     8320              交易  \n",
       "13     ala212808393251687     9970              交易  \n",
       "14     ala212808385125219     9970              交易  \n",
       "15      bp212808374901701     3692              交易  \n",
       "16      bp212808373459907     2100              交易  \n",
       "17      bp212808354061151     5200              交易  \n",
       "18      bp212808345017270     2690              交易  \n",
       "19      bp212808346196919     3830              交易  \n",
       "20      bp212808330992472     1244              交易  \n",
       "21      bp212808327584680     2000              交易  \n",
       "22      bp212808324569942     2610              交易  \n",
       "23      bp212808311200591     3600              交易  \n",
       "24      bp212808294161226     2800              交易  \n",
       "25      bp212808290360226     3780              交易  \n",
       "26      bp212808288394054     1900              交易  \n",
       "27      bp212808290360227     1350              交易  \n",
       "28     ala212808280529732     9970              交易  \n",
       "29      bp212808276990784     2380              交易  \n",
       "...                   ...      ...             ...  \n",
       "19853  ala212778383780667     2468              交易  \n",
       "19854   bp212778182978293     1750              交易  \n",
       "19855   bp212777679661701     2100              交易  \n",
       "19856   bp212777250663196     3902              交易  \n",
       "19857  ala212776468687367    12020              交易  \n",
       "19858   bp212775063464237     2199              交易  \n",
       "19859   bp212774860433661     3900              交易  \n",
       "19860   bp212774797781421     3200              交易  \n",
       "19861   bp212774549137733     2300              交易  \n",
       "19862   bp212774529345855     3600              交易  \n",
       "19863   bp212774390278207     2300              交易  \n",
       "19864   bp212774262483083     4000              交易  \n",
       "19865   bp212773905442721     1600              交易  \n",
       "19866   bp212773818017528     1700              交易  \n",
       "19867   bp212773773715236     2133              交易  \n",
       "19868   bp212773568456250     3600              交易  \n",
       "19869   bp212773557970486     2800              交易  \n",
       "19870   bp212773540931205     2700              交易  \n",
       "19871   bp212773514847751     3400              交易  \n",
       "19872   bp212773510522481     2780              交易  \n",
       "19873   bp212773391246878     2508              交易  \n",
       "19874   bp212773267907866     1700              交易  \n",
       "19875   bp212773209973980     1900              交易  \n",
       "19876   bp212773178123612     4400              交易  \n",
       "19877   bp212773000389676     3300              交易  \n",
       "19878  ala212772987282638     4600              交易  \n",
       "19879  ala222772989248720     4600              退款  \n",
       "19880   bp212772726055715     3900              交易  \n",
       "19881   bp212772711899925    11039              交易  \n",
       "19882  ala212772631552850     1200              交易  \n",
       "\n",
       "[19883 rows x 17 columns]"
      ]
     },
     "execution_count": 103,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 数据清理\n",
    "pd_data.paidTime = pd_data.paidTime.map(lambda x: pd.to_datetime(\n",
    "    x, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "pd_data.payChannel = pd_data.payChannel.map(lambda x: x.split(','))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "pd_data.payPrice = pd_data.payPrice.map(lambda x: float(x)/100 if x else 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [],
   "source": [
    "pay_rate_map = {\n",
    "    'alipay': 0.0055,\n",
    "    'abchina': 0.005,\n",
    "    'wx': 0.006,\n",
    "    'ccb': 0.004,\n",
    "    'baofu': 0.005,\n",
    "    '1qianbao': 0.0004,\n",
    "    'wx_wap': 0.006,\n",
    "    'alipay_wap': 0.0055,\n",
    "    'alipay_qr': 0.0055,\n",
    "    'wx_pub_qr': 0.006,\n",
    "    'bestpay': 0.005,\n",
    "}\n",
    "pd_data['pay_rate']=pd_data.payChannel.map(lambda x: sum([pay_rate_map.get(channel, 0) for channel in item.payChannel]))\n",
    "pd_data['payRate'] = pd_data.payPrice*pd_data.pay_rate\n",
    "pd_data['payRate'] = pd_data.payRate.map(lambda x:round(x, 2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "      <th>chargeId</th>\n",
       "      <th>paidTime</th>\n",
       "      <th>payId</th>\n",
       "      <th>payPrice</th>\n",
       "      <th>transactionType</th>\n",
       "      <th>pay_rate</th>\n",
       "      <th>payRate</th>\n",
       "      <th>deductionPrice</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202797681122095</td>\n",
       "      <td>huafei</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 01:03:33</td>\n",
       "      <td>49.85</td>\n",
       "      <td>[ala212797681122096]</td>\n",
       "      <td>S1712042122650</td>\n",
       "      <td>ala212797681122096</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 01:04:09</td>\n",
       "      <td>ala212797681122096</td>\n",
       "      <td>49.85</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808489589742</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:34:14</td>\n",
       "      <td>2017-12-04 23:57:55</td>\n",
       "      <td>34.88</td>\n",
       "      <td>[bp212808489720815]</td>\n",
       "      <td>3016206612566745101</td>\n",
       "      <td>bp212808489720815</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:58:22</td>\n",
       "      <td>bp212808489720815</td>\n",
       "      <td>34.88</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808484084617</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:57:41</td>\n",
       "      <td>2017-12-04 23:57:13</td>\n",
       "      <td>25.50</td>\n",
       "      <td>[bp212808484215690]</td>\n",
       "      <td>3016206651950494732</td>\n",
       "      <td>bp212808484215690</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:57:25</td>\n",
       "      <td>bp212808484215690</td>\n",
       "      <td>25.50</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808483560428</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:57:23</td>\n",
       "      <td>2017-12-04 23:57:09</td>\n",
       "      <td>24.00</td>\n",
       "      <td>[bp212808483560429]</td>\n",
       "      <td>1214460321303985191</td>\n",
       "      <td>bp212808483560429</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:57:18</td>\n",
       "      <td>bp212808483560429</td>\n",
       "      <td>24.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808479628165</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:57:05</td>\n",
       "      <td>2017-12-04 23:56:40</td>\n",
       "      <td>22.00</td>\n",
       "      <td>[bp212808479759238]</td>\n",
       "      <td>1214460281299286189</td>\n",
       "      <td>bp212808479759238</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:56:57</td>\n",
       "      <td>bp212808479759238</td>\n",
       "      <td>22.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808479497091</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:57:01</td>\n",
       "      <td>2017-12-04 23:56:38</td>\n",
       "      <td>59.20</td>\n",
       "      <td>[bp212808479497092]</td>\n",
       "      <td>3016206681989089457</td>\n",
       "      <td>bp212808479497092</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:56:58</td>\n",
       "      <td>bp212808479497092</td>\n",
       "      <td>59.20</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808473074666</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:28:31</td>\n",
       "      <td>2017-12-04 23:55:49</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212808473074667]</td>\n",
       "      <td>3016206585705608301</td>\n",
       "      <td>bp212808473074667</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:56:03</td>\n",
       "      <td>bp212808473074667</td>\n",
       "      <td>17.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808445025246</td>\n",
       "      <td>huafei</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:53:36</td>\n",
       "      <td>2017-12-04 23:52:15</td>\n",
       "      <td>49.90</td>\n",
       "      <td>[ala212808445025247]</td>\n",
       "      <td>S1712043737419</td>\n",
       "      <td>ala212808445025247</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:52:35</td>\n",
       "      <td>ala212808445025247</td>\n",
       "      <td>49.90</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808443845594</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:12:21</td>\n",
       "      <td>2017-12-04 23:52:06</td>\n",
       "      <td>54.50</td>\n",
       "      <td>[bp212808443976667]</td>\n",
       "      <td>3016206541993077799</td>\n",
       "      <td>bp212808443976667</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:52:22</td>\n",
       "      <td>bp212808443976667</td>\n",
       "      <td>54.50</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808437029748</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:51:33</td>\n",
       "      <td>2017-12-04 23:51:15</td>\n",
       "      <td>15.90</td>\n",
       "      <td>[bp212808437029749]</td>\n",
       "      <td>3016206573484116101</td>\n",
       "      <td>bp212808437029749</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:51:29</td>\n",
       "      <td>bp212808437029749</td>\n",
       "      <td>15.90</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808411339628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:48:53</td>\n",
       "      <td>2017-12-04 23:47:59</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212808411470701]</td>\n",
       "      <td>3016206499143901324</td>\n",
       "      <td>bp212808411470701</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:48:38</td>\n",
       "      <td>bp212808411470701</td>\n",
       "      <td>28.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808407407467</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:18:04</td>\n",
       "      <td>2017-12-04 23:47:29</td>\n",
       "      <td>32.00</td>\n",
       "      <td>[bp212808407538640]</td>\n",
       "      <td>3016206497650923566</td>\n",
       "      <td>bp212808407538640</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:47:39</td>\n",
       "      <td>bp212808407538640</td>\n",
       "      <td>32.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808402164586</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:14:41</td>\n",
       "      <td>2017-12-04 23:46:49</td>\n",
       "      <td>83.20</td>\n",
       "      <td>[bp212808402295756]</td>\n",
       "      <td>3016206495679641735</td>\n",
       "      <td>bp212808402295756</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:46:59</td>\n",
       "      <td>bp212808402295756</td>\n",
       "      <td>83.20</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808393251784</td>\n",
       "      <td>huafei</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:46:23</td>\n",
       "      <td>2017-12-04 23:45:40</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808393251687]</td>\n",
       "      <td>S1712043733819</td>\n",
       "      <td>ala212808393251687</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:45:53</td>\n",
       "      <td>ala212808393251687</td>\n",
       "      <td>99.70</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808385125218</td>\n",
       "      <td>huafei</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:45:38</td>\n",
       "      <td>2017-12-04 23:44:38</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808385125219]</td>\n",
       "      <td>S1712043733546</td>\n",
       "      <td>ala212808385125219</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:45:07</td>\n",
       "      <td>ala212808385125219</td>\n",
       "      <td>99.70</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808374770628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:04:54</td>\n",
       "      <td>2017-12-04 23:43:20</td>\n",
       "      <td>36.92</td>\n",
       "      <td>[bp212808374901701]</td>\n",
       "      <td>3016206421239033043</td>\n",
       "      <td>bp212808374901701</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:43:33</td>\n",
       "      <td>bp212808374901701</td>\n",
       "      <td>36.92</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808373459906</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:07:09</td>\n",
       "      <td>2017-12-04 23:43:09</td>\n",
       "      <td>21.00</td>\n",
       "      <td>[bp212808373459907]</td>\n",
       "      <td>3016206484883682496</td>\n",
       "      <td>bp212808373459907</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:43:20</td>\n",
       "      <td>bp212808373459907</td>\n",
       "      <td>21.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808354061150</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:00:08</td>\n",
       "      <td>2017-12-04 23:40:41</td>\n",
       "      <td>52.00</td>\n",
       "      <td>[bp212808354061151]</td>\n",
       "      <td>1214460178354088045</td>\n",
       "      <td>bp212808354061151</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:40:48</td>\n",
       "      <td>bp212808354061151</td>\n",
       "      <td>52.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808344886105</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:14:16</td>\n",
       "      <td>2017-12-04 23:39:32</td>\n",
       "      <td>26.90</td>\n",
       "      <td>[bp212808345017270]</td>\n",
       "      <td>3016206373625427094</td>\n",
       "      <td>bp212808345017270</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:39:44</td>\n",
       "      <td>bp212808345017270</td>\n",
       "      <td>26.90</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808335186861</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:20:06</td>\n",
       "      <td>2017-12-04 23:38:17</td>\n",
       "      <td>38.30</td>\n",
       "      <td>[bp212808346196919]</td>\n",
       "      <td>1214460172951901228</td>\n",
       "      <td>bp212808346196919</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:39:50</td>\n",
       "      <td>bp212808346196919</td>\n",
       "      <td>38.30</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808330992471</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:38:03</td>\n",
       "      <td>2017-12-04 23:37:45</td>\n",
       "      <td>12.44</td>\n",
       "      <td>[bp212808330992472]</td>\n",
       "      <td>3016206366981752988</td>\n",
       "      <td>bp212808330992472</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:37:59</td>\n",
       "      <td>bp212808330992472</td>\n",
       "      <td>12.44</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808327453607</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:56:34</td>\n",
       "      <td>2017-12-04 23:37:19</td>\n",
       "      <td>20.00</td>\n",
       "      <td>[bp212808327584680]</td>\n",
       "      <td>3016206341161373771</td>\n",
       "      <td>bp212808327584680</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:37:35</td>\n",
       "      <td>bp212808327584680</td>\n",
       "      <td>20.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808324438869</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:11:24</td>\n",
       "      <td>2017-12-04 23:36:56</td>\n",
       "      <td>26.10</td>\n",
       "      <td>[bp212808324569942]</td>\n",
       "      <td>3016206399840121901</td>\n",
       "      <td>bp212808324569942</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:37:07</td>\n",
       "      <td>bp212808324569942</td>\n",
       "      <td>26.10</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808310938534</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:35:38</td>\n",
       "      <td>2017-12-04 23:35:13</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212808311200591]</td>\n",
       "      <td>1214460149807396985</td>\n",
       "      <td>bp212808311200591</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:35:25</td>\n",
       "      <td>bp212808311200591</td>\n",
       "      <td>36.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808294030153</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:59:25</td>\n",
       "      <td>2017-12-04 23:33:04</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212808294161226]</td>\n",
       "      <td>3016206350967467142</td>\n",
       "      <td>bp212808294161226</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:33:15</td>\n",
       "      <td>bp212808294161226</td>\n",
       "      <td>28.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808290229153</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:35:38</td>\n",
       "      <td>2017-12-04 23:32:34</td>\n",
       "      <td>37.80</td>\n",
       "      <td>[bp212808290360226]</td>\n",
       "      <td>1214460101548234803</td>\n",
       "      <td>bp212808290360226</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:34:37</td>\n",
       "      <td>bp212808290360226</td>\n",
       "      <td>37.80</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808288262981</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:33:25</td>\n",
       "      <td>2017-12-04 23:32:20</td>\n",
       "      <td>19.00</td>\n",
       "      <td>[bp212808288394054]</td>\n",
       "      <td>3016206258986994885</td>\n",
       "      <td>bp212808288394054</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:33:20</td>\n",
       "      <td>bp212808288394054</td>\n",
       "      <td>19.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808282758043</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 00:02:03</td>\n",
       "      <td>2017-12-04 23:31:37</td>\n",
       "      <td>13.50</td>\n",
       "      <td>[bp212808290360227]</td>\n",
       "      <td>3016206320775468236</td>\n",
       "      <td>bp212808290360227</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:32:43</td>\n",
       "      <td>bp212808290360227</td>\n",
       "      <td>13.50</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202808280529731</td>\n",
       "      <td>huafei</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-04 23:40:52</td>\n",
       "      <td>2017-12-04 23:31:20</td>\n",
       "      <td>99.70</td>\n",
       "      <td>[ala212808280529732]</td>\n",
       "      <td>S1712043728370</td>\n",
       "      <td>ala212808280529732</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:31:32</td>\n",
       "      <td>ala212808280529732</td>\n",
       "      <td>99.70</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202808276859711</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-12-05 02:31:09</td>\n",
       "      <td>2017-12-04 23:30:53</td>\n",
       "      <td>23.80</td>\n",
       "      <td>[bp212808276990784]</td>\n",
       "      <td>1214460029439505633</td>\n",
       "      <td>bp212808276990784</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-04 23:31:06</td>\n",
       "      <td>bp212808276990784</td>\n",
       "      <td>23.80</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19853</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ele</td>\n",
       "      <td>ala202778383780864</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 08:09:46</td>\n",
       "      <td>24.68</td>\n",
       "      <td>[ala212778383780667]</td>\n",
       "      <td>3016070197384086606</td>\n",
       "      <td>ala212778383780667</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 08:10:07</td>\n",
       "      <td>ala212778383780667</td>\n",
       "      <td>24.68</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19854</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202778182847429</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 07:44:14</td>\n",
       "      <td>17.50</td>\n",
       "      <td>[bp212778182978293]</td>\n",
       "      <td>3016070035467008215</td>\n",
       "      <td>bp212778182978293</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 07:44:29</td>\n",
       "      <td>bp212778182978293</td>\n",
       "      <td>17.50</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19855</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202777679530628</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 06:40:14</td>\n",
       "      <td>21.00</td>\n",
       "      <td>[bp212777679661701]</td>\n",
       "      <td>1214337864136397050</td>\n",
       "      <td>bp212777679661701</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 06:40:29</td>\n",
       "      <td>bp212777679661701</td>\n",
       "      <td>21.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19856</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202777244109389</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 05:44:51</td>\n",
       "      <td>39.02</td>\n",
       "      <td>[bp212777250663196]</td>\n",
       "      <td>3016069705626406998</td>\n",
       "      <td>bp212777250663196</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 05:45:50</td>\n",
       "      <td>bp212777250663196</td>\n",
       "      <td>39.02</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19857</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ele</td>\n",
       "      <td>ala202776468556294</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 04:06:15</td>\n",
       "      <td>120.20</td>\n",
       "      <td>[ala212776468687367]</td>\n",
       "      <td>1214337749512361151</td>\n",
       "      <td>ala212776468687367</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 04:06:28</td>\n",
       "      <td>ala212776468687367</td>\n",
       "      <td>120.20</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19858</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202775063464236</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 01:07:34</td>\n",
       "      <td>21.99</td>\n",
       "      <td>[bp212775063464237]</td>\n",
       "      <td>3016069031065367692</td>\n",
       "      <td>bp212775063464237</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 01:07:42</td>\n",
       "      <td>bp212775063464237</td>\n",
       "      <td>21.99</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19859</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774860433660</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 00:41:45</td>\n",
       "      <td>39.00</td>\n",
       "      <td>[bp212774860433661]</td>\n",
       "      <td>3016068842011410569</td>\n",
       "      <td>bp212774860433661</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 00:42:08</td>\n",
       "      <td>bp212774860433661</td>\n",
       "      <td>39.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19860</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774797650348</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td>2017-12-02 03:34:03</td>\n",
       "      <td>2017-12-02 00:33:46</td>\n",
       "      <td>32.00</td>\n",
       "      <td>[bp212774797781421]</td>\n",
       "      <td>1214337062778723464</td>\n",
       "      <td>bp212774797781421</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 00:34:00</td>\n",
       "      <td>bp212774797781421</td>\n",
       "      <td>32.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19861</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774549006660</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 00:02:10</td>\n",
       "      <td>23.00</td>\n",
       "      <td>[bp212774549137733]</td>\n",
       "      <td>3016068412372062360</td>\n",
       "      <td>bp212774549137733</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 00:02:27</td>\n",
       "      <td>bp212774549137733</td>\n",
       "      <td>23.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19862</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774529214782</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:59:39</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212774529345855]</td>\n",
       "      <td>1214336906280852723</td>\n",
       "      <td>bp212774529345855</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:59:54</td>\n",
       "      <td>bp212774529345855</td>\n",
       "      <td>36.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19863</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774388705512</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:41:47</td>\n",
       "      <td>23.00</td>\n",
       "      <td>[bp212774390278207]</td>\n",
       "      <td>3016068091809707013</td>\n",
       "      <td>bp212774390278207</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:42:07</td>\n",
       "      <td>bp212774390278207</td>\n",
       "      <td>23.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19864</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202774262352010</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:25:43</td>\n",
       "      <td>40.00</td>\n",
       "      <td>[bp212774262483083]</td>\n",
       "      <td>1214336536150301843</td>\n",
       "      <td>bp212774262483083</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 23:25:57</td>\n",
       "      <td>bp212774262483083</td>\n",
       "      <td>40.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19865</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773905311648</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:40:19</td>\n",
       "      <td>16.00</td>\n",
       "      <td>[bp212773905442721]</td>\n",
       "      <td>1214335902886270096</td>\n",
       "      <td>bp212773905442721</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:40:29</td>\n",
       "      <td>bp212773905442721</td>\n",
       "      <td>16.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19866</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773817886454</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:29:11</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212773818017528]</td>\n",
       "      <td>1214335767546608836</td>\n",
       "      <td>bp212773818017528</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:29:39</td>\n",
       "      <td>bp212773818017528</td>\n",
       "      <td>17.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19867</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773773584163</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:23:34</td>\n",
       "      <td>21.33</td>\n",
       "      <td>[bp212773773715236]</td>\n",
       "      <td>3016066530530123980</td>\n",
       "      <td>bp212773773715236</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 22:23:41</td>\n",
       "      <td>bp212773773715236</td>\n",
       "      <td>21.33</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19868</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773568325289</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:57:28</td>\n",
       "      <td>36.00</td>\n",
       "      <td>[bp212773568456250]</td>\n",
       "      <td>1214335145724171352</td>\n",
       "      <td>bp212773568456250</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:57:41</td>\n",
       "      <td>bp212773568456250</td>\n",
       "      <td>36.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19869</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773557970485</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:56:08</td>\n",
       "      <td>28.00</td>\n",
       "      <td>[bp212773557970486]</td>\n",
       "      <td>3016065848192633901</td>\n",
       "      <td>bp212773557970486</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:56:18</td>\n",
       "      <td>bp212773557970486</td>\n",
       "      <td>28.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19870</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773538047615</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:53:36</td>\n",
       "      <td>27.00</td>\n",
       "      <td>[bp212773540931205]</td>\n",
       "      <td>1214335066114325541</td>\n",
       "      <td>bp212773540931205</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:54:13</td>\n",
       "      <td>bp212773540931205</td>\n",
       "      <td>27.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19871</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773514716678</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:50:39</td>\n",
       "      <td>34.00</td>\n",
       "      <td>[bp212773514847751]</td>\n",
       "      <td>1214335051788538959</td>\n",
       "      <td>bp212773514847751</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:51:09</td>\n",
       "      <td>bp212773514847751</td>\n",
       "      <td>34.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19872</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773510260336</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:50:06</td>\n",
       "      <td>27.80</td>\n",
       "      <td>[bp212773510522481]</td>\n",
       "      <td>1214334958665497764</td>\n",
       "      <td>bp212773510522481</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:50:20</td>\n",
       "      <td>bp212773510522481</td>\n",
       "      <td>27.80</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19873</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773391246740</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:34:56</td>\n",
       "      <td>25.08</td>\n",
       "      <td>[bp212773391246878]</td>\n",
       "      <td>3016065190768856085</td>\n",
       "      <td>bp212773391246878</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:35:11</td>\n",
       "      <td>bp212773391246878</td>\n",
       "      <td>25.08</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19874</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773267776793</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:19:14</td>\n",
       "      <td>17.00</td>\n",
       "      <td>[bp212773267907866]</td>\n",
       "      <td>3016064713918544056</td>\n",
       "      <td>bp212773267907866</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:19:34</td>\n",
       "      <td>bp212773267907866</td>\n",
       "      <td>17.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19875</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773209842907</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:11:53</td>\n",
       "      <td>19.00</td>\n",
       "      <td>[bp212773209973980]</td>\n",
       "      <td>1214334173930426436</td>\n",
       "      <td>bp212773209973980</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:12:10</td>\n",
       "      <td>bp212773209973980</td>\n",
       "      <td>19.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19876</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773177992539</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:07:49</td>\n",
       "      <td>44.00</td>\n",
       "      <td>[bp212773178123612]</td>\n",
       "      <td>1214333959238484040</td>\n",
       "      <td>bp212773178123612</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 21:07:57</td>\n",
       "      <td>bp212773178123612</td>\n",
       "      <td>44.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19877</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202773000389675</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:45:14</td>\n",
       "      <td>33.00</td>\n",
       "      <td>[bp212773000389676]</td>\n",
       "      <td>1214333400959896665</td>\n",
       "      <td>bp212773000389676</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:45:31</td>\n",
       "      <td>bp212773000389676</td>\n",
       "      <td>33.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19878</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772987282637</td>\n",
       "      <td>coffee</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:43:34</td>\n",
       "      <td>46.00</td>\n",
       "      <td>[ala212772987282638]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:43:49</td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td>46.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19879</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772987282637</td>\n",
       "      <td>coffee</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:43:34</td>\n",
       "      <td>-46.00</td>\n",
       "      <td>[ala212772987282638]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772987282638</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-02 16:04:15</td>\n",
       "      <td>ala222772989248720</td>\n",
       "      <td>46.00</td>\n",
       "      <td>退款</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-92.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19880</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202772725924788</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:10:20</td>\n",
       "      <td>39.00</td>\n",
       "      <td>[bp212772726055715]</td>\n",
       "      <td>1214332264051822635</td>\n",
       "      <td>bp212772726055715</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:10:38</td>\n",
       "      <td>bp212772726055715</td>\n",
       "      <td>39.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19881</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202772711768852</td>\n",
       "      <td>waimai</td>\n",
       "      <td>[bestpay]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:08:33</td>\n",
       "      <td>110.39</td>\n",
       "      <td>[bp212772711899925]</td>\n",
       "      <td>1214332208216699081</td>\n",
       "      <td>bp212772711899925</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 20:08:44</td>\n",
       "      <td>bp212772711899925</td>\n",
       "      <td>110.39</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19882</th>\n",
       "      <td>91ala</td>\n",
       "      <td>linqu</td>\n",
       "      <td>ala202772631552849</td>\n",
       "      <td>paotui</td>\n",
       "      <td>[fanbei]</td>\n",
       "      <td>7</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 19:58:20</td>\n",
       "      <td>12.00</td>\n",
       "      <td>[ala212772631552850]</td>\n",
       "      <td></td>\n",
       "      <td>ala212772631552850</td>\n",
       "      <td></td>\n",
       "      <td>2017-12-01 19:58:33</td>\n",
       "      <td>ala212772631552850</td>\n",
       "      <td>12.00</td>\n",
       "      <td>交易</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19883 rows × 20 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       appCode channel                  id orderType payChannel  status  \\\n",
       "0        91ala   ofpay  ala202797681122095    huafei   [fanbei]       0   \n",
       "1      bestpay     ele   bp202808489589742    waimai  [bestpay]       4   \n",
       "2      bestpay     ele   bp202808484084617    waimai  [bestpay]       4   \n",
       "3      bestpay     ele   bp202808483560428    waimai  [bestpay]       4   \n",
       "4      bestpay     ele   bp202808479628165    waimai  [bestpay]       4   \n",
       "5      bestpay     ele   bp202808479497091    waimai  [bestpay]       4   \n",
       "6      bestpay     ele   bp202808473074666    waimai  [bestpay]       4   \n",
       "7        91ala   ofpay  ala202808445025246    huafei   [fanbei]       4   \n",
       "8      bestpay     ele   bp202808443845594    waimai  [bestpay]       4   \n",
       "9      bestpay     ele   bp202808437029748    waimai  [bestpay]       4   \n",
       "10     bestpay     ele   bp202808411339628    waimai  [bestpay]       4   \n",
       "11     bestpay     ele   bp202808407407467    waimai  [bestpay]       4   \n",
       "12     bestpay     ele   bp202808402164586    waimai  [bestpay]       4   \n",
       "13       91ala   ofpay  ala202808393251784    huafei   [fanbei]       4   \n",
       "14       91ala   ofpay  ala202808385125218    huafei   [fanbei]       4   \n",
       "15     bestpay     ele   bp202808374770628    waimai  [bestpay]       4   \n",
       "16     bestpay     ele   bp202808373459906    waimai  [bestpay]       4   \n",
       "17     bestpay     ele   bp202808354061150    waimai  [bestpay]       4   \n",
       "18     bestpay     ele   bp202808344886105    waimai  [bestpay]       4   \n",
       "19     bestpay     ele   bp202808335186861    waimai  [bestpay]       4   \n",
       "20     bestpay     ele   bp202808330992471    waimai  [bestpay]       4   \n",
       "21     bestpay     ele   bp202808327453607    waimai  [bestpay]       4   \n",
       "22     bestpay     ele   bp202808324438869    waimai  [bestpay]       4   \n",
       "23     bestpay     ele   bp202808310938534    waimai  [bestpay]       4   \n",
       "24     bestpay     ele   bp202808294030153    waimai  [bestpay]       4   \n",
       "25     bestpay     ele   bp202808290229153    waimai  [bestpay]       4   \n",
       "26     bestpay     ele   bp202808288262981    waimai  [bestpay]       4   \n",
       "27     bestpay     ele   bp202808282758043    waimai  [bestpay]       4   \n",
       "28       91ala   ofpay  ala202808280529731    huafei   [fanbei]       4   \n",
       "29     bestpay     ele   bp202808276859711    waimai  [bestpay]       4   \n",
       "...        ...     ...                 ...       ...        ...     ...   \n",
       "19853    91ala     ele  ala202778383780864    waimai   [fanbei]       7   \n",
       "19854  bestpay     ele   bp202778182847429    waimai  [bestpay]       7   \n",
       "19855  bestpay     ele   bp202777679530628    waimai  [bestpay]       7   \n",
       "19856  bestpay     ele   bp202777244109389    waimai  [bestpay]       7   \n",
       "19857    91ala     ele  ala202776468556294    waimai   [fanbei]       7   \n",
       "19858  bestpay     ele   bp202775063464236    waimai  [bestpay]       7   \n",
       "19859  bestpay     ele   bp202774860433660    waimai  [bestpay]       7   \n",
       "19860  bestpay     ele   bp202774797650348    waimai  [bestpay]       7   \n",
       "19861  bestpay     ele   bp202774549006660    waimai  [bestpay]       7   \n",
       "19862  bestpay     ele   bp202774529214782    waimai  [bestpay]       7   \n",
       "19863  bestpay     ele   bp202774388705512    waimai  [bestpay]       7   \n",
       "19864  bestpay     ele   bp202774262352010    waimai  [bestpay]       7   \n",
       "19865  bestpay     ele   bp202773905311648    waimai  [bestpay]       7   \n",
       "19866  bestpay     ele   bp202773817886454    waimai  [bestpay]       7   \n",
       "19867  bestpay     ele   bp202773773584163    waimai  [bestpay]       7   \n",
       "19868  bestpay     ele   bp202773568325289    waimai  [bestpay]       7   \n",
       "19869  bestpay     ele   bp202773557970485    waimai  [bestpay]       7   \n",
       "19870  bestpay     ele   bp202773538047615    waimai  [bestpay]       7   \n",
       "19871  bestpay     ele   bp202773514716678    waimai  [bestpay]       7   \n",
       "19872  bestpay     ele   bp202773510260336    waimai  [bestpay]       7   \n",
       "19873  bestpay     ele   bp202773391246740    waimai  [bestpay]       7   \n",
       "19874  bestpay     ele   bp202773267776793    waimai  [bestpay]       7   \n",
       "19875  bestpay     ele   bp202773209842907    waimai  [bestpay]       7   \n",
       "19876  bestpay     ele   bp202773177992539    waimai  [bestpay]       7   \n",
       "19877  bestpay     ele   bp202773000389675    waimai  [bestpay]       7   \n",
       "19878    91ala   linqu  ala202772987282637    coffee   [fanbei]       7   \n",
       "19879    91ala   linqu  ala202772987282637    coffee   [fanbei]       7   \n",
       "19880  bestpay     ele   bp202772725924788    waimai  [bestpay]       7   \n",
       "19881  bestpay     ele   bp202772711768852    waimai  [bestpay]       7   \n",
       "19882    91ala   linqu  ala202772631552849    paotui   [fanbei]       7   \n",
       "\n",
       "               completedAt            createdAt  orderPrice  \\\n",
       "0                           2017-12-04 01:03:33       49.85   \n",
       "1      2017-12-05 00:34:14  2017-12-04 23:57:55       34.88   \n",
       "2      2017-12-05 02:57:41  2017-12-04 23:57:13       25.50   \n",
       "3      2017-12-05 02:57:23  2017-12-04 23:57:09       24.00   \n",
       "4      2017-12-05 02:57:05  2017-12-04 23:56:40       22.00   \n",
       "5      2017-12-05 02:57:01  2017-12-04 23:56:38       59.20   \n",
       "6      2017-12-05 00:28:31  2017-12-04 23:55:49       17.00   \n",
       "7      2017-12-04 23:53:36  2017-12-04 23:52:15       49.90   \n",
       "8      2017-12-05 00:12:21  2017-12-04 23:52:06       54.50   \n",
       "9      2017-12-05 02:51:33  2017-12-04 23:51:15       15.90   \n",
       "10     2017-12-05 02:48:53  2017-12-04 23:47:59       28.00   \n",
       "11     2017-12-05 00:18:04  2017-12-04 23:47:29       32.00   \n",
       "12     2017-12-05 00:14:41  2017-12-04 23:46:49       83.20   \n",
       "13     2017-12-04 23:46:23  2017-12-04 23:45:40       99.70   \n",
       "14     2017-12-04 23:45:38  2017-12-04 23:44:38       99.70   \n",
       "15     2017-12-05 00:04:54  2017-12-04 23:43:20       36.92   \n",
       "16     2017-12-05 00:07:09  2017-12-04 23:43:09       21.00   \n",
       "17     2017-12-05 00:00:08  2017-12-04 23:40:41       52.00   \n",
       "18     2017-12-05 00:14:16  2017-12-04 23:39:32       26.90   \n",
       "19     2017-12-05 00:20:06  2017-12-04 23:38:17       38.30   \n",
       "20     2017-12-05 02:38:03  2017-12-04 23:37:45       12.44   \n",
       "21     2017-12-04 23:56:34  2017-12-04 23:37:19       20.00   \n",
       "22     2017-12-05 00:11:24  2017-12-04 23:36:56       26.10   \n",
       "23     2017-12-05 02:35:38  2017-12-04 23:35:13       36.00   \n",
       "24     2017-12-04 23:59:25  2017-12-04 23:33:04       28.00   \n",
       "25     2017-12-05 02:35:38  2017-12-04 23:32:34       37.80   \n",
       "26     2017-12-05 02:33:25  2017-12-04 23:32:20       19.00   \n",
       "27     2017-12-05 00:02:03  2017-12-04 23:31:37       13.50   \n",
       "28     2017-12-04 23:40:52  2017-12-04 23:31:20       99.70   \n",
       "29     2017-12-05 02:31:09  2017-12-04 23:30:53       23.80   \n",
       "...                    ...                  ...         ...   \n",
       "19853                       2017-12-02 08:09:46       24.68   \n",
       "19854                       2017-12-02 07:44:14       17.50   \n",
       "19855                       2017-12-02 06:40:14       21.00   \n",
       "19856                       2017-12-02 05:44:51       39.02   \n",
       "19857                       2017-12-02 04:06:15      120.20   \n",
       "19858                       2017-12-02 01:07:34       21.99   \n",
       "19859                       2017-12-02 00:41:45       39.00   \n",
       "19860  2017-12-02 03:34:03  2017-12-02 00:33:46       32.00   \n",
       "19861                       2017-12-02 00:02:10       23.00   \n",
       "19862                       2017-12-01 23:59:39       36.00   \n",
       "19863                       2017-12-01 23:41:47       23.00   \n",
       "19864                       2017-12-01 23:25:43       40.00   \n",
       "19865                       2017-12-01 22:40:19       16.00   \n",
       "19866                       2017-12-01 22:29:11       17.00   \n",
       "19867                       2017-12-01 22:23:34       21.33   \n",
       "19868                       2017-12-01 21:57:28       36.00   \n",
       "19869                       2017-12-01 21:56:08       28.00   \n",
       "19870                       2017-12-01 21:53:36       27.00   \n",
       "19871                       2017-12-01 21:50:39       34.00   \n",
       "19872                       2017-12-01 21:50:06       27.80   \n",
       "19873                       2017-12-01 21:34:56       25.08   \n",
       "19874                       2017-12-01 21:19:14       17.00   \n",
       "19875                       2017-12-01 21:11:53       19.00   \n",
       "19876                       2017-12-01 21:07:49       44.00   \n",
       "19877                       2017-12-01 20:45:14       33.00   \n",
       "19878                       2017-12-01 20:43:34       46.00   \n",
       "19879                       2017-12-01 20:43:34      -46.00   \n",
       "19880                       2017-12-01 20:10:20       39.00   \n",
       "19881                       2017-12-01 20:08:33      110.39   \n",
       "19882                       2017-12-01 19:58:20       12.00   \n",
       "\n",
       "                   paidList            partnerId       paymentSerial chargeId  \\\n",
       "0      [ala212797681122096]       S1712042122650  ala212797681122096            \n",
       "1       [bp212808489720815]  3016206612566745101   bp212808489720815            \n",
       "2       [bp212808484215690]  3016206651950494732   bp212808484215690            \n",
       "3       [bp212808483560429]  1214460321303985191   bp212808483560429            \n",
       "4       [bp212808479759238]  1214460281299286189   bp212808479759238            \n",
       "5       [bp212808479497092]  3016206681989089457   bp212808479497092            \n",
       "6       [bp212808473074667]  3016206585705608301   bp212808473074667            \n",
       "7      [ala212808445025247]       S1712043737419  ala212808445025247            \n",
       "8       [bp212808443976667]  3016206541993077799   bp212808443976667            \n",
       "9       [bp212808437029749]  3016206573484116101   bp212808437029749            \n",
       "10      [bp212808411470701]  3016206499143901324   bp212808411470701            \n",
       "11      [bp212808407538640]  3016206497650923566   bp212808407538640            \n",
       "12      [bp212808402295756]  3016206495679641735   bp212808402295756            \n",
       "13     [ala212808393251687]       S1712043733819  ala212808393251687            \n",
       "14     [ala212808385125219]       S1712043733546  ala212808385125219            \n",
       "15      [bp212808374901701]  3016206421239033043   bp212808374901701            \n",
       "16      [bp212808373459907]  3016206484883682496   bp212808373459907            \n",
       "17      [bp212808354061151]  1214460178354088045   bp212808354061151            \n",
       "18      [bp212808345017270]  3016206373625427094   bp212808345017270            \n",
       "19      [bp212808346196919]  1214460172951901228   bp212808346196919            \n",
       "20      [bp212808330992472]  3016206366981752988   bp212808330992472            \n",
       "21      [bp212808327584680]  3016206341161373771   bp212808327584680            \n",
       "22      [bp212808324569942]  3016206399840121901   bp212808324569942            \n",
       "23      [bp212808311200591]  1214460149807396985   bp212808311200591            \n",
       "24      [bp212808294161226]  3016206350967467142   bp212808294161226            \n",
       "25      [bp212808290360226]  1214460101548234803   bp212808290360226            \n",
       "26      [bp212808288394054]  3016206258986994885   bp212808288394054            \n",
       "27      [bp212808290360227]  3016206320775468236   bp212808290360227            \n",
       "28     [ala212808280529732]       S1712043728370  ala212808280529732            \n",
       "29      [bp212808276990784]  1214460029439505633   bp212808276990784            \n",
       "...                     ...                  ...                 ...      ...   \n",
       "19853  [ala212778383780667]  3016070197384086606  ala212778383780667            \n",
       "19854   [bp212778182978293]  3016070035467008215   bp212778182978293            \n",
       "19855   [bp212777679661701]  1214337864136397050   bp212777679661701            \n",
       "19856   [bp212777250663196]  3016069705626406998   bp212777250663196            \n",
       "19857  [ala212776468687367]  1214337749512361151  ala212776468687367            \n",
       "19858   [bp212775063464237]  3016069031065367692   bp212775063464237            \n",
       "19859   [bp212774860433661]  3016068842011410569   bp212774860433661            \n",
       "19860   [bp212774797781421]  1214337062778723464   bp212774797781421            \n",
       "19861   [bp212774549137733]  3016068412372062360   bp212774549137733            \n",
       "19862   [bp212774529345855]  1214336906280852723   bp212774529345855            \n",
       "19863   [bp212774390278207]  3016068091809707013   bp212774390278207            \n",
       "19864   [bp212774262483083]  1214336536150301843   bp212774262483083            \n",
       "19865   [bp212773905442721]  1214335902886270096   bp212773905442721            \n",
       "19866   [bp212773818017528]  1214335767546608836   bp212773818017528            \n",
       "19867   [bp212773773715236]  3016066530530123980   bp212773773715236            \n",
       "19868   [bp212773568456250]  1214335145724171352   bp212773568456250            \n",
       "19869   [bp212773557970486]  3016065848192633901   bp212773557970486            \n",
       "19870   [bp212773540931205]  1214335066114325541   bp212773540931205            \n",
       "19871   [bp212773514847751]  1214335051788538959   bp212773514847751            \n",
       "19872   [bp212773510522481]  1214334958665497764   bp212773510522481            \n",
       "19873   [bp212773391246878]  3016065190768856085   bp212773391246878            \n",
       "19874   [bp212773267907866]  3016064713918544056   bp212773267907866            \n",
       "19875   [bp212773209973980]  1214334173930426436   bp212773209973980            \n",
       "19876   [bp212773178123612]  1214333959238484040   bp212773178123612            \n",
       "19877   [bp212773000389676]  1214333400959896665   bp212773000389676            \n",
       "19878  [ala212772987282638]                       ala212772987282638            \n",
       "19879  [ala212772987282638]                       ala212772987282638            \n",
       "19880   [bp212772726055715]  1214332264051822635   bp212772726055715            \n",
       "19881   [bp212772711899925]  1214332208216699081   bp212772711899925            \n",
       "19882  [ala212772631552850]                       ala212772631552850            \n",
       "\n",
       "                  paidTime               payId  payPrice transactionType  \\\n",
       "0      2017-12-04 01:04:09  ala212797681122096     49.85              交易   \n",
       "1      2017-12-04 23:58:22   bp212808489720815     34.88              交易   \n",
       "2      2017-12-04 23:57:25   bp212808484215690     25.50              交易   \n",
       "3      2017-12-04 23:57:18   bp212808483560429     24.00              交易   \n",
       "4      2017-12-04 23:56:57   bp212808479759238     22.00              交易   \n",
       "5      2017-12-04 23:56:58   bp212808479497092     59.20              交易   \n",
       "6      2017-12-04 23:56:03   bp212808473074667     17.00              交易   \n",
       "7      2017-12-04 23:52:35  ala212808445025247     49.90              交易   \n",
       "8      2017-12-04 23:52:22   bp212808443976667     54.50              交易   \n",
       "9      2017-12-04 23:51:29   bp212808437029749     15.90              交易   \n",
       "10     2017-12-04 23:48:38   bp212808411470701     28.00              交易   \n",
       "11     2017-12-04 23:47:39   bp212808407538640     32.00              交易   \n",
       "12     2017-12-04 23:46:59   bp212808402295756     83.20              交易   \n",
       "13     2017-12-04 23:45:53  ala212808393251687     99.70              交易   \n",
       "14     2017-12-04 23:45:07  ala212808385125219     99.70              交易   \n",
       "15     2017-12-04 23:43:33   bp212808374901701     36.92              交易   \n",
       "16     2017-12-04 23:43:20   bp212808373459907     21.00              交易   \n",
       "17     2017-12-04 23:40:48   bp212808354061151     52.00              交易   \n",
       "18     2017-12-04 23:39:44   bp212808345017270     26.90              交易   \n",
       "19     2017-12-04 23:39:50   bp212808346196919     38.30              交易   \n",
       "20     2017-12-04 23:37:59   bp212808330992472     12.44              交易   \n",
       "21     2017-12-04 23:37:35   bp212808327584680     20.00              交易   \n",
       "22     2017-12-04 23:37:07   bp212808324569942     26.10              交易   \n",
       "23     2017-12-04 23:35:25   bp212808311200591     36.00              交易   \n",
       "24     2017-12-04 23:33:15   bp212808294161226     28.00              交易   \n",
       "25     2017-12-04 23:34:37   bp212808290360226     37.80              交易   \n",
       "26     2017-12-04 23:33:20   bp212808288394054     19.00              交易   \n",
       "27     2017-12-04 23:32:43   bp212808290360227     13.50              交易   \n",
       "28     2017-12-04 23:31:32  ala212808280529732     99.70              交易   \n",
       "29     2017-12-04 23:31:06   bp212808276990784     23.80              交易   \n",
       "...                    ...                 ...       ...             ...   \n",
       "19853  2017-12-02 08:10:07  ala212778383780667     24.68              交易   \n",
       "19854  2017-12-02 07:44:29   bp212778182978293     17.50              交易   \n",
       "19855  2017-12-02 06:40:29   bp212777679661701     21.00              交易   \n",
       "19856  2017-12-02 05:45:50   bp212777250663196     39.02              交易   \n",
       "19857  2017-12-02 04:06:28  ala212776468687367    120.20              交易   \n",
       "19858  2017-12-02 01:07:42   bp212775063464237     21.99              交易   \n",
       "19859  2017-12-02 00:42:08   bp212774860433661     39.00              交易   \n",
       "19860  2017-12-02 00:34:00   bp212774797781421     32.00              交易   \n",
       "19861  2017-12-02 00:02:27   bp212774549137733     23.00              交易   \n",
       "19862  2017-12-01 23:59:54   bp212774529345855     36.00              交易   \n",
       "19863  2017-12-01 23:42:07   bp212774390278207     23.00              交易   \n",
       "19864  2017-12-01 23:25:57   bp212774262483083     40.00              交易   \n",
       "19865  2017-12-01 22:40:29   bp212773905442721     16.00              交易   \n",
       "19866  2017-12-01 22:29:39   bp212773818017528     17.00              交易   \n",
       "19867  2017-12-01 22:23:41   bp212773773715236     21.33              交易   \n",
       "19868  2017-12-01 21:57:41   bp212773568456250     36.00              交易   \n",
       "19869  2017-12-01 21:56:18   bp212773557970486     28.00              交易   \n",
       "19870  2017-12-01 21:54:13   bp212773540931205     27.00              交易   \n",
       "19871  2017-12-01 21:51:09   bp212773514847751     34.00              交易   \n",
       "19872  2017-12-01 21:50:20   bp212773510522481     27.80              交易   \n",
       "19873  2017-12-01 21:35:11   bp212773391246878     25.08              交易   \n",
       "19874  2017-12-01 21:19:34   bp212773267907866     17.00              交易   \n",
       "19875  2017-12-01 21:12:10   bp212773209973980     19.00              交易   \n",
       "19876  2017-12-01 21:07:57   bp212773178123612     44.00              交易   \n",
       "19877  2017-12-01 20:45:31   bp212773000389676     33.00              交易   \n",
       "19878  2017-12-01 20:43:49  ala212772987282638     46.00              交易   \n",
       "19879  2017-12-02 16:04:15  ala222772989248720     46.00              退款   \n",
       "19880  2017-12-01 20:10:38   bp212772726055715     39.00              交易   \n",
       "19881  2017-12-01 20:08:44   bp212772711899925    110.39              交易   \n",
       "19882  2017-12-01 19:58:33  ala212772631552850     12.00              交易   \n",
       "\n",
       "       pay_rate  payRate  deductionPrice  \n",
       "0             0      0.0             0.0  \n",
       "1             0      0.0             0.0  \n",
       "2             0      0.0             0.0  \n",
       "3             0      0.0             0.0  \n",
       "4             0      0.0             0.0  \n",
       "5             0      0.0             0.0  \n",
       "6             0      0.0             0.0  \n",
       "7             0      0.0             0.0  \n",
       "8             0      0.0             0.0  \n",
       "9             0      0.0             0.0  \n",
       "10            0      0.0             0.0  \n",
       "11            0      0.0             0.0  \n",
       "12            0      0.0             0.0  \n",
       "13            0      0.0             0.0  \n",
       "14            0      0.0             0.0  \n",
       "15            0      0.0             0.0  \n",
       "16            0      0.0             0.0  \n",
       "17            0      0.0             0.0  \n",
       "18            0      0.0             0.0  \n",
       "19            0      0.0             0.0  \n",
       "20            0      0.0             0.0  \n",
       "21            0      0.0             0.0  \n",
       "22            0      0.0             0.0  \n",
       "23            0      0.0             0.0  \n",
       "24            0      0.0             0.0  \n",
       "25            0      0.0             0.0  \n",
       "26            0      0.0             0.0  \n",
       "27            0      0.0             0.0  \n",
       "28            0      0.0             0.0  \n",
       "29            0      0.0             0.0  \n",
       "...         ...      ...             ...  \n",
       "19853         0      0.0             0.0  \n",
       "19854         0      0.0             0.0  \n",
       "19855         0      0.0             0.0  \n",
       "19856         0      0.0             0.0  \n",
       "19857         0      0.0             0.0  \n",
       "19858         0      0.0             0.0  \n",
       "19859         0      0.0             0.0  \n",
       "19860         0      0.0             0.0  \n",
       "19861         0      0.0             0.0  \n",
       "19862         0      0.0             0.0  \n",
       "19863         0      0.0             0.0  \n",
       "19864         0      0.0             0.0  \n",
       "19865         0      0.0             0.0  \n",
       "19866         0      0.0             0.0  \n",
       "19867         0      0.0             0.0  \n",
       "19868         0      0.0             0.0  \n",
       "19869         0      0.0             0.0  \n",
       "19870         0      0.0             0.0  \n",
       "19871         0      0.0             0.0  \n",
       "19872         0      0.0             0.0  \n",
       "19873         0      0.0             0.0  \n",
       "19874         0      0.0             0.0  \n",
       "19875         0      0.0             0.0  \n",
       "19876         0      0.0             0.0  \n",
       "19877         0      0.0             0.0  \n",
       "19878         0      0.0             0.0  \n",
       "19879         0      0.0           -92.0  \n",
       "19880         0      0.0             0.0  \n",
       "19881         0      0.0             0.0  \n",
       "19882         0      0.0             0.0  \n",
       "\n",
       "[19883 rows x 20 columns]"
      ]
     },
     "execution_count": 132,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# createdAt\n",
    "pd_data.createdAt = pd_data.createdAt.map(lambda x: pd.to_datetime(\n",
    "    x, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')\n",
    "pd_data.completedAt = pd_data.completedAt.map(lambda x: pd.to_datetime(\n",
    "    x, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')\n",
    "# deductionPrice\n",
    "pd_data.loc[pd_data.transactionType == '退款', 'orderPrice'] = -pd_data.orderPrice\n",
    "pd_data['deductionPrice'] = pd_data.orderPrice - pd_data.payPrice"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd_data.loc[pd_data.transactionType == '退款','sssssfsfd']=-pd_data.orderPrice"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 158,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "'idss' in pd_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 数据值映射\n",
    "pd_data.channel = pd_data.channel.map(lambda x: map_order_channel.get(x, x))\n",
    "map_pay_channel = {item['pay_channel_code']: item['pay_channel_name']\n",
    "                   for item in pg_select(\"SELECT pay_channel_name,pay_channel_code FROM pay_rate;\", pg('account'))}\n",
    "pd_data.payChannel = pd_data.payChannel.map(lambda x: map_pay_channel_function(x, map_pay_channel))\n",
    "app_code_map = {item['app_code']: item['app_name'] for item in pg_select(\"SELECT app_name,app_code FROM application;\", pg('oto_saas'))}\n",
    "pd_data.appCode = pd_data.appCode.map(lambda x: app_code_map.get(x, x))\n",
    "pd_data.columns = [map_key.get(k, k) for k in pd_data.columns]\n",
    "del_columns = set(pd_data.columns) - set(field_headers)\n",
    "pd_data.drop(del_columns, axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd_data.paidList = pd_data.paidList.fillna('')\n",
    "# 获取redis数据\n",
    "pay_data = [{'id': '', 'payId': '', 'paidTime': '', 'price': '', 'payPrice': '', 'paidAt': ''}]\n",
    "for index in range(len(pd_data)):\n",
    "    item = pd_data.loc[index]\n",
    "    # redis 数据库获取缺失订单价格数据字段，1为完成订单，2为退款订单\n",
    "    try:\n",
    "        pay_rate = sum([pay_rate_map.get(channel, 0) for channel in item.payChannel.split(',')])\n",
    "    except:\n",
    "        pay_rate = 0\n",
    "    paid_list = item.paidList or [item.paymentSerial]\n",
    "    status = rrdb.execute_command('jget', 'o:{}'.format(item.id), '/status')\n",
    "\n",
    "    for paid_id in paid_list:\n",
    "        payment_data = (rdb_1.hgetall('p:{0}:{1}'.format(item.appCode, paid_id)))\n",
    "        if payment_data.get('status', '-1') in ['2', '3'] or status in [3, 4, 6, 7, 11]:\n",
    "            pay_id = payment_data.get('serialNum', '') or payment_data.get('serial', '')\n",
    "\n",
    "            paid_time = payment_data.get('paidAt') or payment_data.get('createdAt')\n",
    "            if (not paid_time) or (not (start_time <= int(paid_time) < end_time)):\n",
    "                continue\n",
    "            paid_time = get_datetime_from_microsecond(float(paid_time))\n",
    "\n",
    "            pay_price = payment_data.get('payPrice') or payment_data.get('price')\n",
    "            pay_price = float(pay_price) / 100 if pay_price else 0\n",
    "\n",
    "            pay_data.append(\n",
    "                {\n",
    "                    'id': payment_data['id'],\n",
    "                    'payId': pay_id,\n",
    "                    'paidTime': paid_time,\n",
    "                    'payPrice': pay_price,\n",
    "                    'payRate': round(pay_price * pay_rate, 2),\n",
    "                    'transactionType': '交易',\n",
    "                }\n",
    "            )\n",
    "\n",
    "    if item.status in ['7', 7]:\n",
    "        # 交易明细报表中体现redis退款字段\n",
    "        # refund_id = rdb_0.get('r_mapper:{}:{}'.format(item.appCode, item.id))\n",
    "        for pg_data in pg_select(f\"SELECT flow_id FROM boluome_refund_flow WHERE order_id='{item.id}';\", pg('account')):\n",
    "            refund_id = pg_data.get('flow_id')\n",
    "        refund_data = rdb_2.hgetall('r:{}:{}'.format(item.appCode, refund_id))\n",
    "        if refund_data.get('status', '-1') == '2':\n",
    "            refund_time = refund_data.get('refundedAt')\n",
    "            if (not refund_time) or (not (start_time <= int(refund_time) < end_time)):\n",
    "                continue\n",
    "            refund_time = get_datetime_from_microsecond(float(refund_time))\n",
    "            refund_price = refund_data.get('price')\n",
    "            if refund_price:\n",
    "                refund_price = -(float(refund_price) / 100)\n",
    "            pay_data.append(\n",
    "                {\n",
    "                    'id': refund_data['id'],\n",
    "                    'payId': refund_id,\n",
    "                    # 'orderPrice': -item.orderPrice,\n",
    "                    'paidTime': refund_time,\n",
    "                    'payPrice': refund_price,\n",
    "                    'payRate': round(-refund_price * pay_rate, 2),\n",
    "                    'transactionType': '退款',\n",
    "                }\n",
    "            )\n",
    "\n",
    "pd_data = pd.merge(pd_data, pd.DataFrame(pay_data), on=\"id\", how=\"right\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 数据清理\n",
    "# createdAt\n",
    "pd_data.createdAt = pd_data.createdAt.fillna('')\n",
    "pd_data.createdAt = pd_data.createdAt.map(lambda x: pd.to_datetime(\n",
    "    x, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')\n",
    "pd_data.completedAt = pd_data.completedAt.fillna('')\n",
    "pd_data.completedAt = pd_data.completedAt.map(lambda x: pd.to_datetime(\n",
    "    x, unit='ms', utc=True).astimezone('Asia/Shanghai').strftime('%Y-%m-%d %H:%M:%S') if x else '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "198    -42.0\n",
       "200    -42.0\n",
       "202    -48.0\n",
       "204    -28.0\n",
       "205     -3.0\n",
       "206     -3.0\n",
       "207    -28.0\n",
       "208   -135.0\n",
       "Name: orderPrice, dtype: float64"
      ]
     },
     "execution_count": 223,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.loc[pd_data.transactionType.isin(['退款']),'orderPrice']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 222,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd_data.loc[pd_data.transactionType=='退款','orderPrice']= -pd_data.orderPrice"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# deductionPrice\n",
    "pd_data.loc[pd_data.transactionType == '退款','orderPrice'] = -pd_data.orderPrice\n",
    "pd_data['deductionPrice'] = pd_data.orderPrice - pd_data.payPrice\n",
    "\n",
    "# 数据值映射\n",
    "pd_data.channel = pd_data.channel.map(lambda x: map_order_channel.get(x, x))\n",
    "pd_data.payChannel = pd_data.payChannel.map(lambda x: map_pay_channel_function(x, pg('account')))\n",
    "app_code_map = {item['app_code']: item['app_name'] for item in pg_select(\"SELECT app_name,app_code FROM application;\", pg('oto_saas'))}\n",
    "pd_data.appCode = pd_data.appCode.map(lambda x: app_code_map.get(x, x))\n",
    "pd_data.columns = [map_key.get(k, k) for k in pd_data.columns]\n",
    "del_columns = set(pd_data.columns) - set(field_headers)\n",
    "pd_data.drop(del_columns, axis=1, inplace=True)\n",
    "# 导出报表\n",
    "pd_data.ix[:, field_headers].to_excel(out_path_transaction, index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### boss系统导出交易流水报表"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "mdb=c.pmdb\n",
    "pg=c.ppgdb\n",
    "rrdb=c.prrdb(0)\n",
    "rdb_1 = c.prdb_paym(1)\n",
    "rdb_2 = c.prdb_paym(2)\n",
    "def get_datetime_from_microsecond(timestamp):\n",
    "    return time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(timestamp / 1000))\n",
    "app_code='91ala'\n",
    "start_time = time.mktime((2017, 11, 3, 0, 0, 0, 0, 0, 0)) * 1000\n",
    "end_time = time.mktime((2017, 11, 3, 24, 0, 0, 0, 0, 0)) * 1000\n",
    "\n",
    "rst = mdb['order_lite_list'].find({'appCode': app_code, 'createdAt': {'$gte': start_time, '$lt': end_time}},\n",
    "                                  projection={'_id': 0,\n",
    "                                              'orderType': 1,\n",
    "                                              'id': 1,\n",
    "                                              'channel': 1,\n",
    "                                              'userId': 1,\n",
    "                                              'name': 1,\n",
    "                                              'createdAt': 1,\n",
    "                                              'displayStatus': 1,\n",
    "                                              'status': 1, })\n",
    "\n",
    "pd_data = pd.DataFrame(list(rst))\n",
    "\n",
    "data_list = []\n",
    "for name, _ in pd_data.groupby([\"orderType\"]):\n",
    "    id_list = list(pd_data[pd_data.orderType == name].id)\n",
    "\n",
    "    data_list.extend(list(mdb['order_{}'.format(name)].find({'id': {'$in': id_list}},\n",
    "                                                            projection={'_id': 0,\n",
    "                                                                        'id': 1,\n",
    "                                                                        'phone': 1,\n",
    "                                                                        'userPhone': 1,\n",
    "                                                                        'partnerId': 1,\n",
    "                                                                        'payCnannel': 1,\n",
    "                                                                        'orderPrice': 1,\n",
    "                                                                        'price': 1,\n",
    "                                                                        'paidList': 1})))\n",
    "pd_data = pd.merge(pd_data, pd.DataFrame(data_list), on=\"id\", how=\"left\")\n",
    "pay_data = [{'id': '',\n",
    "             'payId': '',\n",
    "             'payChannel': '',\n",
    "             'paidTime': '',\n",
    "             'payPrice': '',\n",
    "             'orderName': ''}]\n",
    "\n",
    "for index in range(len(pd_data)):\n",
    "    item = pd_data.loc[index]\n",
    "    # redis 数据库获取缺失订单价格数据字段，1为完成订单，2为退款订单\n",
    "    if 'paidList' not in item:\n",
    "        paid_list = [item.id]\n",
    "    else:\n",
    "        paid_list = item.paidList if isinstance(item.paidList, list) else [item.id]\n",
    "\n",
    "    for paid_id in paid_list:\n",
    "        payment_data = (rdb_1.hgetall('p:{0}:{1}'.format(app_code, paid_id)) or\n",
    "                        rdb_1.hgetall('p:{0}:{1}'.format(app_code, paid_id + '00')))\n",
    "        if payment_data.get('status', '-1') in ['2', '3']:\n",
    "            pay_id = payment_data.get('serialNum', '') or payment_data.get('serial', '')\n",
    "            pay_channel = payment_data.get('channel', '') or app_code\n",
    "\n",
    "            paid_time = payment_data.get('paidAt') or payment_data.get(\n",
    "                'paidat') or payment_data.get('createdat') or payment_data.get('createdAt')\n",
    "            if paid_time:\n",
    "                paid_time = get_datetime_from_microsecond(float(paid_time))\n",
    "\n",
    "            pay_price = payment_data.get('payPrice') or payment_data.get('payprice') or payment_data.get('price')\n",
    "            if pay_price:\n",
    "                pay_price = float(pay_price) / 100\n",
    "\n",
    "            pay_data.append({'id': payment_data['id'],\n",
    "                             'payId': pay_id,\n",
    "                             'payChannel': pay_channel,\n",
    "                             'paidTime': paid_time,\n",
    "                             'payPrice': pay_price,\n",
    "                             'orderName': payment_data.get('name')})\n",
    "\n",
    "        elif item.status == 7:\n",
    "            # 交易明细报表中暂时未能体现redis退款字段，故pass\n",
    "            pass\n",
    "\n",
    "pd_data = pd.merge(pd_data, pd.DataFrame(pay_data), on=\"id\", how=\"left\")\n",
    "# createdAt\n",
    "pd_data.createdAt = pd_data.createdAt.map(lambda x: get_datetime_from_microsecond(x))\n",
    "# name\n",
    "pd_data.loc[pd_data[pd_data.orderName.isnull() == False].index, \"name\"] = pd_data[pd_data.orderName.isnull() == False].orderName\n",
    "# deductionPrice\n",
    "pd_data['deductionPrice'] = pd_data.orderPrice - pd_data.payPrice\n",
    "pd_data['deductionPrice'] = pd_data.deductionPrice.map(lambda x: x if x > 0 else 0)\n",
    "\n",
    "\"\"\"\n",
    "数据值映射\n",
    "\"\"\"\n",
    "# map orderType\n",
    "map_order_type = {\n",
    "    'balance': '钱包',\n",
    "    'baoyang': '保养',\n",
    "    'coffee': '星巴克',\n",
    "    'daijia': '代驾',\n",
    "    'dianying': '电影',\n",
    "    'huafei': '话费',\n",
    "    'huoche': '火车',\n",
    "    'jiadianqingxi': '家电清洗',\n",
    "    'jiadianweixiu': '家电维修',\n",
    "    'jiayouka': '加油卡',\n",
    "    'jipiao': '机票',\n",
    "    'jiudian': '酒店',\n",
    "    'liuliang': '流量',\n",
    "    'menpiao': '门票',\n",
    "    'paotui': '跑腿',\n",
    "    'piaowu': '票务',\n",
    "    'sdm': '水电煤',\n",
    "    'shenghuojiaofei': '生活缴费',\n",
    "    'shengxian': '生鲜',\n",
    "    'waimai': '外卖',\n",
    "    'xianhua': '鲜花',\n",
    "    'xihu': '洗护',\n",
    "    'zhuanche': '专车',\n",
    "    'weizhang': '违章缴费',\n",
    "    'jieji': '接机'\n",
    "}\n",
    "pd_data.orderType = pd_data.orderType.map(lambda x: map_order_type.get(x, x))\n",
    "# map channel\n",
    "map_order_channel = {\n",
    "    'ele': '饿了么',\n",
    "    'tieyou': '铁友',\n",
    "    'dhst': '大汉三通',\n",
    "    'zhenlv': '真旅',\n",
    "    'ofpay': '欧飞',\n",
    "    'balance': '菠萝觅',\n",
    "    'linqu': '邻趣',\n",
    "    'e': 'e代驾',\n",
    "    'fft': '付费通',\n",
    "    'sfdj': '十分到家',\n",
    "    'elong': '艺龙',\n",
    "    'tidy': '泰迪',\n",
    "    'ai': '爱代驾',\n",
    "    'ctrip': '携程',\n",
    "    'lvmama': '驴妈妈',\n",
    "    'tongcheng': '同程',\n",
    "    'gaoyang': '高阳',\n",
    "    'qunar': '去哪儿',\n",
    "    'qunar_baitour': '去哪儿-百拓',\n",
    "    'yiguo': '易果',\n",
    "    'zmn': '啄木鸟',\n",
    "    'didi': '滴滴',\n",
    "    'yidao': '易到',\n",
    "    'dsby': '大师保养',\n",
    "    'chinapay': '银联',\n",
    "    'kou': '抠电影',\n",
    "    'zzw': '蜘蛛网',\n",
    "    'xishiqu': '西十区',\n",
    "    'diandian': '典典养车',\n",
    "    'carlife': '车生活',\n",
    "    'chinaums': '银联',\n",
    "}\n",
    "pd_data.channel = pd_data.channel.map(lambda x: map_order_channel.get(x, x))\n",
    "# map payChannel\n",
    "\n",
    "def map_pay_channel_function(pay_channel):\n",
    "    if not isinstance(pay_channel, str):\n",
    "        return pay_channel\n",
    "    map_pay_channel = {\n",
    "        'wx': '微信',\n",
    "        'alipay': '支付宝',\n",
    "        'allinpay_qianbao': '通联钱包',\n",
    "        'alipay_wap': '支付宝_wap',\n",
    "        'balance': '菠萝觅',\n",
    "        'chinapay': '银联',\n",
    "        'ccb': '建行',\n",
    "        'bosc': '上行',\n",
    "        'icbc': '工行',\n",
    "        'chubao': '触宝',\n",
    "        'alipay_qr': '支付宝扫码支付',\n",
    "        'wx_pub_qr': '微信扫码支付',\n",
    "        'fanbei': '51返呗',\n",
    "        'pingan-one': '平安一账通',\n",
    "        'abchina': '农银支付',\n",
    "    }\n",
    "    if ',' in pay_channel:\n",
    "        return \",\".join([map_pay_channel.get(key, key) for key in pay_channel.split(',')])\n",
    "    elif pay_channel:\n",
    "        return map_pay_channel.get(pay_channel, pay_channel)\n",
    "pd_data.payChannel = pd_data.payChannel.map(lambda x: map_pay_channel_function(x))\n",
    "\n",
    "# map key\n",
    "map_key = {'appCode': '应用名称',\n",
    "           'id': '订单号',\n",
    "           'orderType': '品类',\n",
    "           'channel': '供应商',\n",
    "           'partnerId': '供应商订单号',\n",
    "           'userPhone': '手机号',\n",
    "           'userId': '用户ID',\n",
    "           'name': '订单名称',\n",
    "           'orderPrice': '订单金额',\n",
    "           'payPrice': '支付金额',\n",
    "           'deductionPrice': '优惠金额',\n",
    "           'displayStatus': '订单状态',\n",
    "           'payChannel': '支付方式',\n",
    "           'createdAt': '下单时间',\n",
    "           'paidTime': '支付时间',\n",
    "           'payId': '支付流水号'}\n",
    "pd_data.columns = [map_key.get(k, k) for k in pd_data.columns]\n",
    "field_headers = ['订单号', '支付流水号', '手机号', '品类', '供应商', '订单名称', '订单金额', '支付金额',\n",
    "                         '优惠金额', '订单状态', '支付方式', '下单时间', '支付时间', '供应商订单号']\n",
    "del_columns = set(pd_data.columns) - set(field_headers)\n",
    "pd_data.drop(del_columns, axis=1, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/python3/lib/python3.6/site-packages/ipykernel/__main__.py:1: DeprecationWarning: \n",
      ".ix is deprecated. Please use\n",
      ".loc for label based indexing or\n",
      ".iloc for positional indexing\n",
      "\n",
      "See the documentation here:\n",
      "http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate_ix\n",
      "  if __name__ == '__main__':\n"
     ]
    }
   ],
   "source": [
    "pd_data.ix[:, field_headers].to_excel('tedfd.xlsx', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>供应商</th>\n",
       "      <th>下单时间</th>\n",
       "      <th>订单状态</th>\n",
       "      <th>订单号</th>\n",
       "      <th>订单名称</th>\n",
       "      <th>品类</th>\n",
       "      <th>订单金额</th>\n",
       "      <th>供应商订单号</th>\n",
       "      <th>手机号</th>\n",
       "      <th>支付时间</th>\n",
       "      <th>支付方式</th>\n",
       "      <th>支付流水号</th>\n",
       "      <th>支付金额</th>\n",
       "      <th>优惠金额</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:05:32</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446161610760</td>\n",
       "      <td>四川广安移动200元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:05:34</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446161872869</td>\n",
       "      <td>四川广安移动200元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:05:43</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446163052518</td>\n",
       "      <td>四川广安移动100元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>99.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:07:03</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446173538316</td>\n",
       "      <td>四川广安移动200元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:08:01</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446181140496</td>\n",
       "      <td>广东湛江移动50元 - 135****7487</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.81</td>\n",
       "      <td></td>\n",
       "      <td>13531107487</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:08:09</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446182189038</td>\n",
       "      <td>广东湛江移动50元 - 135****7487</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.81</td>\n",
       "      <td></td>\n",
       "      <td>13531107487</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:08:12</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446182582289</td>\n",
       "      <td>四川广安移动200元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:08:49</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446187431919</td>\n",
       "      <td>四川广安移动50元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:08:52</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446187825170</td>\n",
       "      <td>四川广安移动50元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>大汉三通</td>\n",
       "      <td>2017-11-03 00:08:57</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446188480496</td>\n",
       "      <td>四川移动150M - 188****0337</td>\n",
       "      <td>流量</td>\n",
       "      <td>19.96</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:09:07</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446189791217</td>\n",
       "      <td>绿色生活果品鲜切榨汁</td>\n",
       "      <td>外卖</td>\n",
       "      <td>31.80</td>\n",
       "      <td>3014840974110018767</td>\n",
       "      <td>13641656321</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:09:32</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446193068051</td>\n",
       "      <td>四川广安移动200元 - 188****0337</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18882650337</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:30</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446200670204</td>\n",
       "      <td>广东东莞移动50元 - 134****2520</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.81</td>\n",
       "      <td></td>\n",
       "      <td>13423272520</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:30</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446200670233</td>\n",
       "      <td>四川成都移动50元 - 187****9440</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:34</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446201194493</td>\n",
       "      <td>四川成都移动50元 - 187****9440</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:34</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446201194522</td>\n",
       "      <td>广东东莞移动50元 - 134****2520</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.81</td>\n",
       "      <td></td>\n",
       "      <td>13423272520</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:37</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446201587710</td>\n",
       "      <td>四川成都移动50元 - 187****9440</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:10:42</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446202112027</td>\n",
       "      <td>沙县小吃（石坪桥店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>32.50</td>\n",
       "      <td>3014841067082550293</td>\n",
       "      <td>13617617770</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:10:56</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446204078108</td>\n",
       "      <td>四川成都移动50元 - 182****8044</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:11:00</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446204602367</td>\n",
       "      <td>四川成都移动200元 - 182****8044</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:11:06</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446205388829</td>\n",
       "      <td>四川成都移动50元 - 187****9440</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>18228038044</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 00:11:42</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446210107423</td>\n",
       "      <td>广东东莞移动50元 - 134****2520</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.81</td>\n",
       "      <td></td>\n",
       "      <td>13423272520</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:12:19</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446214957088</td>\n",
       "      <td>南昌瓦罐煨汤木桶饭（石坪桥店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>23.00</td>\n",
       "      <td>3014841070949698666</td>\n",
       "      <td>13617617770</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:12:46</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446218496002</td>\n",
       "      <td>南昌瓦罐煨汤木桶饭（石坪桥店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>23.00</td>\n",
       "      <td>3014841054558358634</td>\n",
       "      <td>13617617770</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:14:04</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446228719624</td>\n",
       "      <td>鲜美基（塘尾店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>33.00</td>\n",
       "      <td>1213152268739192037</td>\n",
       "      <td>17680493401</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:16:09</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446244972593</td>\n",
       "      <td>南昌瓦罐煨汤木桶饭（石坪桥店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>23.00</td>\n",
       "      <td>3014841148955364458</td>\n",
       "      <td>13617617770</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 00:16:39</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446249035828</td>\n",
       "      <td>南昌瓦罐煨汤木桶饭（石坪桥店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>23.00</td>\n",
       "      <td>3014841080235887722</td>\n",
       "      <td>13617617770</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 00:19:01</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446267648062</td>\n",
       "      <td>广州荔湾沁园旅馆 - 标准单人房(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>129.00</td>\n",
       "      <td>undefined</td>\n",
       "      <td>15568877864</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 00:19:04</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446268041236</td>\n",
       "      <td>广州荔湾沁园旅馆 - 标准单人房(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>129.00</td>\n",
       "      <td>undefined</td>\n",
       "      <td>15568877864</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 00:19:20</td>\n",
       "      <td>异常</td>\n",
       "      <td>ala202446270138434</td>\n",
       "      <td>广州荔湾沁园旅馆 - 标准单人房(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>129.00</td>\n",
       "      <td>undefined</td>\n",
       "      <td>15568877864</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1177</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:02:25</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202456989867390</td>\n",
       "      <td>湖北武汉电信200元 - 189****6777</td>\n",
       "      <td>话费</td>\n",
       "      <td>199.60</td>\n",
       "      <td></td>\n",
       "      <td>18986116777</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1178</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:04:04</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457002843540</td>\n",
       "      <td>河南周口联通50元 - 176****1416</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>17739308193</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1179</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:05:46</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457016212868</td>\n",
       "      <td>山东临沂联通50元 - 176****6399</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>17686956575</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1180</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:07:55</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457033121182</td>\n",
       "      <td>美宜佳（扶贵西路店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>61.50</td>\n",
       "      <td>1213190437551566037</td>\n",
       "      <td>17820063780</td>\n",
       "      <td>2017-11-03 23:08:13</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457033252255</td>\n",
       "      <td>61.50</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1181</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:09:56</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457048980898</td>\n",
       "      <td>广东深圳移动100元 - 188****0619</td>\n",
       "      <td>话费</td>\n",
       "      <td>99.50</td>\n",
       "      <td></td>\n",
       "      <td>18806650619</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1182</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:10:24</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457052650916</td>\n",
       "      <td>广东佛山联通100元 - 186****8962</td>\n",
       "      <td>话费</td>\n",
       "      <td>99.70</td>\n",
       "      <td></td>\n",
       "      <td>18675138962</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1183</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:15:53</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457095642524</td>\n",
       "      <td>饭先生</td>\n",
       "      <td>外卖</td>\n",
       "      <td>26.50</td>\n",
       "      <td>1213190572203744420</td>\n",
       "      <td>15040614175</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1184</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:18:07</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457113206174</td>\n",
       "      <td>椰岛海南鸡饭</td>\n",
       "      <td>外卖</td>\n",
       "      <td>50.00</td>\n",
       "      <td>3014878072334453980</td>\n",
       "      <td>15000316069</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1185</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:21:34</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457140469171</td>\n",
       "      <td>浙江杭州移动50元 - 150****3187</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.83</td>\n",
       "      <td>S1711034571583</td>\n",
       "      <td>13738037205</td>\n",
       "      <td>2017-11-03 23:21:57</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457140469172</td>\n",
       "      <td>49.83</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1186</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:23:19</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457154100646</td>\n",
       "      <td>华莱士(高中店)</td>\n",
       "      <td>外卖</td>\n",
       "      <td>40.00</td>\n",
       "      <td>1213190688167684253</td>\n",
       "      <td>18937888847</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1187</th>\n",
       "      <td>高阳</td>\n",
       "      <td>2017-11-03 23:27:40</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457188572607</td>\n",
       "      <td>中石油卡:903****7108 充值 1000.0元</td>\n",
       "      <td>加油卡</td>\n",
       "      <td>1000.00</td>\n",
       "      <td></td>\n",
       "      <td>18711064232</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1188</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:29:29</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457202728387</td>\n",
       "      <td>江苏苏州移动50元 - 159****7447</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.90</td>\n",
       "      <td></td>\n",
       "      <td>15950077447</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1189</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:29:37</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457203645875</td>\n",
       "      <td>华莱士（东莞谢岗店）</td>\n",
       "      <td>外卖</td>\n",
       "      <td>53.00</td>\n",
       "      <td>1213190738845213755</td>\n",
       "      <td>15976171476</td>\n",
       "      <td>2017-11-03 23:29:55</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457203776948</td>\n",
       "      <td>53.00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1190</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:32:33</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457226845641</td>\n",
       "      <td>湖北武汉电信50元 - 133****4199</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.90</td>\n",
       "      <td>S1711034580103</td>\n",
       "      <td>13385204199</td>\n",
       "      <td>2017-11-03 23:33:11</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457226845642</td>\n",
       "      <td>49.90</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1191</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 23:35:00</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457246244301</td>\n",
       "      <td>杭州清凡居酒店 - 朝暮(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>179.00</td>\n",
       "      <td>4799579231</td>\n",
       "      <td>13758227875</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1192</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:36:55</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457261186495</td>\n",
       "      <td>广东深圳移动100元 - 182****5482</td>\n",
       "      <td>话费</td>\n",
       "      <td>99.50</td>\n",
       "      <td></td>\n",
       "      <td>18218025482</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1193</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:41:36</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457297886660</td>\n",
       "      <td>天天想你麻辣酱鸭店</td>\n",
       "      <td>外卖</td>\n",
       "      <td>57.50</td>\n",
       "      <td>1213190862600641745</td>\n",
       "      <td>13842936956</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1194</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:42:30</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457305095626</td>\n",
       "      <td>辽宁葫芦岛移动50元 - 138****6956</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>13842936956</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1195</th>\n",
       "      <td>高阳</td>\n",
       "      <td>2017-11-03 23:43:44</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457314663888</td>\n",
       "      <td>中石化卡:100****1318 充值 1000.0元</td>\n",
       "      <td>加油卡</td>\n",
       "      <td>1000.00</td>\n",
       "      <td></td>\n",
       "      <td>18716550995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1196</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:44:20</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457319513564</td>\n",
       "      <td>浙江宁波移动500元 - 135****0029</td>\n",
       "      <td>话费</td>\n",
       "      <td>499.00</td>\n",
       "      <td></td>\n",
       "      <td>13506780029</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1197</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:44:35</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457321348562</td>\n",
       "      <td>咖啡雪冰炸鸡披萨店</td>\n",
       "      <td>外卖</td>\n",
       "      <td>38.00</td>\n",
       "      <td>1213190795500180638</td>\n",
       "      <td>15002433282</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1198</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:46:05</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457333276120</td>\n",
       "      <td>河北衡水电信50元 - 181****2861</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.90</td>\n",
       "      <td></td>\n",
       "      <td>15030802543</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1199</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:46:56</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457339960796</td>\n",
       "      <td>广东深圳电信50元 - 189****7113</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.90</td>\n",
       "      <td></td>\n",
       "      <td>18948707113</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1200</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:50:56</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457371418083</td>\n",
       "      <td>广东深圳联通50元 - 175****1941</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td></td>\n",
       "      <td>17520491941</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1201</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:51:54</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457379020269</td>\n",
       "      <td>海鲜烧烤店</td>\n",
       "      <td>外卖</td>\n",
       "      <td>25.00</td>\n",
       "      <td>3014878607445371995</td>\n",
       "      <td>18883681420</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1202</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 23:54:13</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457397239273</td>\n",
       "      <td>汉庭酒店（杭州西湖店） - 零压双床房(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>796.00</td>\n",
       "      <td>4799644954</td>\n",
       "      <td>13758227875</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1203</th>\n",
       "      <td>欧飞</td>\n",
       "      <td>2017-11-03 23:55:20</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457406021105</td>\n",
       "      <td>四川成都移动50元 - 182****0649</td>\n",
       "      <td>话费</td>\n",
       "      <td>49.85</td>\n",
       "      <td>S1711034593896</td>\n",
       "      <td>18782085104</td>\n",
       "      <td>2017-11-03 23:55:43</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457406021106</td>\n",
       "      <td>49.85</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1204</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:58:28</td>\n",
       "      <td>已完成</td>\n",
       "      <td>ala202457430662643</td>\n",
       "      <td>秦烧烤</td>\n",
       "      <td>外卖</td>\n",
       "      <td>39.00</td>\n",
       "      <td>3014878629314518061</td>\n",
       "      <td>15023537777</td>\n",
       "      <td>2017-11-03 23:58:41</td>\n",
       "      <td>51返呗</td>\n",
       "      <td>ala212457430662644</td>\n",
       "      <td>39.00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1205</th>\n",
       "      <td>饿了么</td>\n",
       "      <td>2017-11-03 23:58:41</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457432235511</td>\n",
       "      <td>麦乐基林校店</td>\n",
       "      <td>外卖</td>\n",
       "      <td>17.00</td>\n",
       "      <td>3014878630069739701</td>\n",
       "      <td>18750759735</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206</th>\n",
       "      <td>携程</td>\n",
       "      <td>2017-11-03 23:59:23</td>\n",
       "      <td>已取消</td>\n",
       "      <td>ala202457437871609</td>\n",
       "      <td>杭州观湖假日酒店 - 标准房(内宾)</td>\n",
       "      <td>酒店</td>\n",
       "      <td>396.00</td>\n",
       "      <td>4799660560</td>\n",
       "      <td>13758227875</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1207 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       供应商                 下单时间 订单状态                 订单号  \\\n",
       "0       欧飞  2017-11-03 00:05:32   异常  ala202446161610760   \n",
       "1       欧飞  2017-11-03 00:05:34   异常  ala202446161872869   \n",
       "2       欧飞  2017-11-03 00:05:43   异常  ala202446163052518   \n",
       "3       欧飞  2017-11-03 00:07:03   异常  ala202446173538316   \n",
       "4       欧飞  2017-11-03 00:08:01   异常  ala202446181140496   \n",
       "5       欧飞  2017-11-03 00:08:09   异常  ala202446182189038   \n",
       "6       欧飞  2017-11-03 00:08:12   异常  ala202446182582289   \n",
       "7       欧飞  2017-11-03 00:08:49   异常  ala202446187431919   \n",
       "8       欧飞  2017-11-03 00:08:52   异常  ala202446187825170   \n",
       "9     大汉三通  2017-11-03 00:08:57   异常  ala202446188480496   \n",
       "10     饿了么  2017-11-03 00:09:07   异常  ala202446189791217   \n",
       "11      欧飞  2017-11-03 00:09:32   异常  ala202446193068051   \n",
       "12      欧飞  2017-11-03 00:10:30   异常  ala202446200670204   \n",
       "13      欧飞  2017-11-03 00:10:30   异常  ala202446200670233   \n",
       "14      欧飞  2017-11-03 00:10:34   异常  ala202446201194493   \n",
       "15      欧飞  2017-11-03 00:10:34   异常  ala202446201194522   \n",
       "16      欧飞  2017-11-03 00:10:37   异常  ala202446201587710   \n",
       "17     饿了么  2017-11-03 00:10:42   异常  ala202446202112027   \n",
       "18      欧飞  2017-11-03 00:10:56   异常  ala202446204078108   \n",
       "19      欧飞  2017-11-03 00:11:00   异常  ala202446204602367   \n",
       "20      欧飞  2017-11-03 00:11:06   异常  ala202446205388829   \n",
       "21      欧飞  2017-11-03 00:11:42   异常  ala202446210107423   \n",
       "22     饿了么  2017-11-03 00:12:19   异常  ala202446214957088   \n",
       "23     饿了么  2017-11-03 00:12:46   异常  ala202446218496002   \n",
       "24     饿了么  2017-11-03 00:14:04   异常  ala202446228719624   \n",
       "25     饿了么  2017-11-03 00:16:09   异常  ala202446244972593   \n",
       "26     饿了么  2017-11-03 00:16:39   异常  ala202446249035828   \n",
       "27      携程  2017-11-03 00:19:01   异常  ala202446267648062   \n",
       "28      携程  2017-11-03 00:19:04   异常  ala202446268041236   \n",
       "29      携程  2017-11-03 00:19:20   异常  ala202446270138434   \n",
       "...    ...                  ...  ...                 ...   \n",
       "1177    欧飞  2017-11-03 23:02:25  已取消  ala202456989867390   \n",
       "1178    欧飞  2017-11-03 23:04:04  已取消  ala202457002843540   \n",
       "1179    欧飞  2017-11-03 23:05:46  已取消  ala202457016212868   \n",
       "1180   饿了么  2017-11-03 23:07:55  已完成  ala202457033121182   \n",
       "1181    欧飞  2017-11-03 23:09:56  已取消  ala202457048980898   \n",
       "1182    欧飞  2017-11-03 23:10:24  已取消  ala202457052650916   \n",
       "1183   饿了么  2017-11-03 23:15:53  已取消  ala202457095642524   \n",
       "1184   饿了么  2017-11-03 23:18:07  已取消  ala202457113206174   \n",
       "1185    欧飞  2017-11-03 23:21:34  已完成  ala202457140469171   \n",
       "1186   饿了么  2017-11-03 23:23:19  已取消  ala202457154100646   \n",
       "1187    高阳  2017-11-03 23:27:40  已取消  ala202457188572607   \n",
       "1188    欧飞  2017-11-03 23:29:29  已取消  ala202457202728387   \n",
       "1189   饿了么  2017-11-03 23:29:37  已完成  ala202457203645875   \n",
       "1190    欧飞  2017-11-03 23:32:33  已完成  ala202457226845641   \n",
       "1191    携程  2017-11-03 23:35:00  已取消  ala202457246244301   \n",
       "1192    欧飞  2017-11-03 23:36:55  已取消  ala202457261186495   \n",
       "1193   饿了么  2017-11-03 23:41:36  已取消  ala202457297886660   \n",
       "1194    欧飞  2017-11-03 23:42:30  已取消  ala202457305095626   \n",
       "1195    高阳  2017-11-03 23:43:44  已取消  ala202457314663888   \n",
       "1196    欧飞  2017-11-03 23:44:20  已取消  ala202457319513564   \n",
       "1197   饿了么  2017-11-03 23:44:35  已取消  ala202457321348562   \n",
       "1198    欧飞  2017-11-03 23:46:05  已取消  ala202457333276120   \n",
       "1199    欧飞  2017-11-03 23:46:56  已取消  ala202457339960796   \n",
       "1200    欧飞  2017-11-03 23:50:56  已取消  ala202457371418083   \n",
       "1201   饿了么  2017-11-03 23:51:54  已取消  ala202457379020269   \n",
       "1202    携程  2017-11-03 23:54:13  已取消  ala202457397239273   \n",
       "1203    欧飞  2017-11-03 23:55:20  已完成  ala202457406021105   \n",
       "1204   饿了么  2017-11-03 23:58:28  已完成  ala202457430662643   \n",
       "1205   饿了么  2017-11-03 23:58:41  已取消  ala202457432235511   \n",
       "1206    携程  2017-11-03 23:59:23  已取消  ala202457437871609   \n",
       "\n",
       "                             订单名称   品类     订单金额               供应商订单号  \\\n",
       "0        四川广安移动200元 - 188****0337   话费   199.60                        \n",
       "1        四川广安移动200元 - 188****0337   话费   199.60                        \n",
       "2        四川广安移动100元 - 188****0337   话费    99.60                        \n",
       "3        四川广安移动200元 - 188****0337   话费   199.60                        \n",
       "4         广东湛江移动50元 - 135****7487   话费    49.81                        \n",
       "5         广东湛江移动50元 - 135****7487   话费    49.81                        \n",
       "6        四川广安移动200元 - 188****0337   话费   199.60                        \n",
       "7         四川广安移动50元 - 188****0337   话费    49.85                        \n",
       "8         四川广安移动50元 - 188****0337   话费    49.85                        \n",
       "9          四川移动150M - 188****0337   流量    19.96                        \n",
       "10                     绿色生活果品鲜切榨汁   外卖    31.80  3014840974110018767   \n",
       "11       四川广安移动200元 - 188****0337   话费   199.60                        \n",
       "12        广东东莞移动50元 - 134****2520   话费    49.81                        \n",
       "13        四川成都移动50元 - 187****9440   话费    49.85                        \n",
       "14        四川成都移动50元 - 187****9440   话费    49.85                        \n",
       "15        广东东莞移动50元 - 134****2520   话费    49.81                        \n",
       "16        四川成都移动50元 - 187****9440   话费    49.85                        \n",
       "17                     沙县小吃（石坪桥店）   外卖    32.50  3014841067082550293   \n",
       "18        四川成都移动50元 - 182****8044   话费    49.85                        \n",
       "19       四川成都移动200元 - 182****8044   话费   199.60                        \n",
       "20        四川成都移动50元 - 187****9440   话费    49.85                        \n",
       "21        广东东莞移动50元 - 134****2520   话费    49.81                        \n",
       "22                南昌瓦罐煨汤木桶饭（石坪桥店）   外卖    23.00  3014841070949698666   \n",
       "23                南昌瓦罐煨汤木桶饭（石坪桥店）   外卖    23.00  3014841054558358634   \n",
       "24                       鲜美基（塘尾店）   外卖    33.00  1213152268739192037   \n",
       "25                南昌瓦罐煨汤木桶饭（石坪桥店）   外卖    23.00  3014841148955364458   \n",
       "26                南昌瓦罐煨汤木桶饭（石坪桥店）   外卖    23.00  3014841080235887722   \n",
       "27           广州荔湾沁园旅馆 - 标准单人房(内宾)   酒店   129.00            undefined   \n",
       "28           广州荔湾沁园旅馆 - 标准单人房(内宾)   酒店   129.00            undefined   \n",
       "29           广州荔湾沁园旅馆 - 标准单人房(内宾)   酒店   129.00            undefined   \n",
       "...                           ...  ...      ...                  ...   \n",
       "1177     湖北武汉电信200元 - 189****6777   话费   199.60                        \n",
       "1178      河南周口联通50元 - 176****1416   话费    49.85                        \n",
       "1179      山东临沂联通50元 - 176****6399   话费    49.85                        \n",
       "1180                   美宜佳（扶贵西路店）   外卖    61.50  1213190437551566037   \n",
       "1181     广东深圳移动100元 - 188****0619   话费    99.50                        \n",
       "1182     广东佛山联通100元 - 186****8962   话费    99.70                        \n",
       "1183                          饭先生   外卖    26.50  1213190572203744420   \n",
       "1184                       椰岛海南鸡饭   外卖    50.00  3014878072334453980   \n",
       "1185      浙江杭州移动50元 - 150****3187   话费    49.83       S1711034571583   \n",
       "1186                     华莱士(高中店)   外卖    40.00  1213190688167684253   \n",
       "1187  中石油卡:903****7108 充值 1000.0元  加油卡  1000.00                        \n",
       "1188      江苏苏州移动50元 - 159****7447   话费    49.90                        \n",
       "1189                   华莱士（东莞谢岗店）   外卖    53.00  1213190738845213755   \n",
       "1190      湖北武汉电信50元 - 133****4199   话费    49.90       S1711034580103   \n",
       "1191             杭州清凡居酒店 - 朝暮(内宾)   酒店   179.00           4799579231   \n",
       "1192     广东深圳移动100元 - 182****5482   话费    99.50                        \n",
       "1193                    天天想你麻辣酱鸭店   外卖    57.50  1213190862600641745   \n",
       "1194     辽宁葫芦岛移动50元 - 138****6956   话费    49.85                        \n",
       "1195  中石化卡:100****1318 充值 1000.0元  加油卡  1000.00                        \n",
       "1196     浙江宁波移动500元 - 135****0029   话费   499.00                        \n",
       "1197                    咖啡雪冰炸鸡披萨店   外卖    38.00  1213190795500180638   \n",
       "1198      河北衡水电信50元 - 181****2861   话费    49.90                        \n",
       "1199      广东深圳电信50元 - 189****7113   话费    49.90                        \n",
       "1200      广东深圳联通50元 - 175****1941   话费    49.85                        \n",
       "1201                        海鲜烧烤店   外卖    25.00  3014878607445371995   \n",
       "1202      汉庭酒店（杭州西湖店） - 零压双床房(内宾)   酒店   796.00           4799644954   \n",
       "1203      四川成都移动50元 - 182****0649   话费    49.85       S1711034593896   \n",
       "1204                          秦烧烤   外卖    39.00  3014878629314518061   \n",
       "1205                       麦乐基林校店   外卖    17.00  3014878630069739701   \n",
       "1206           杭州观湖假日酒店 - 标准房(内宾)   酒店   396.00           4799660560   \n",
       "\n",
       "              手机号                 支付时间  支付方式               支付流水号   支付金额  优惠金额  \n",
       "0     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "2     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "3     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "4     13531107487                  NaN   NaN                 NaN    NaN   0.0  \n",
       "5     13531107487                  NaN   NaN                 NaN    NaN   0.0  \n",
       "6     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "7     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "8     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "9     18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "10    13641656321                  NaN   NaN                 NaN    NaN   0.0  \n",
       "11    18882650337                  NaN   NaN                 NaN    NaN   0.0  \n",
       "12    13423272520                  NaN   NaN                 NaN    NaN   0.0  \n",
       "13    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "14    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "15    13423272520                  NaN   NaN                 NaN    NaN   0.0  \n",
       "16    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "17    13617617770                  NaN   NaN                 NaN    NaN   0.0  \n",
       "18    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "19    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "20    18228038044                  NaN   NaN                 NaN    NaN   0.0  \n",
       "21    13423272520                  NaN   NaN                 NaN    NaN   0.0  \n",
       "22    13617617770                  NaN   NaN                 NaN    NaN   0.0  \n",
       "23    13617617770                  NaN   NaN                 NaN    NaN   0.0  \n",
       "24    17680493401                  NaN   NaN                 NaN    NaN   0.0  \n",
       "25    13617617770                  NaN   NaN                 NaN    NaN   0.0  \n",
       "26    13617617770                  NaN   NaN                 NaN    NaN   0.0  \n",
       "27    15568877864                  NaN   NaN                 NaN    NaN   0.0  \n",
       "28    15568877864                  NaN   NaN                 NaN    NaN   0.0  \n",
       "29    15568877864                  NaN   NaN                 NaN    NaN   0.0  \n",
       "...           ...                  ...   ...                 ...    ...   ...  \n",
       "1177  18986116777                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1178  17739308193                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1179  17686956575                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1180  17820063780  2017-11-03 23:08:13  51返呗  ala212457033252255  61.50   0.0  \n",
       "1181  18806650619                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1182  18675138962                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1183  15040614175                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1184  15000316069                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1185  13738037205  2017-11-03 23:21:57  51返呗  ala212457140469172  49.83   0.0  \n",
       "1186  18937888847                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1187  18711064232                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1188  15950077447                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1189  15976171476  2017-11-03 23:29:55  51返呗  ala212457203776948  53.00   0.0  \n",
       "1190  13385204199  2017-11-03 23:33:11  51返呗  ala212457226845642  49.90   0.0  \n",
       "1191  13758227875                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1192  18218025482                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1193  13842936956                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1194  13842936956                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1195  18716550995                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1196  13506780029                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1197  15002433282                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1198  15030802543                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1199  18948707113                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1200  17520491941                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1201  18883681420                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1202  13758227875                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1203  18782085104  2017-11-03 23:55:43  51返呗  ala212457406021106  49.85   0.0  \n",
       "1204  15023537777  2017-11-03 23:58:41  51返呗  ala212457430662644  39.00   0.0  \n",
       "1205  18750759735                  NaN   NaN                 NaN    NaN   0.0  \n",
       "1206  13758227875                  NaN   NaN                 NaN    NaN   0.0  \n",
       "\n",
       "[1207 rows x 14 columns]"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.applymap(lambda x: x.encode('unicode_escape').decode('unicode_escape') if isinstance(x, str) else x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>phone</th>\n",
       "      <th>userPhone</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [phone, userPhone]\n",
       "Index: []"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.loc[pd_data.userPhone.isnull(),['phone','userPhone']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'@!2™£¢'"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import re\n",
    "ILLEGAL_CHARACTERS_RE = re.compile(r'[\\000-\\010]|[\\013-\\014]|[\\016-\\037]')\n",
    "ILLEGAL_CHARACTERS_RE.sub(r'', '@!2™£¢')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'@!2™£¢'"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ILLEGAL_CHARACTERS_RE = re.compile(r's')\n",
    "ILLEGAL_CHARACTERS_RE.sub(r'', '@!2™£¢ss')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "b'\\x08'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(None, '\\x08')"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print('\\010'.encode()),'\\010'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pd_data.applymap(lambda x: ILLEGAL_CHARACTERS_RE.sub(r'', x) if isinstance(x, str) else x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 300,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "__main__.t"
      ]
     },
     "execution_count": 300,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "class t(object):\n",
    "    def __init__(self,a,b=None,c=None):\n",
    "        self._a=a\n",
    "        self._b=b\n",
    "        self._c=c\n",
    "s=t(1,b=2) \n",
    "s._c,s._b\n",
    "type(s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 258,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ctrip</td>\n",
       "      <td>ala202808331910059</td>\n",
       "      <td>jiudian</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512401872010</td>\n",
       "      <td>158.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>undefined</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202797681122095</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512320613148</td>\n",
       "      <td>49.85</td>\n",
       "      <td>[ala212797681122096]</td>\n",
       "      <td>S1712042122650</td>\n",
       "      <td>ala212797681122096</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202794081226240</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512293148929</td>\n",
       "      <td>22.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1214408624897079430</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202792207025230</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512278850033</td>\n",
       "      <td>16.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3016138567508615211</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202792078574486</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512277869939</td>\n",
       "      <td>52.50</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3016137569297589269</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   appCode channel                  id orderType payChannel  status  \\\n",
       "0    91ala   ctrip  ala202808331910059   jiudian        NaN       0   \n",
       "1    91ala   ofpay  ala202797681122095    huafei     fanbei       0   \n",
       "2  bestpay     ele   bp202794081226240    waimai        NaN       0   \n",
       "3  bestpay     ele   bp202792207025230    waimai        NaN       0   \n",
       "4  bestpay     ele   bp202792078574486    waimai        NaN       0   \n",
       "\n",
       "   completedAt      createdAt  orderPrice              paidList  \\\n",
       "0          NaN  1512401872010      158.00                   NaN   \n",
       "1          NaN  1512320613148       49.85  [ala212797681122096]   \n",
       "2          NaN  1512293148929       22.00                   NaN   \n",
       "3          NaN  1512278850033       16.00                   NaN   \n",
       "4          NaN  1512277869939       52.50                   NaN   \n",
       "\n",
       "             partnerId       paymentSerial  \n",
       "0            undefined                 NaN  \n",
       "1       S1712042122650  ala212797681122096  \n",
       "2  1214408624897079430                 NaN  \n",
       "3  3016138567508615211                 NaN  \n",
       "4  3016137569297589269                 NaN  "
      ]
     },
     "execution_count": 258,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 303,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appCode</th>\n",
       "      <th>channel</th>\n",
       "      <th>id</th>\n",
       "      <th>orderType</th>\n",
       "      <th>payChannel</th>\n",
       "      <th>status</th>\n",
       "      <th>completedAt</th>\n",
       "      <th>createdAt</th>\n",
       "      <th>orderPrice</th>\n",
       "      <th>paidList</th>\n",
       "      <th>partnerId</th>\n",
       "      <th>paymentSerial</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ctrip</td>\n",
       "      <td>ala202808331910059</td>\n",
       "      <td>jiudian</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512401872010</td>\n",
       "      <td>158.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>undefined</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>91ala</td>\n",
       "      <td>ofpay</td>\n",
       "      <td>ala202797681122095</td>\n",
       "      <td>huafei</td>\n",
       "      <td>fanbei</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512320613148</td>\n",
       "      <td>49.85</td>\n",
       "      <td>[ala212797681122096]</td>\n",
       "      <td>S1712042122650</td>\n",
       "      <td>ala212797681122096</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202794081226240</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512293148929</td>\n",
       "      <td>22.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1214408624897079430</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202792207025230</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512278850033</td>\n",
       "      <td>16.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3016138567508615211</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>bestpay</td>\n",
       "      <td>ele</td>\n",
       "      <td>bp202792078574486</td>\n",
       "      <td>waimai</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1512277869939</td>\n",
       "      <td>52.50</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3016137569297589269</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   appCode channel                  id orderType payChannel  status  \\\n",
       "0    91ala   ctrip  ala202808331910059   jiudian        NaN       0   \n",
       "1    91ala   ofpay  ala202797681122095    huafei     fanbei       0   \n",
       "2  bestpay     ele   bp202794081226240    waimai        NaN       0   \n",
       "3  bestpay     ele   bp202792207025230    waimai        NaN       0   \n",
       "4  bestpay     ele   bp202792078574486    waimai        NaN       0   \n",
       "\n",
       "   completedAt      createdAt  orderPrice              paidList  \\\n",
       "0          NaN  1512401872010      158.00                   NaN   \n",
       "1          NaN  1512320613148       49.85  [ala212797681122096]   \n",
       "2          NaN  1512293148929       22.00                   NaN   \n",
       "3          NaN  1512278850033       16.00                   NaN   \n",
       "4          NaN  1512277869939       52.50                   NaN   \n",
       "\n",
       "             partnerId       paymentSerial  \n",
       "0            undefined                 NaN  \n",
       "1       S1712042122650  ala212797681122096  \n",
       "2  1214408624897079430                 NaN  \n",
       "3  3016138567508615211                 NaN  \n",
       "4  3016137569297589269                 NaN  "
      ]
     },
     "execution_count": 303,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 331,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.06325483322143555\n"
     ]
    }
   ],
   "source": [
    "s=time.time()\n",
    "for row in pd_data.itertuples():\n",
    "    continue\n",
    "print(time.time()-s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 334,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "65.9 ms ± 1.05 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)\n"
     ]
    }
   ],
   "source": [
    "%timeit [row[1] * 2 for row in pd_data.itertuples()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 329,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1.9693326950073242\n"
     ]
    }
   ],
   "source": [
    "s=time.time()\n",
    "for row in pd_data.iterrows():\n",
    "    continue\n",
    "print(time.time()-s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 356,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1.17 µs ± 14.3 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)\n"
     ]
    }
   ],
   "source": [
    "%timeit pd_data.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 354,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "456 ns ± 4.56 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)\n"
     ]
    }
   ],
   "source": [
    "%timeit len(pd_data.index)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 355,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5.92 µs ± 74.6 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)\n"
     ]
    }
   ],
   "source": [
    "%timeit len(pd_data.id)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%timeit "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 335,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7.16 s ± 108 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%timeit [row[1] * 2 for row in pd_data.iterrows()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 337,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "8.45 s ± 259 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n"
     ]
    }
   ],
   "source": [
    "%timeit [pd_data.loc[index][1] * 2 for index in range(len(pd_data))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 301,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "class DataSpecsMapping(object):\n",
    "\n",
    "    def __init__(self, df, mdb=None, rdb=None, pgdb=None):\n",
    "        \"\"\"\n",
    "        :params df: class pandas.DataFrame\n",
    "        :params mdb: class mongo.db\n",
    "        :params rdb: class redis.db\n",
    "        :params pgdb: class postgrepsql.db\n",
    "        \"\"\"\n",
    "        self._df = df\n",
    "        self._mdb = mdb\n",
    "        self._rdb = rdb\n",
    "        self._pgdb = pgdb\n",
    "        self._MapPayChannel = {\n",
    "            item['pay_channel_code']: item['pay_channel_name']\n",
    "            for item in pg_select(\"SELECT pay_channel_name,pay_channel_code FROM pay_rate;\", self._pgdb('account'))\n",
    "        }\n",
    "        self._MapAppCode = {\n",
    "            item['app_code']: item['app_name']\n",
    "            for item in pg_select(\"SELECT app_name,app_code FROM application;\", self._pgdb('oto_saas'))\n",
    "        }\n",
    "        self._MapChannel = MAP_ORDER_CHANNEL\n",
    "        self._MapKey = MAP_KEY\n",
    "        self._MapPayRate = MAP_PAY_RATE\n",
    "        self._keys = set(self._df.columns)\n",
    "        super().__init__()\n",
    "\n",
    "    @staticmethod\n",
    "    def _timestamp_to_strftime(timestamp):\n",
    "        \"\"\"\n",
    "        :params timestamp ms: 1512984499427\n",
    "        \"\"\"\n",
    "        return time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(timestamp / 1000)) if timestamp else ''\n",
    "\n",
    "    def map_timestamp(self):\n",
    "        \"\"\"\n",
    "        Map timestamp to strftime\n",
    "        \"\"\"\n",
    "        if 'createdAt' in self._keys:\n",
    "            self._df.createdAt = self._df.createdAt.map(_timestamp_to_strftime)\n",
    "        if 'paidTime' in self._keys:\n",
    "            self._df.paidTime = self._df.paidTime.map(_timestamp_to_strftime)\n",
    "        if 'completedAt' in self._keys:\n",
    "            self._df.completedAt = self._df.completedAt.map(_timestamp_to_strftime)\n",
    "\n",
    "    def _map_pay_channel(self, pay_channel):\n",
    "        if not isinstance(pay_channel, str):\n",
    "            return pay_channel\n",
    "        return \",\".join([self._MapPayChannel.get(key, key) for key in pay_channel.split(',')])\n",
    "\n",
    "    def map_pay_channel(self):\n",
    "        \"\"\"\n",
    "        :params payChannel: wx,zfb\n",
    "        \"\"\"\n",
    "        if 'payChannel' in self._keys:\n",
    "            self._df.payChannel = self._df.payChannel.map(_map_pay_channel)\n",
    "\n",
    "    def map_price(self):\n",
    "        if 'payPrice' in self._keys:\n",
    "            self._df.payPrice = self._df.payPrice.map(lambda x: float(x) / 100 if x else 0)\n",
    "\n",
    "    def map_channel(self):\n",
    "        if 'channel' in self._keys:\n",
    "            self._df.channel = self._df.channel.map(lambda x: self._MapChannel.get(x, x))\n",
    "\n",
    "    def map_app_code(self):\n",
    "        if 'appCode' in self._keys:\n",
    "            self._df.appCode = self._df.appCode.map(lambda x: self._MapAppCode.get(x, x))\n",
    "\n",
    "    def compute_pay_rate(self):\n",
    "        if 'payChannel' in self._keys:\n",
    "            self._df['pay_rate'] = self._df.payChannel.map(lambda x: sum([self._MapPayRate.get(channel, 0) for channel in x.payChannel.split(',')]))\n",
    "            self._keys.add('pay_rate')\n",
    "        if 'payPrice' in self._keys and 'pay_rate' in self._keys:\n",
    "            self._df['payRate'] = self._df.payPrice * self._df.pay_rate\n",
    "            self._df['payRate'] = self._df.payRate.map(lambda x: round(x, 2))\n",
    "\n",
    "    def compute_deduction_price(self):\n",
    "        if 'transactionType' in self._keys:\n",
    "            self._df.loc[self._df.transactionType == '退款', 'orderPrice'] = -self._df.orderPrice\n",
    "        if 'payPrice' in self._keys:\n",
    "            self._df['deductionPrice'] = self._df.orderPrice - self._df.payPrice\n",
    "            self._keys.add('deductionPrice')\n",
    "\n",
    "    def mapping(self):\n",
    "        self.map_timestamp()\n",
    "        self.map_pay_channel()\n",
    "        self.map_price()\n",
    "        self.compute_pay_rate()\n",
    "        self.compute_deduction_price()\n",
    "        self.map_channel()\n",
    "        self.map_app_code()\n",
    "        return self._df"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
